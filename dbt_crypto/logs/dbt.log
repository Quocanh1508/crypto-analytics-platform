[0m21:12:38.692510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D41D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E48AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E4889A0>]}


============================== 21:12:38.696789 | 5ebd0e99-b890-4236-a6be-ae42a1db8484 ==============================
[0m21:12:38.696789 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:12:38.696789 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto\\logs'}
[0m21:12:38.965121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E48BD60>]}
[0m21:12:39.077215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266DC10880>]}
[0m21:12:39.080897 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:12:39.430817 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:12:39.432761 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:12:39.433796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E5033A0>]}
[0m21:12:42.369106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FF67FA0>]}
[0m21:12:42.515916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:12:42.535793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:12:42.560640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FF3F040>]}
[0m21:12:42.561355 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m21:12:42.561355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FF63A30>]}
[0m21:12:42.563081 [info ] [MainThread]: 
[0m21:12:42.564226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:42.564226 [info ] [MainThread]: 
[0m21:12:42.565120 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:12:42.570437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m21:12:42.570437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m21:12:42.576618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m21:12:46.181175 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m21:12:46.181707 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m21:12:46.181707 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m21:12:46.182225 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:12:46.182225 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:12:46.182225 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:12:46.183973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.183973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.184580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.217610 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.033 seconds
[0m21:12:46.218152 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.034 seconds
[0m21:12:46.218729 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.034 seconds
[0m21:12:46.219844 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m21:12:46.220960 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m21:12:46.222072 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m21:12:46.222072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_silver)
[0m21:12:46.222072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_gold)
[0m21:12:46.222072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_bronze)
[0m21:12:46.225806 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_silver"
"
[0m21:12:46.225806 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_gold"
"
[0m21:12:46.225806 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_bronze"
"
[0m21:12:46.232170 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m21:12:46.232170 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m21:12:46.232170 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m21:12:46.232170 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: BEGIN
[0m21:12:46.232170 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: BEGIN
[0m21:12:46.232170 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: BEGIN
[0m21:12:46.232170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:46.232170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:46.232170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m21:12:46.252538 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_gold"} */
create schema if not exists "public_gold"
[0m21:12:46.252538 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m21:12:46.252538 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_bronze"} */
create schema if not exists "public_bronze"
[0m21:12:46.252538 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_silver"} */
create schema if not exists "public_silver"
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:12:46.260178 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m21:12:46.260178 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m21:12:46.262251 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m21:12:46.263106 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m21:12:46.263648 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m21:12:46.263648 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m21:12:46.263648 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: Close
[0m21:12:46.263648 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m21:12:46.263648 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: Close
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: Close
[0m21:12:46.263648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m21:12:46.263648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m21:12:46.278260 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:12:46.278260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m21:12:46.280355 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:12:46.280355 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m21:12:46.283127 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:12:46.284146 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m21:12:46.284146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.285177 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m21:12:46.285177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.286149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.297632 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m21:12:46.297632 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:12:46.297632 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:12:46.313886 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m21:12:46.313886 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m21:12:46.313886 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:12:46.313886 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:12:46.313886 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:12:46.313886 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:12:46.313886 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m21:12:46.325675 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m21:12:46.325675 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m21:12:46.325675 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:12:46.325675 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:12:46.328845 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m21:12:46.329453 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m21:12:46.331790 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m21:12:46.331790 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m21:12:46.335631 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.335631 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.338608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:46.353786 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m21:12:46.353786 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.360271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:12:46.375748 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:12:46.375748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FC509D0>]}
[0m21:12:46.375748 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:46.378867 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.378867 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.380432 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:12:46.380432 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.380432 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.380432 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.382492 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:12:46.382492 [debug] [MainThread]: On master: Close
[0m21:12:46.389392 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.389926 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.391041 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m21:12:46.391579 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m21:12:46.392634 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_crypto.bronze_historical_klines'
[0m21:12:46.393716 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_crypto.bronze_realtime_klines'
[0m21:12:46.393716 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.394811 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.402356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.406961 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.409930 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.410449 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.441157 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.445131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.448134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.448134 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.449136 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m21:12:46.449136 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m21:12:46.449136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:12:46.450309 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:12:46.462431 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m21:12:46.463016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.463593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m21:12:46.464141 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m21:12:46.464723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.465296 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m21:12:46.483591 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m21:12:46.483591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m21:12:46.492750 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.496152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.496686 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m21:12:46.497317 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m21:12:46.500344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:12:46.500344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:12:46.513827 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.513827 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.513827 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:12:46.513827 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m21:12:46.530547 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m21:12:46.533739 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m21:12:46.538433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.539433 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.540104 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m21:12:46.540104 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m21:12:46.543772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:12:46.544509 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:12:46.547362 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m21:12:46.549304 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m21:12:46.554073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FFB3760>]}
[0m21:12:46.554418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226701C6B90>]}
[0m21:12:46.555491 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.16s]
[0m21:12:46.556614 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.16s]
[0m21:12:46.557171 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.558295 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.559229 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m21:12:46.559229 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m21:12:46.560267 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m21:12:46.560267 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m21:12:46.565595 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.565595 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m21:12:46.601808 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.603579 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.604597 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m21:12:46.604597 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:12:46.617067 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m21:12:46.617067 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.618083 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      
  
    

  create  table "crypto_analytics"."public_silver"."silver_klines_1m"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


  );
  
  
[0m21:12:46.775475 [debug] [Thread-4 (]: SQL status: SELECT 9249 in 0.157 seconds
[0m21:12:46.779026 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m21:12:46.780599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.780599 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m21:12:46.792508 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m21:12:46.792508 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m21:12:46.792508 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267033BA00>]}
[0m21:12:46.792508 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mSELECT 9249[0m in 0.23s]
[0m21:12:46.792508 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m21:12:46.792508 [debug] [Thread-1 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m21:12:46.792508 [info ] [Thread-1 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m21:12:46.792508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_historical_klines, now model.dbt_crypto.gold_klines_5m)
[0m21:12:46.799845 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m21:12:46.804349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.806347 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m21:12:46.819461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.821083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.821608 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m21:12:46.822131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:46.845504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m21:12:46.845504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.846519 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m21:12:46.882449 [debug] [Thread-1 (]: SQL status: SELECT 1854 in 0.036 seconds
[0m21:12:46.882449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.882449 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m21:12:46.882449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:12:46.882449 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m21:12:46.882449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.882449 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m21:12:46.893020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:12:46.897323 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m21:12:46.899519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.900061 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m21:12:46.901128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:12:46.902696 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m21:12:46.903220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226701C6B90>]}
[0m21:12:46.904282 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 1854[0m in 0.11s]
[0m21:12:46.904835 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m21:12:46.906467 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.906467 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.907077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:46.932191 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m21:12:46.933198 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.933198 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.933198 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.934647 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:12:46.935845 [debug] [MainThread]: On master: Close
[0m21:12:46.935845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:46.936972 [debug] [MainThread]: Connection 'create_crypto_analytics_public_gold' was properly closed.
[0m21:12:46.937724 [debug] [MainThread]: Connection 'create_crypto_analytics_public_bronze' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'create_crypto_analytics_public_silver' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_realtime_klines' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m21:12:46.938138 [info ] [MainThread]: 
[0m21:12:46.942704 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m21:12:46.943711 [debug] [MainThread]: Command end result
[0m21:12:46.963076 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:12:46.965628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:12:46.972667 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\StudyZone\Project\Binance\dbt_crypto\target\run_results.json
[0m21:12:46.972667 [info ] [MainThread]: 
[0m21:12:46.973664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:46.974663 [info ] [MainThread]: 
[0m21:12:46.974663 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:12:46.975664 [debug] [MainThread]: Command `dbt run` succeeded at 21:12:46.975664 after 8.36 seconds
[0m21:12:46.976234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D41D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E48BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266C002110>]}
[0m21:12:46.976983 [debug] [MainThread]: Flushing usage events
[0m21:12:48.917240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:03.641210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DC8D8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599ECDF6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599ECDCBB0>]}


============================== 21:13:03.645627 | fed01617-4442-43b0-8b92-a9b6e5f74ee6 ==============================
[0m21:13:03.645627 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:13:03.646694 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto\\logs'}
[0m21:13:03.875488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599ECDCA00>]}
[0m21:13:03.962880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DD4E800>]}
[0m21:13:03.964633 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:13:04.163018 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:13:04.335156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:04.335156 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:13:04.336571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:04.384054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A03D8130>]}
[0m21:13:04.515017 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:13:04.519166 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:13:04.553736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A03CE770>]}
[0m21:13:04.553736 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m21:13:04.554741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A0407730>]}
[0m21:13:04.556179 [info ] [MainThread]: 
[0m21:13:04.557197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:04.558197 [info ] [MainThread]: 
[0m21:13:04.558590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:04.563017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m21:13:04.563017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m21:13:04.563017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m21:13:04.632439 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:13:04.632987 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:13:04.632987 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:13:04.633549 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m21:13:04.633549 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m21:13:04.633549 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m21:13:04.633549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:04.633549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:04.633549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:04.652367 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:13:04.652367 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:13:04.653446 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:13:04.654014 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:13:04.654525 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:13:04.655031 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:13:04.660369 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.661059 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:13:04.662736 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m21:13:04.663864 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m21:13:04.664948 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m21:13:04.665472 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m21:13:04.665994 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m21:13:04.667559 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:13:04.668113 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:13:04.672853 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:13:04.674442 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m21:13:04.675499 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m21:13:04.680463 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.681077 [debug] [MainThread]: On master: BEGIN
[0m21:13:04.681077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:04.718095 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m21:13:04.718636 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.719210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:13:04.727216 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m21:13:04.728732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599F006080>]}
[0m21:13:04.729770 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:04.731372 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.732432 [debug] [MainThread]: On master: BEGIN
[0m21:13:04.734675 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:13:04.735347 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.736437 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.737004 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.738119 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:13:04.738677 [debug] [MainThread]: On master: Close
[0m21:13:04.743541 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.744085 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.744630 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.745178 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.745720 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m21:13:04.746796 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m21:13:04.747331 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m21:13:04.748417 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m21:13:04.749476 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7'
[0m21:13:04.750171 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4'
[0m21:13:04.750691 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb'
[0m21:13:04.751788 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m21:13:04.751788 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.753266 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.753847 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.754412 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.770067 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.775007 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.779710 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.787009 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.789894 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.811053 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.813495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.817303 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.817859 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.818446 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.822916 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.826852 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.827402 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.828474 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.829530 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m21:13:04.830699 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m21:13:04.831256 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.831803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:13:04.832886 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.833448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:04.834027 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m21:13:04.834586 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m21:13:04.835594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:13:04.836597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:13:04.850908 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m21:13:04.851465 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.852601 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.854787 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m21:13:04.855867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m21:13:04.856405 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.857463 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.858536 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.859070 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.864431 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m21:13:04.865510 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.867126 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m21:13:04.867678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m21:13:04.870067 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.870067 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.869472 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.12s]
[0m21:13:04.871075 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.873263 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m21:13:04.874271 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m21:13:04.876344 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.876878 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.878364 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.878894 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m21:13:04.879449 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m21:13:04.879993 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m21:13:04.881064 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.13s]
[0m21:13:04.882239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:13:04.882790 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.13s]
[0m21:13:04.884038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m21:13:04.884997 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.886615 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m21:13:04.887683 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.888222 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.888773 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.894094 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.894094 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m21:13:04.896326 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m21:13:04.897924 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.15s]
[0m21:13:04.899320 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m21:13:04.899931 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.901021 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.901704 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.904423 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.910211 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.912226 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.912921 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.915872 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m21:13:04.920897 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.920897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:04.923743 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.923743 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m21:13:04.924851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:04.941819 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m21:13:04.942896 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.943431 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.945768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m21:13:04.946312 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.946856 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.948094 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:13:04.948094 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m21:13:04.951213 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:13:04.951213 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m21:13:04.952741 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m21:13:04.954777 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.07s]
[0m21:13:04.955369 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.955369 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m21:13:04.955369 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.06s]
[0m21:13:04.958608 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.960118 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.960118 [debug] [MainThread]: On master: BEGIN
[0m21:13:04.960118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:04.973362 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:13:04.973362 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.974362 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.974362 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.975879 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:13:04.976430 [debug] [MainThread]: On master: Close
[0m21:13:04.976853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:04.976853 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m21:13:04.977899 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m21:13:04.977899 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m21:13:04.980113 [info ] [MainThread]: 
[0m21:13:04.980420 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:13:04.982205 [debug] [MainThread]: Command end result
[0m21:13:05.003076 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:13:05.006547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:13:05.014745 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\StudyZone\Project\Binance\dbt_crypto\target\run_results.json
[0m21:13:05.015304 [info ] [MainThread]: 
[0m21:13:05.015878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:05.016459 [info ] [MainThread]: 
[0m21:13:05.017080 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m21:13:05.018171 [debug] [MainThread]: Command `dbt test` succeeded at 21:13:05.018171 after 1.47 seconds
[0m21:13:05.018739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DC8D8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DD46A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A03CE7D0>]}
[0m21:13:05.019305 [debug] [MainThread]: Flushing usage events
[0m21:13:06.516378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:46.405202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7acc9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7accaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7acc8610>]}


============================== 15:59:46.413529 | b538c073-2918-4b55-9add-72e50ad72b49 ==============================
[0m15:59:46.413529 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:59:46.415412 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '.', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'printer_width': '80'}
[0m15:59:46.681645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7a3cc110>]}
[0m15:59:46.745963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7d5ad090>]}
[0m15:59:46.749855 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:59:46.894576 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:59:47.120507 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:59:47.122338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7c0e0190>]}
[0m15:59:49.486493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78f3bd90>]}
[0m15:59:49.631800 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:49.639864 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:49.703182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d72441610>]}
[0m15:59:49.706181 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m15:59:49.708203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d781e1650>]}
[0m15:59:49.712093 [info ] [MainThread]: 
[0m15:59:49.714100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:49.715892 [info ] [MainThread]: 
[0m15:59:49.717569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:49.723401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:49.724669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:49.726112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:49.767935 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:49.768499 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:49.769040 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:49.770773 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:49.772791 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:49.774720 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:49.776442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:49.778017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:49.780075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:49.806029 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m15:59:49.806579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m15:59:49.807101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m15:59:49.808879 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:49.811443 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:49.813797 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:49.818171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_bronze)
[0m15:59:49.818768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_gold)
[0m15:59:49.819238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_silver)
[0m15:59:49.820551 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_bronze"
"
[0m15:59:49.821816 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_gold"
"
[0m15:59:49.823240 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_silver"
"
[0m15:59:49.829987 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m15:59:49.833738 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m15:59:49.837087 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m15:59:49.838733 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: BEGIN
[0m15:59:49.840489 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: BEGIN
[0m15:59:49.841709 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: BEGIN
[0m15:59:49.842703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.843682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.844797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.852971 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:59:49.853684 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:59:49.854203 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:59:49.855731 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m15:59:49.857328 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m15:59:49.858873 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m15:59:49.860690 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_bronze"} */
create schema if not exists "public_bronze"
[0m15:59:49.861995 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_gold"} */
create schema if not exists "public_gold"
[0m15:59:49.863219 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_silver"} */
create schema if not exists "public_silver"
[0m15:59:49.869363 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m15:59:49.870226 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m15:59:49.870683 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m15:59:49.872626 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m15:59:49.875013 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m15:59:49.877028 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m15:59:49.878176 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m15:59:49.879275 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m15:59:49.880710 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m15:59:49.881745 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m15:59:49.882787 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m15:59:49.883790 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m15:59:49.885891 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:59:49.886449 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:59:49.887779 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:59:49.888248 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: Close
[0m15:59:49.889668 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: Close
[0m15:59:49.891066 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: Close
[0m15:59:49.895924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_analytics_public_silver, now list_crypto_analytics_public_bronze)
[0m15:59:49.896618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_analytics_public_gold, now list_crypto_analytics_public_gold)
[0m15:59:49.897180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_analytics_public_bronze, now list_crypto_analytics_public_silver)
[0m15:59:49.903889 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:49.906846 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:49.909964 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:49.911515 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m15:59:49.913067 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m15:59:49.914130 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m15:59:49.915557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.916720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.917765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.924275 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:59:49.924818 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:59:49.925629 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:59:49.926457 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:49.928101 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:49.929457 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:49.930538 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m15:59:49.931712 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m15:59:49.932835 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m15:59:49.951096 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m15:59:49.951567 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m15:59:49.951956 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m15:59:49.953686 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m15:59:49.955429 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m15:59:49.957280 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m15:59:49.959036 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m15:59:49.960206 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m15:59:49.961226 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m15:59:49.968748 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:49.970410 [debug] [MainThread]: On master: BEGIN
[0m15:59:49.971805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:49.977970 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:59:49.979468 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:49.980755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:49.998892 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m15:59:50.001259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7a3071d0>]}
[0m15:59:50.002682 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:50.004094 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.005391 [debug] [MainThread]: On master: BEGIN
[0m15:59:50.006943 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:59:50.008370 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.009492 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.010437 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.012064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:50.013482 [debug] [MainThread]: On master: Close
[0m15:59:50.021643 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.022215 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.023967 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m15:59:50.026605 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m15:59:50.027947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m15:59:50.029100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_realtime_klines)
[0m15:59:50.030181 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.031212 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.040720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.268541 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.279486 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.287256 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.331524 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.334690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.343480 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.345237 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m15:59:50.345870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.347301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:50.349353 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m15:59:50.352380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:50.356650 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m15:59:50.358146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.359062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:59:50.359856 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m15:59:50.361521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.364437 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m15:59:50.378880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m15:59:50.379546 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:59:50.386754 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.390770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.392285 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m15:59:50.393936 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m15:59:50.397736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:50.398288 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:59:50.412157 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:50.414189 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:50.415664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.417600 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.419322 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:50.421042 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:50.423973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.424596 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.432257 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m15:59:50.435641 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m15:59:50.442229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.444013 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.445766 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m15:59:50.447116 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m15:59:50.450324 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:59:50.450834 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:59:50.453712 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m15:59:50.455648 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m15:59:50.458630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78fb71d0>]}
[0m15:59:50.459679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78f2e4d0>]}
[0m15:59:50.461261 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.43s]
[0m15:59:50.462777 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.43s]
[0m15:59:50.464611 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.466196 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.468601 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m15:59:50.469773 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m15:59:50.471179 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m15:59:50.472441 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m15:59:50.479006 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.490015 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m15:59:50.527288 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.537495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.538901 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m15:59:50.540118 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:50.546153 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m15:59:50.547792 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.548941 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      
  
    

  create  table "crypto_analytics"."public_silver"."silver_klines_1m"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


  );
  
  
[0m15:59:50.565542 [debug] [Thread-4 (]: SQL status: SELECT 216 in 0.015 seconds
[0m15:59:50.571676 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:50.573141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.574825 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:50.577695 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.579440 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m15:59:50.580771 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78b13f50>]}
[0m15:59:50.582180 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mSELECT 216[0m in 0.11s]
[0m15:59:50.583570 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m15:59:50.585286 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m15:59:50.586476 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m15:59:50.587704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m15:59:50.588784 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m15:59:50.593025 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.601643 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m15:59:50.615466 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.629545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.631134 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m15:59:50.632665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:50.640196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m15:59:50.641960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.643807 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m15:59:50.670193 [debug] [Thread-2 (]: SQL status: SELECT 45 in 0.024 seconds
[0m15:59:50.674917 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.677175 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m15:59:50.679027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:59:50.681706 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:50.682833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.684485 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:50.687187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.690839 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m15:59:50.695219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.697097 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m15:59:50.699169 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:59:50.701651 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m15:59:50.704374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78b04e90>]}
[0m15:59:50.706760 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 45[0m in 0.12s]
[0m15:59:50.708891 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m15:59:50.713042 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.715045 [debug] [MainThread]: On master: BEGIN
[0m15:59:50.716705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:50.723879 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:59:50.725422 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.727508 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.729448 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.731835 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:50.733878 [debug] [MainThread]: On master: Close
[0m15:59:50.735903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:50.737447 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m15:59:50.739654 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m15:59:50.741967 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m15:59:50.743734 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m15:59:50.745906 [info ] [MainThread]: 
[0m15:59:50.747299 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m15:59:50.751095 [debug] [MainThread]: Command end result
[0m15:59:50.805851 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:50.813754 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:50.830020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m15:59:50.832158 [info ] [MainThread]: 
[0m15:59:50.834497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:50.836185 [info ] [MainThread]: 
[0m15:59:50.838866 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:59:50.845221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5265245, "process_in_blocks": "151592", "process_kernel_time": 0.683724, "process_mem_max_rss": "138776", "process_out_blocks": "2312", "process_user_time": 4.532114}
[0m15:59:50.848039 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:50.847553 after 4.53 seconds
[0m15:59:50.850057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7f294350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7f2fb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7d266f90>]}
[0m15:59:50.852451 [debug] [MainThread]: Flushing usage events
[0m15:59:52.079939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bc48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441dd9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bccd90>]}


============================== 15:59:52.089024 | 9e7d349e-ef9b-4eb7-a85f-0db14baa232d ==============================
[0m15:59:52.089024 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:59:52.090750 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:59:52.348061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bd8090>]}
[0m15:59:52.456085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9444592c50>]}
[0m15:59:52.459403 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:59:52.562595 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:59:52.867270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:52.882739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:52.884228 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:59:52.885689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:52.931944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94403fcb90>]}
[0m15:59:53.038046 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:53.045641 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:53.075268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9440b347d0>]}
[0m15:59:53.076860 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m15:59:53.078489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bba410>]}
[0m15:59:53.082144 [info ] [MainThread]: 
[0m15:59:53.084193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:53.086260 [info ] [MainThread]: 
[0m15:59:53.088496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:53.095344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:53.170772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:53.171919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:53.212217 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:53.212797 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:53.213299 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:53.214513 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:53.216236 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:53.217943 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:53.219624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:53.221210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:53.222402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:53.231141 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m15:59:53.232601 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m15:59:53.235659 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:53.236522 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m15:59:53.239471 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:53.244674 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:53.250666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m15:59:53.251507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m15:59:53.252386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m15:59:53.260030 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:53.263695 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:53.267697 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:53.269704 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m15:59:53.271542 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m15:59:53.273335 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m15:59:53.275018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:53.277161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:53.279008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:53.286756 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:59:53.288127 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:59:53.289806 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:59:53.290462 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:53.292176 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:53.294024 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:53.295808 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m15:59:53.297394 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m15:59:53.298703 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m15:59:53.304856 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m15:59:53.305741 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:59:53.309436 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m15:59:53.310405 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:59:53.314150 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m15:59:53.316709 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m15:59:53.319520 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m15:59:53.322056 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m15:59:53.326627 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m15:59:53.337437 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.340291 [debug] [MainThread]: On master: BEGIN
[0m15:59:53.342881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:53.356753 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:59:53.358553 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.360293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:53.369191 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:59:53.374077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bbaf50>]}
[0m15:59:53.376713 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:53.378708 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.380652 [debug] [MainThread]: On master: BEGIN
[0m15:59:53.383019 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:59:53.384877 [debug] [MainThread]: On master: COMMIT
[0m15:59:53.387134 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.389296 [debug] [MainThread]: On master: COMMIT
[0m15:59:53.391761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:53.393600 [debug] [MainThread]: On master: Close
[0m15:59:53.415335 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.415936 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.417751 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m15:59:53.419364 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m15:59:53.420783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m15:59:53.422126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m15:59:53.423251 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.424538 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.434542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.439195 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.446105 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.453164 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.504847 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.505933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.514838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.517005 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m15:59:53.517544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.518822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:53.520857 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m15:59:53.524076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:53.527143 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m15:59:53.528944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.530466 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m15:59:53.531821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:59:53.533764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.535226 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m15:59:53.536391 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:59:53.544921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:59:53.545563 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.549220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.551125 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m15:59:53.553466 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m15:59:53.556012 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:53.558350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:59:53.562710 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.566796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.568264 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m15:59:53.569611 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m15:59:53.571430 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:53.572738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:53.593220 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:53.595428 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:53.597385 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.599220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.600855 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:53.602438 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:53.606086 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:59:53.614111 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m15:59:53.614762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:59:53.625380 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.630116 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m15:59:53.631876 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m15:59:53.634401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.637421 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m15:59:53.643036 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:59:53.644231 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:59:53.647035 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m15:59:53.650303 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m15:59:53.657166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943ddc3ad0>]}
[0m15:59:53.658896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943dc41310>]}
[0m15:59:53.661377 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.23s]
[0m15:59:53.664946 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.24s]
[0m15:59:53.668391 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.671167 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.678926 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m15:59:53.681688 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m15:59:53.684035 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m15:59:53.686103 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m15:59:53.706571 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.721005 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m15:59:53.763942 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.765550 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp155953749219"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m15:59:53.767087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:53.778822 [debug] [Thread-4 (]: SQL status: SELECT 216 in 0.012 seconds
[0m15:59:53.795166 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.796729 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m15:59:53.798405 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m15:59:53.799864 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.801289 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp155953749219'
        
      order by ordinal_position

  
[0m15:59:53.825092 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.023 seconds
[0m15:59:53.832359 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.834970 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m15:59:53.841646 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.004 seconds
[0m15:59:53.854986 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.856757 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m15:59:53.861916 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.004 seconds
[0m15:59:53.888996 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.899624 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.901250 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp155953749219" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m15:59:53.906265 [debug] [Thread-4 (]: SQL status: MERGE 216 in 0.003 seconds
[0m15:59:53.909081 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:53.910765 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.912310 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:53.914931 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:53.916883 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m15:59:53.918632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943dce0450>]}
[0m15:59:53.920226 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 216[0m in 0.23s]
[0m15:59:53.922025 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m15:59:53.924360 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m15:59:53.925791 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m15:59:53.927236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m15:59:53.928838 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m15:59:53.933184 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.946314 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m15:59:53.960123 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.969878 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.971332 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m15:59:53.972519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:53.977955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:59:53.979561 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.981018 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m15:59:53.990270 [debug] [Thread-2 (]: SQL status: SELECT 45 in 0.008 seconds
[0m15:59:53.999400 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.001130 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m15:59:54.002988 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:54.008219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.009537 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m15:59:54.011126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:59:54.013763 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:54.015336 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.016887 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:54.018895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:54.022722 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m15:59:54.026759 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.027960 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m15:59:54.031870 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:59:54.034596 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m15:59:54.036076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943ded7e50>]}
[0m15:59:54.037464 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 45[0m in 0.11s]
[0m15:59:54.038886 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m15:59:54.042114 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:54.043255 [debug] [MainThread]: On master: BEGIN
[0m15:59:54.044627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:54.050290 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:59:54.051639 [debug] [MainThread]: On master: COMMIT
[0m15:59:54.052987 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:54.054247 [debug] [MainThread]: On master: COMMIT
[0m15:59:54.055566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:54.056600 [debug] [MainThread]: On master: Close
[0m15:59:54.058343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:54.060045 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m15:59:54.061324 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m15:59:54.062686 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m15:59:54.063723 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m15:59:54.065396 [info ] [MainThread]: 
[0m15:59:54.067125 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m15:59:54.070067 [debug] [MainThread]: Command end result
[0m15:59:54.124510 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:54.133657 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:54.148225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m15:59:54.150231 [info ] [MainThread]: 
[0m15:59:54.152439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:54.153915 [info ] [MainThread]: 
[0m15:59:54.155754 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:59:54.163490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1718009, "process_in_blocks": "36496", "process_kernel_time": 0.439776, "process_mem_max_rss": "125992", "process_out_blocks": "0", "process_user_time": 3.188378}
[0m15:59:54.168641 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:54.168092 after 2.18 seconds
[0m15:59:54.171303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441dd9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441a23b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94462db710>]}
[0m15:59:54.173308 [debug] [MainThread]: Flushing usage events
[0m15:59:55.599295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:03.851662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff599ec3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5977f7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597604c90>]}


============================== 16:00:03.876119 | 095a6403-b63c-42f4-9480-d0036964af90 ==============================
[0m16:00:03.876119 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:03.879425 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt_crypto/logs', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m16:00:04.099855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff596f67e10>]}
[0m16:00:04.164801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff599ee0b10>]}
[0m16:00:04.167249 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:04.247632 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:04.600468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:04.602508 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:04.604056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:04.656312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5963ac4d0>]}
[0m16:00:04.778200 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:04.803785 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:04.929964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff596781510>]}
[0m16:00:04.932461 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:04.934351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff595b50450>]}
[0m16:00:04.938087 [info ] [MainThread]: 
[0m16:00:04.940032 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:04.942354 [info ] [MainThread]: 
[0m16:00:04.945256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:04.952703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:00:04.954765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:00:04.956069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:00:05.006640 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:05.007813 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:05.008510 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:05.009589 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:05.011356 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:05.012755 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:05.014626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.016011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.017464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.025207 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:00:05.026261 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:00:05.027210 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:00:05.028180 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:05.029523 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:05.030765 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:05.032508 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:05.033891 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:05.035305 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:05.041333 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:00:05.041950 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:00:05.042429 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:05.044192 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:05.046519 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:05.048329 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:05.049832 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:05.051111 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:05.052235 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:05.060772 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.062016 [debug] [MainThread]: On master: BEGIN
[0m16:00:05.063145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:05.069572 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:00:05.071258 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.072932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:05.079714 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:00:05.082013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5975b7ad0>]}
[0m16:00:05.083448 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:05.084760 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.086037 [debug] [MainThread]: On master: BEGIN
[0m16:00:05.087473 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:00:05.088764 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.089847 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.090835 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.092025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:05.093235 [debug] [MainThread]: On master: Close
[0m16:00:05.099872 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.100464 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.100964 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.101439 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.102275 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:00:05.103582 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:00:05.104832 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:00:05.106263 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:00:05.107684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:00:05.109320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:00:05.110465 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:00:05.111646 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:00:05.112953 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.114846 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.116594 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.118115 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.134521 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.139095 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.144204 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.149250 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.156928 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.158869 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.164982 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.179399 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.182519 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.183087 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.188134 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.194425 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.200880 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.202510 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:00:05.203262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.204029 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.205704 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:05.207076 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.208992 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:00:05.210963 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:00:05.213991 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:00:05.216235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:05.217578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:00:05.218698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:05.220586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:05.223857 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.228079 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.230201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:05.230755 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:00:05.231892 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m16:00:05.232578 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.233104 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:05.234894 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.236250 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.237537 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.242623 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:00:05.244132 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.245475 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.247877 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:00:05.248504 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:05.252520 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:05.255107 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.14s]
[0m16:00:05.257384 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:00:05.258283 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m16:00:05.259996 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:00:05.261587 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.262821 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:00:05.264645 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:00:05.266634 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:00:05.267980 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.270027 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.16s]
[0m16:00:05.271180 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:00:05.272440 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.16s]
[0m16:00:05.273382 [info ] [Thread-4 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:00:05.275113 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.276780 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.17s]
[0m16:00:05.278592 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.280131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:00:05.281703 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.283384 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.285462 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.286560 [info ] [Thread-1 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:00:05.293493 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.294667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:00:05.297207 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.302450 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.308043 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.312455 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.313085 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.318328 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.327730 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.329537 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:00:05.330623 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.331340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:05.332832 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:00:05.335373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:05.339625 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:00:05.341118 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.341950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:05.343234 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.344869 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.347241 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.347855 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:05.351383 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:00:05.351999 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:05.353409 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:00:05.355700 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:00:05.357858 [info ] [Thread-4 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.08s]
[0m16:00:05.359102 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:00:05.360613 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.362814 [info ] [Thread-1 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.07s]
[0m16:00:05.365057 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.367709 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.368849 [debug] [MainThread]: On master: BEGIN
[0m16:00:05.369881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:05.375374 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:00:05.376636 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.378094 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.379620 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.380999 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:05.382387 [debug] [MainThread]: On master: Close
[0m16:00:05.384012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:05.385372 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:00:05.386695 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:00:05.388228 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:00:05.389472 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:00:05.390616 [info ] [MainThread]: 
[0m16:00:05.392207 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:00:05.395361 [debug] [MainThread]: Command end result
[0m16:00:05.438618 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:05.447390 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:05.460730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:05.462501 [info ] [MainThread]: 
[0m16:00:05.464805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:05.466365 [info ] [MainThread]: 
[0m16:00:05.467957 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:05.470199 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7560347, "process_in_blocks": "103984", "process_kernel_time": 0.63051, "process_mem_max_rss": "127076", "process_out_blocks": "0", "process_user_time": 3.1427}
[0m16:00:05.472163 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:05.471788 after 1.76 seconds
[0m16:00:05.473519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59bc43850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59bba32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597511e90>]}
[0m16:00:05.474853 [debug] [MainThread]: Flushing usage events
[0m16:00:06.826631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:09.862040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4ef8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4f4fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4ef8f90>]}


============================== 16:00:09.870022 | 81b2eb40-edff-486c-bbb7-d4b0b8101e81 ==============================
[0m16:00:09.870022 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:09.872188 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'debug': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '.', 'static_parser': 'True'}
[0m16:00:09.870686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e4f6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e55ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e4f72d0>]}


============================== 16:00:09.878226 | 25592817-d08d-4f7f-9192-7dd1f984b9b4 ==============================
[0m16:00:09.878226 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:09.880542 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m16:00:10.069230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd48cee10>]}
[0m16:00:10.090729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182df774d0>]}
[0m16:00:10.132015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd78f13d0>]}
[0m16:00:10.134450 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:10.188820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1830efa1d0>]}
[0m16:00:10.191288 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:10.215327 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:10.303800 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:10.563950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:10.566695 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:10.568421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:10.639099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd3df0210>]}
[0m16:00:10.640642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:10.642098 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:10.643866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:10.707113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d3a3e50>]}
[0m16:00:10.767963 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:10.778406 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:10.827870 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:10.837010 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:10.905289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d7f3990>]}
[0m16:00:10.907952 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:10.910498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e42ffd0>]}
[0m16:00:10.929561 [info ] [MainThread]: 
[0m16:00:10.932009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:10.934029 [info ] [MainThread]: 
[0m16:00:10.936675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:11.435624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4954290>]}
[0m16:00:11.438373 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:11.440651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd41de3d0>]}
[0m16:00:11.445151 [info ] [MainThread]: 
[0m16:00:11.449137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:11.451521 [info ] [MainThread]: 
[0m16:00:11.454286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:11.462643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:00:11.463973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:00:11.465336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:00:11.520431 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.521193 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.522196 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.523581 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:11.525490 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:11.527141 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:11.528831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.530556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.532161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.561834 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m16:00:11.562612 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:00:11.564163 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.565896 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m16:00:11.566962 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.568779 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:11.570713 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.572598 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:11.575590 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:11.578990 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:00:11.582543 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:11.584176 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:00:11.584816 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:00:11.586418 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:11.589183 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:11.591967 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:11.595552 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:11.597135 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:11.605999 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.609219 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.611937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:10.943863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:00:11.628650 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:00:11.631602 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.611676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:00:11.633676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:11.644620 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m16:00:11.613891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:00:11.648861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4f20250>]}
[0m16:00:11.651315 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:11.653898 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.655931 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.658819 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:00:11.661008 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.663109 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.665161 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.667322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:11.669569 [debug] [MainThread]: On master: Close
[0m16:00:11.678047 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:00:11.678864 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:00:11.679970 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:00:11.681883 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:00:11.684339 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:00:11.686914 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.686500 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:00:11.687814 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.688591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.688941 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.690921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.695026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.689800 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.691579 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:00:11.695790 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:00:11.698681 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:00:11.702006 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:00:11.705134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:00:11.714322 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.023 seconds
[0m16:00:11.707838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:00:11.710126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:00:11.715019 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.020 seconds
[0m16:00:11.712257 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:00:11.714837 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.715749 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.027 seconds
[0m16:00:11.717972 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:00:11.723847 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:00:11.726756 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:00:11.733297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:00:11.717011 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.734793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:00:11.735809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:00:11.719130 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.746699 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.751200 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.757540 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.759457 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:11.721077 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.761513 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:11.763219 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:11.764914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:11.766637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:11.747384 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.768646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:11.756044 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.763626 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.770960 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.777529 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:00:11.779841 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.782806 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.783925 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:00:11.785944 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:11.787458 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:00:11.789158 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.792416 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.794682 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:11.796560 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:00:11.797263 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:11.802046 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:11.803851 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:00:11.784829 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.806272 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:11.809415 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:11.811641 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:00:11.791074 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.815729 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:11.818802 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:11.824124 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:11.811781 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.816164 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.817092 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.825768 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.834677 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.839892 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.844962 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.848320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:11.847528 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.849706 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.852050 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.853259 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:00:11.857839 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:00:11.866046 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:00:11.859106 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.868274 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.860906 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:00:11.869936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:11.863352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:11.866107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:11.868435 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:00:11.870092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:11.874728 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:11.880158 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:11.882933 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m16:00:11.882015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m16:00:11.882859 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.886171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182a73bad0>]}
[0m16:00:11.884070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:11.888212 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:11.890114 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.885427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:00:11.891921 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.886227 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.894238 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:00:11.888022 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.890023 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.895932 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.897501 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.892310 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.898967 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.894468 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.900618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:11.897301 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.901872 [debug] [MainThread]: On master: Close
[0m16:00:11.898215 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:11.899665 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.902391 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:11.911239 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:00:11.903088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:11.912070 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:00:11.914033 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:00:11.909517 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:00:11.913373 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:00:11.915749 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:00:11.914143 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:11.917775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m16:00:11.919781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m16:00:11.916722 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:00:11.918316 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:00:11.921753 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:00:11.919952 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:00:11.922467 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:00:11.924298 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:00:11.927135 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.22s]
[0m16:00:11.928726 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.22s]
[0m16:00:11.924035 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:00:11.930100 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:00:11.931550 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.23s]
[0m16:00:11.933975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:00:11.938507 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:11.933343 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.935685 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.938085 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.23s]
[0m16:00:11.940085 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.942347 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:11.947532 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:00:11.943919 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:11.945631 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.948556 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:00:11.950938 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:00:11.954272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:00:11.956587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:00:11.958643 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:11.955149 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:00:11.960510 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:11.967121 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:11.975985 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:11.987222 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:11.993402 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:11.994615 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:12.001532 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:12.007608 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:12.008418 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:12.009834 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:00:12.011740 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:00:12.013354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:12.015282 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.014862 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:12.015814 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.020738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.021911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.023646 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.022920 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:12.025763 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:00:12.024756 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:12.026395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.026568 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:00:12.027985 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:12.027621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:12.028942 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:00:12.030746 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:12.031154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:12.031439 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:12.034796 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.036151 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.034606 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:00:12.037485 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:00:12.037045 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:00:12.037989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.038598 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:00:12.040158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.039704 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:00:12.041165 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.09s]
[0m16:00:12.042302 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:00:12.043166 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:00:12.043041 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.09s]
[0m16:00:12.044818 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:12.046599 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:12.050505 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.052087 [debug] [MainThread]: On master: BEGIN
[0m16:00:12.053062 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:00:12.053557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:12.052563 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.058122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.059982 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:00:12.059621 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:00:12.061506 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.063278 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.061076 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:00:12.064415 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.063766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.065846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:12.066975 [debug] [MainThread]: On master: Close
[0m16:00:12.068560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:12.065150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.070150 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:00:12.071521 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:00:12.072932 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:00:12.069033 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.074640 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:00:12.074153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.076202 [info ] [MainThread]: 
[0m16:00:12.076006 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:00:12.077797 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m16:00:12.077652 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:00:12.079766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.080614 [debug] [MainThread]: Command end result
[0m16:00:12.081164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.099613 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:00:12.102237 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:00:12.103728 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.105415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.107745 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:00:12.110228 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:00:12.113345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.114029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.122367 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:00:12.129221 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:12.125974 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:00:12.133658 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.135679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.137454 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:12.137499 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:00:12.139372 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:00:12.144278 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:00:12.145616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:00:12.149033 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:00:12.152812 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:12.155169 [info ] [MainThread]: 
[0m16:00:12.152580 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:00:12.158007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:12.158214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d36b0d0>]}
[0m16:00:12.160136 [info ] [MainThread]: 
[0m16:00:12.162528 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:12.159871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d777750>]}
[0m16:00:12.162873 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.24s]
[0m16:00:12.165595 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.24s]
[0m16:00:12.167798 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.397024, "process_in_blocks": "84968", "process_kernel_time": 0.401566, "process_mem_max_rss": "131120", "process_out_blocks": "0", "process_user_time": 3.542026}
[0m16:00:12.168155 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:00:12.170133 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:12.169621 after 2.40 seconds
[0m16:00:12.169768 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:00:12.171644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd510d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd96477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd95d1c50>]}
[0m16:00:12.172913 [debug] [MainThread]: Flushing usage events
[0m16:00:12.172777 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:00:12.174522 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:00:12.176164 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:00:12.177588 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:00:12.190207 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.201931 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:00:12.244404 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.246747 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp160012228144"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:00:12.248621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:12.263975 [debug] [Thread-4 (]: SQL status: SELECT 219 in 0.015 seconds
[0m16:00:12.282160 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.283645 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:00:12.285447 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:00:12.286813 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.288145 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp160012228144'
        
      order by ordinal_position

  
[0m16:00:12.298199 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.009 seconds
[0m16:00:12.304643 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.306039 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:00:12.310459 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:00:12.321352 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.323179 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:00:12.327940 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:00:12.355560 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.366997 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.368415 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp160012228144" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:00:12.372122 [debug] [Thread-4 (]: SQL status: MERGE 219 in 0.002 seconds
[0m16:00:12.375130 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:00:12.376620 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.378067 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:00:12.380830 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.382668 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:00:12.384241 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18286b5dd0>]}
[0m16:00:12.385897 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 219[0m in 0.21s]
[0m16:00:12.387664 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:00:12.390011 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:00:12.391970 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:00:12.393555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:00:12.394974 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:00:12.398880 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.408069 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:00:12.420707 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.430711 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.432695 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:00:12.434713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:12.440713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:00:12.442221 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.443406 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:00:12.452200 [debug] [Thread-2 (]: SQL status: SELECT 48 in 0.007 seconds
[0m16:00:12.459586 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.461244 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:00:12.463206 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.467655 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.469751 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:00:12.471538 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:12.474293 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:00:12.475650 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.477264 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:00:12.480308 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.484303 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:00:12.488641 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.490385 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:00:12.494338 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:00:12.496885 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:00:12.498272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18286c2b10>]}
[0m16:00:12.499886 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 48[0m in 0.10s]
[0m16:00:12.501380 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:00:12.504086 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.505175 [debug] [MainThread]: On master: BEGIN
[0m16:00:12.506081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:12.511057 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:00:12.512786 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.514287 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.515616 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.517400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:12.519186 [debug] [MainThread]: On master: Close
[0m16:00:12.520750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:12.522381 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m16:00:12.523844 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:00:12.524886 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:00:12.525734 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:00:12.527188 [info ] [MainThread]: 
[0m16:00:12.528586 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m16:00:12.531174 [debug] [MainThread]: Command end result
[0m16:00:12.573637 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:12.583658 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:12.599264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:12.601687 [info ] [MainThread]: 
[0m16:00:12.604131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:12.605779 [info ] [MainThread]: 
[0m16:00:12.608115 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:00:12.611822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8360689, "process_in_blocks": "89664", "process_kernel_time": 0.617757, "process_mem_max_rss": "125632", "process_out_blocks": "0", "process_user_time": 3.586977}
[0m16:00:12.614521 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:12.614022 after 2.84 seconds
[0m16:00:12.616203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e7dfd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1832c5b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1832bbb210>]}
[0m16:00:12.618333 [debug] [MainThread]: Flushing usage events
[0m16:00:13.619930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:14.151574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:25.413806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41ffcbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420182090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41ffcbb90>]}


============================== 16:00:25.433095 | 8b03ce27-86cd-4834-be35-b22b02d02102 ==============================
[0m16:00:25.433095 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:25.436505 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'log_path': '/opt/airflow/dbt_crypto/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True'}
[0m16:00:25.682039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41ffcea50>]}
[0m16:00:25.750920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42289d2d0>]}
[0m16:00:25.754166 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:25.918691 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:26.224157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:26.227252 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:26.229281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:26.285976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41e7f86d0>]}
[0m16:00:26.405839 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:26.431192 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:26.913470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41f3330d0>]}
[0m16:00:26.916647 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:26.918460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421c7a490>]}
[0m16:00:26.922789 [info ] [MainThread]: 
[0m16:00:26.926050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:26.928232 [info ] [MainThread]: 
[0m16:00:26.932211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:26.938977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:00:26.940193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:00:26.941314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:00:27.005344 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:27.006127 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:27.006972 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:27.008621 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:27.010715 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:27.012544 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:27.014282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:27.015731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:27.017864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:27.064934 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:00:27.066376 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:00:27.067492 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:27.068279 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:00:27.069695 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:27.071683 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:27.073077 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:27.074652 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:27.077747 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:27.081484 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:00:27.084518 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:27.085233 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:00:27.085872 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:00:27.086779 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:27.088715 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:27.091603 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:27.096756 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:27.098309 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:27.106833 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.108820 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.110767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:27.117800 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:00:27.119297 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.120505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:27.132740 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m16:00:27.135450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41dfb8b50>]}
[0m16:00:27.137124 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:27.138836 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.140504 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.142633 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:00:27.144492 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.146187 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.147634 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.149166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:27.150363 [debug] [MainThread]: On master: Close
[0m16:00:27.157001 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.157592 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.158117 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.158582 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.159531 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:00:27.161077 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:00:27.162606 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:00:27.164033 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:00:27.165834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:00:27.168084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:00:27.169418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:00:27.170783 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:00:27.173175 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.175371 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.177176 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.179218 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.197895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.202530 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.208546 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.214476 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.222871 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.224408 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.230891 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.231585 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.245693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.249038 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.254529 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.258821 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.267398 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.268977 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.270796 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.271601 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:00:27.272181 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.273347 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:00:27.275252 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:00:27.276756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:27.278473 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:00:27.280070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:27.281853 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:27.284654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:27.288878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:00:27.291599 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.293326 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.293886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:27.295366 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:27.296421 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:27.297027 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.298885 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.300455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:00:27.305817 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:00:27.307691 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.309354 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.311221 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.313273 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:00:27.316883 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:27.317852 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.318669 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:27.321731 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.15s]
[0m16:00:27.324814 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:00:27.329011 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:00:27.329726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:27.331462 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.333205 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:00:27.334383 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:00:27.336452 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:00:27.337731 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.339287 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.17s]
[0m16:00:27.340839 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.17s]
[0m16:00:27.342286 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:00:27.343454 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:00:27.345421 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.347738 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.349693 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.18s]
[0m16:00:27.350952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:00:27.352415 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.354865 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.356217 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.357672 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:00:27.364371 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.366533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:00:27.369059 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.374231 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.381291 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.385400 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.385945 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.390314 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.396292 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.398069 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:00:27.398722 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.400063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:27.401671 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:00:27.404235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:27.408069 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:00:27.409654 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.411037 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.412558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m16:00:27.413585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:27.414363 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.416790 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:00:27.418075 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.419702 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:00:27.422564 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.07s]
[0m16:00:27.423773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:27.425238 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.427684 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:00:27.430210 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:00:27.431877 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.07s]
[0m16:00:27.433293 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.435996 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.437334 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.438989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:27.445485 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:00:27.446996 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.448405 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.449680 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.451337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:27.452885 [debug] [MainThread]: On master: Close
[0m16:00:27.455022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:27.456759 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:00:27.458464 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:00:27.460002 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:00:27.461460 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:00:27.462992 [info ] [MainThread]: 
[0m16:00:27.464807 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:00:27.467497 [debug] [MainThread]: Command end result
[0m16:00:27.512352 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:27.520245 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:27.532680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:27.534290 [info ] [MainThread]: 
[0m16:00:27.536568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:27.538239 [info ] [MainThread]: 
[0m16:00:27.540021 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:27.543957 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.256362, "process_in_blocks": "97304", "process_kernel_time": 0.498768, "process_mem_max_rss": "126296", "process_out_blocks": "0", "process_user_time": 3.200431}
[0m16:00:27.545547 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:27.545247 after 2.26 seconds
[0m16:00:27.546791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420182010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420181ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42455db50>]}
[0m16:00:27.548172 [debug] [MainThread]: Flushing usage events
[0m16:00:29.238447 [debug] [MainThread]: An error was encountered while trying to flush usage events
