[0m21:12:38.692510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D41D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E48AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E4889A0>]}


============================== 21:12:38.696789 | 5ebd0e99-b890-4236-a6be-ae42a1db8484 ==============================
[0m21:12:38.696789 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:12:38.696789 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto\\logs'}
[0m21:12:38.965121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E48BD60>]}
[0m21:12:39.077215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266DC10880>]}
[0m21:12:39.080897 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:12:39.430817 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:12:39.432761 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:12:39.433796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E5033A0>]}
[0m21:12:42.369106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FF67FA0>]}
[0m21:12:42.515916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:12:42.535793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:12:42.560640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FF3F040>]}
[0m21:12:42.561355 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m21:12:42.561355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FF63A30>]}
[0m21:12:42.563081 [info ] [MainThread]: 
[0m21:12:42.564226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:42.564226 [info ] [MainThread]: 
[0m21:12:42.565120 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:12:42.570437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m21:12:42.570437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m21:12:42.576618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m21:12:46.181175 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m21:12:46.181707 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m21:12:46.181707 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m21:12:46.182225 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:12:46.182225 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:12:46.182225 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:12:46.183973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.183973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.184580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.217610 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.033 seconds
[0m21:12:46.218152 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.034 seconds
[0m21:12:46.218729 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.034 seconds
[0m21:12:46.219844 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m21:12:46.220960 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m21:12:46.222072 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m21:12:46.222072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_silver)
[0m21:12:46.222072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_gold)
[0m21:12:46.222072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_bronze)
[0m21:12:46.225806 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_silver"
"
[0m21:12:46.225806 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_gold"
"
[0m21:12:46.225806 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_bronze"
"
[0m21:12:46.232170 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m21:12:46.232170 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m21:12:46.232170 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m21:12:46.232170 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: BEGIN
[0m21:12:46.232170 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: BEGIN
[0m21:12:46.232170 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: BEGIN
[0m21:12:46.232170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:46.232170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:46.232170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m21:12:46.252538 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_gold"} */
create schema if not exists "public_gold"
[0m21:12:46.252538 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m21:12:46.252538 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_bronze"} */
create schema if not exists "public_bronze"
[0m21:12:46.252538 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_silver"} */
create schema if not exists "public_silver"
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:12:46.252538 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:12:46.260178 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m21:12:46.260178 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m21:12:46.262251 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m21:12:46.263106 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m21:12:46.263648 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m21:12:46.263648 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m21:12:46.263648 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: Close
[0m21:12:46.263648 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m21:12:46.263648 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: Close
[0m21:12:46.263648 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: Close
[0m21:12:46.263648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m21:12:46.263648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m21:12:46.278260 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:12:46.278260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m21:12:46.280355 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:12:46.280355 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m21:12:46.283127 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:12:46.284146 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m21:12:46.284146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.285177 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m21:12:46.285177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.286149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.297632 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m21:12:46.297632 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:12:46.297632 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:12:46.313886 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m21:12:46.313886 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m21:12:46.313886 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:12:46.313886 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:12:46.313886 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:12:46.313886 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:12:46.313886 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m21:12:46.325675 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m21:12:46.325675 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m21:12:46.325675 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:12:46.325675 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:12:46.328845 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m21:12:46.329453 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m21:12:46.331790 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m21:12:46.331790 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m21:12:46.335631 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.335631 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.338608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:46.353786 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m21:12:46.353786 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.360271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:12:46.375748 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:12:46.375748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FC509D0>]}
[0m21:12:46.375748 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:46.378867 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.378867 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.380432 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:12:46.380432 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.380432 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.380432 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.382492 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:12:46.382492 [debug] [MainThread]: On master: Close
[0m21:12:46.389392 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.389926 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.391041 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m21:12:46.391579 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m21:12:46.392634 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_crypto.bronze_historical_klines'
[0m21:12:46.393716 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_crypto.bronze_realtime_klines'
[0m21:12:46.393716 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.394811 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.402356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.406961 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.409930 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.410449 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.441157 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.445131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.448134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.448134 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.449136 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m21:12:46.449136 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m21:12:46.449136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:12:46.450309 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:12:46.462431 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m21:12:46.463016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.463593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m21:12:46.464141 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m21:12:46.464723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.465296 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m21:12:46.483591 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m21:12:46.483591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m21:12:46.492750 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.496152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.496686 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m21:12:46.497317 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m21:12:46.500344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:12:46.500344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:12:46.513827 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.513827 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.513827 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m21:12:46.513827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:12:46.513827 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m21:12:46.530547 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m21:12:46.533739 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m21:12:46.538433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m21:12:46.539433 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m21:12:46.540104 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m21:12:46.540104 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m21:12:46.543772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:12:46.544509 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:12:46.547362 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m21:12:46.549304 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m21:12:46.554073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266FFB3760>]}
[0m21:12:46.554418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226701C6B90>]}
[0m21:12:46.555491 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.16s]
[0m21:12:46.556614 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.16s]
[0m21:12:46.557171 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m21:12:46.558295 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m21:12:46.559229 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m21:12:46.559229 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m21:12:46.560267 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m21:12:46.560267 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m21:12:46.565595 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.565595 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m21:12:46.601808 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.603579 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.604597 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m21:12:46.604597 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:12:46.617067 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m21:12:46.617067 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.618083 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      
  
    

  create  table "crypto_analytics"."public_silver"."silver_klines_1m"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


  );
  
  
[0m21:12:46.775475 [debug] [Thread-4 (]: SQL status: SELECT 9249 in 0.157 seconds
[0m21:12:46.779026 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m21:12:46.780599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m21:12:46.780599 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m21:12:46.792508 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m21:12:46.792508 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m21:12:46.792508 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267033BA00>]}
[0m21:12:46.792508 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mSELECT 9249[0m in 0.23s]
[0m21:12:46.792508 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m21:12:46.792508 [debug] [Thread-1 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m21:12:46.792508 [info ] [Thread-1 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m21:12:46.792508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_historical_klines, now model.dbt_crypto.gold_klines_5m)
[0m21:12:46.799845 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m21:12:46.804349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.806347 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m21:12:46.819461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.821083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.821608 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m21:12:46.822131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:46.845504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m21:12:46.845504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.846519 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m21:12:46.882449 [debug] [Thread-1 (]: SQL status: SELECT 1854 in 0.036 seconds
[0m21:12:46.882449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.882449 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m21:12:46.882449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:12:46.882449 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m21:12:46.882449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.882449 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m21:12:46.893020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:12:46.897323 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m21:12:46.899519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m21:12:46.900061 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m21:12:46.901128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:12:46.902696 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m21:12:46.903220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ebd0e99-b890-4236-a6be-ae42a1db8484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226701C6B90>]}
[0m21:12:46.904282 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 1854[0m in 0.11s]
[0m21:12:46.904835 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m21:12:46.906467 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.906467 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.907077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:46.932191 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m21:12:46.933198 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.933198 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.933198 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.934647 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:12:46.935845 [debug] [MainThread]: On master: Close
[0m21:12:46.935845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:46.936972 [debug] [MainThread]: Connection 'create_crypto_analytics_public_gold' was properly closed.
[0m21:12:46.937724 [debug] [MainThread]: Connection 'create_crypto_analytics_public_bronze' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'create_crypto_analytics_public_silver' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_realtime_klines' was properly closed.
[0m21:12:46.938138 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m21:12:46.938138 [info ] [MainThread]: 
[0m21:12:46.942704 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m21:12:46.943711 [debug] [MainThread]: Command end result
[0m21:12:46.963076 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:12:46.965628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:12:46.972667 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\StudyZone\Project\Binance\dbt_crypto\target\run_results.json
[0m21:12:46.972667 [info ] [MainThread]: 
[0m21:12:46.973664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:46.974663 [info ] [MainThread]: 
[0m21:12:46.974663 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:12:46.975664 [debug] [MainThread]: Command `dbt run` succeeded at 21:12:46.975664 after 8.36 seconds
[0m21:12:46.976234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D41D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266E48BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266C002110>]}
[0m21:12:46.976983 [debug] [MainThread]: Flushing usage events
[0m21:12:48.917240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:03.641210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DC8D8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599ECDF6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599ECDCBB0>]}


============================== 21:13:03.645627 | fed01617-4442-43b0-8b92-a9b6e5f74ee6 ==============================
[0m21:13:03.645627 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:13:03.646694 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\StudyZone\\Project\\Binance\\dbt_crypto\\logs'}
[0m21:13:03.875488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599ECDCA00>]}
[0m21:13:03.962880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DD4E800>]}
[0m21:13:03.964633 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:13:04.163018 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:13:04.335156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:04.335156 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:13:04.336571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:04.384054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A03D8130>]}
[0m21:13:04.515017 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:13:04.519166 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:13:04.553736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A03CE770>]}
[0m21:13:04.553736 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m21:13:04.554741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A0407730>]}
[0m21:13:04.556179 [info ] [MainThread]: 
[0m21:13:04.557197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:04.558197 [info ] [MainThread]: 
[0m21:13:04.558590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:04.563017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m21:13:04.563017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m21:13:04.563017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m21:13:04.632439 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:13:04.632987 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:13:04.632987 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:13:04.633549 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m21:13:04.633549 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m21:13:04.633549 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m21:13:04.633549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:04.633549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:04.633549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:04.652367 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:13:04.652367 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:13:04.653446 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m21:13:04.654014 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m21:13:04.654525 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:13:04.655031 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:13:04.660369 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.661059 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:13:04.662736 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m21:13:04.663864 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m21:13:04.664948 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m21:13:04.665472 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m21:13:04.665994 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m21:13:04.667559 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m21:13:04.668113 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:13:04.672853 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:13:04.674442 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m21:13:04.675499 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m21:13:04.680463 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.681077 [debug] [MainThread]: On master: BEGIN
[0m21:13:04.681077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:04.718095 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m21:13:04.718636 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.719210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:13:04.727216 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m21:13:04.728732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed01617-4442-43b0-8b92-a9b6e5f74ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599F006080>]}
[0m21:13:04.729770 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:04.731372 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.732432 [debug] [MainThread]: On master: BEGIN
[0m21:13:04.734675 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:13:04.735347 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.736437 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.737004 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.738119 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:13:04.738677 [debug] [MainThread]: On master: Close
[0m21:13:04.743541 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.744085 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.744630 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.745178 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.745720 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m21:13:04.746796 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m21:13:04.747331 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m21:13:04.748417 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m21:13:04.749476 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7'
[0m21:13:04.750171 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4'
[0m21:13:04.750691 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb'
[0m21:13:04.751788 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m21:13:04.751788 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.753266 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.753847 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.754412 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.770067 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.775007 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.779710 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.787009 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.789894 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.811053 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.813495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.817303 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.817859 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.818446 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.822916 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.826852 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.827402 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.828474 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.829530 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m21:13:04.830699 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m21:13:04.831256 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.831803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:13:04.832886 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.833448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:04.834027 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m21:13:04.834586 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m21:13:04.835594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:13:04.836597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:13:04.850908 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m21:13:04.851465 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m21:13:04.852601 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.854787 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m21:13:04.855867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m21:13:04.856405 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m21:13:04.857463 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.858536 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m21:13:04.859070 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.864431 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m21:13:04.865510 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.867126 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m21:13:04.867678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m21:13:04.870067 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.870067 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:13:04.869472 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.12s]
[0m21:13:04.871075 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m21:13:04.873263 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m21:13:04.874271 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m21:13:04.876344 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m21:13:04.876878 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.878364 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.878894 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m21:13:04.879449 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m21:13:04.879993 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m21:13:04.881064 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.13s]
[0m21:13:04.882239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:13:04.882790 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.13s]
[0m21:13:04.884038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m21:13:04.884997 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m21:13:04.886615 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m21:13:04.887683 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m21:13:04.888222 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.888773 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.894094 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.894094 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m21:13:04.896326 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m21:13:04.897924 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.15s]
[0m21:13:04.899320 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m21:13:04.899931 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.901021 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m21:13:04.901704 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.904423 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.910211 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.912226 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.912921 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.915872 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m21:13:04.920897 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.920897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:04.923743 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.923743 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m21:13:04.924851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:04.941819 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m21:13:04.942896 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m21:13:04.943431 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.945768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m21:13:04.946312 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m21:13:04.946856 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m21:13:04.948094 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:13:04.948094 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m21:13:04.951213 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:13:04.951213 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m21:13:04.952741 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m21:13:04.954777 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.07s]
[0m21:13:04.955369 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m21:13:04.955369 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m21:13:04.955369 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.06s]
[0m21:13:04.958608 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m21:13:04.960118 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.960118 [debug] [MainThread]: On master: BEGIN
[0m21:13:04.960118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:04.973362 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:13:04.973362 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.974362 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:04.974362 [debug] [MainThread]: On master: COMMIT
[0m21:13:04.975879 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:13:04.976430 [debug] [MainThread]: On master: Close
[0m21:13:04.976853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:04.976853 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m21:13:04.977899 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m21:13:04.977899 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m21:13:04.978905 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m21:13:04.980113 [info ] [MainThread]: 
[0m21:13:04.980420 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:13:04.982205 [debug] [MainThread]: Command end result
[0m21:13:05.003076 [debug] [MainThread]: Wrote artifact WritableManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\manifest.json
[0m21:13:05.006547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\StudyZone\Project\Binance\dbt_crypto\target\semantic_manifest.json
[0m21:13:05.014745 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\StudyZone\Project\Binance\dbt_crypto\target\run_results.json
[0m21:13:05.015304 [info ] [MainThread]: 
[0m21:13:05.015878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:05.016459 [info ] [MainThread]: 
[0m21:13:05.017080 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m21:13:05.018171 [debug] [MainThread]: Command `dbt test` succeeded at 21:13:05.018171 after 1.47 seconds
[0m21:13:05.018739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DC8D8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001599DD46A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159A03CE7D0>]}
[0m21:13:05.019305 [debug] [MainThread]: Flushing usage events
[0m21:13:06.516378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:46.405202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7acc9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7accaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7acc8610>]}


============================== 15:59:46.413529 | b538c073-2918-4b55-9add-72e50ad72b49 ==============================
[0m15:59:46.413529 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:59:46.415412 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '.', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'printer_width': '80'}
[0m15:59:46.681645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7a3cc110>]}
[0m15:59:46.745963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7d5ad090>]}
[0m15:59:46.749855 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:59:46.894576 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:59:47.120507 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:59:47.122338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7c0e0190>]}
[0m15:59:49.486493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78f3bd90>]}
[0m15:59:49.631800 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:49.639864 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:49.703182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d72441610>]}
[0m15:59:49.706181 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m15:59:49.708203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d781e1650>]}
[0m15:59:49.712093 [info ] [MainThread]: 
[0m15:59:49.714100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:49.715892 [info ] [MainThread]: 
[0m15:59:49.717569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:49.723401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:49.724669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:49.726112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:49.767935 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:49.768499 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:49.769040 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:49.770773 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:49.772791 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:49.774720 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:49.776442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:49.778017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:49.780075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:49.806029 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m15:59:49.806579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m15:59:49.807101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m15:59:49.808879 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:49.811443 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:49.813797 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:49.818171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_bronze)
[0m15:59:49.818768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_gold)
[0m15:59:49.819238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now create_crypto_analytics_public_silver)
[0m15:59:49.820551 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_bronze"
"
[0m15:59:49.821816 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_gold"
"
[0m15:59:49.823240 [debug] [ThreadPool]: Creating schema "database: "crypto_analytics"
schema: "public_silver"
"
[0m15:59:49.829987 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m15:59:49.833738 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m15:59:49.837087 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m15:59:49.838733 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: BEGIN
[0m15:59:49.840489 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: BEGIN
[0m15:59:49.841709 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: BEGIN
[0m15:59:49.842703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.843682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.844797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.852971 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:59:49.853684 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:59:49.854203 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:59:49.855731 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m15:59:49.857328 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m15:59:49.858873 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m15:59:49.860690 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_bronze"} */
create schema if not exists "public_bronze"
[0m15:59:49.861995 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_gold"} */
create schema if not exists "public_gold"
[0m15:59:49.863219 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "create_crypto_analytics_public_silver"} */
create schema if not exists "public_silver"
[0m15:59:49.869363 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m15:59:49.870226 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m15:59:49.870683 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m15:59:49.872626 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m15:59:49.875013 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m15:59:49.877028 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m15:59:49.878176 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_bronze"
[0m15:59:49.879275 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_gold"
[0m15:59:49.880710 [debug] [ThreadPool]: Using postgres connection "create_crypto_analytics_public_silver"
[0m15:59:49.881745 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: COMMIT
[0m15:59:49.882787 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: COMMIT
[0m15:59:49.883790 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: COMMIT
[0m15:59:49.885891 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:59:49.886449 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:59:49.887779 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:59:49.888248 [debug] [ThreadPool]: On create_crypto_analytics_public_bronze: Close
[0m15:59:49.889668 [debug] [ThreadPool]: On create_crypto_analytics_public_gold: Close
[0m15:59:49.891066 [debug] [ThreadPool]: On create_crypto_analytics_public_silver: Close
[0m15:59:49.895924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_analytics_public_silver, now list_crypto_analytics_public_bronze)
[0m15:59:49.896618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_analytics_public_gold, now list_crypto_analytics_public_gold)
[0m15:59:49.897180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_analytics_public_bronze, now list_crypto_analytics_public_silver)
[0m15:59:49.903889 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:49.906846 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:49.909964 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:49.911515 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m15:59:49.913067 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m15:59:49.914130 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m15:59:49.915557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.916720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.917765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:49.924275 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:59:49.924818 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:59:49.925629 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:59:49.926457 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:49.928101 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:49.929457 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:49.930538 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m15:59:49.931712 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m15:59:49.932835 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m15:59:49.951096 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m15:59:49.951567 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m15:59:49.951956 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m15:59:49.953686 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m15:59:49.955429 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m15:59:49.957280 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m15:59:49.959036 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m15:59:49.960206 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m15:59:49.961226 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m15:59:49.968748 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:49.970410 [debug] [MainThread]: On master: BEGIN
[0m15:59:49.971805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:49.977970 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:59:49.979468 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:49.980755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:49.998892 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m15:59:50.001259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7a3071d0>]}
[0m15:59:50.002682 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:50.004094 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.005391 [debug] [MainThread]: On master: BEGIN
[0m15:59:50.006943 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:59:50.008370 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.009492 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.010437 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.012064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:50.013482 [debug] [MainThread]: On master: Close
[0m15:59:50.021643 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.022215 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.023967 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m15:59:50.026605 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m15:59:50.027947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m15:59:50.029100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_realtime_klines)
[0m15:59:50.030181 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.031212 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.040720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.268541 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.279486 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.287256 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.331524 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.334690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.343480 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.345237 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m15:59:50.345870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.347301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:50.349353 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m15:59:50.352380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:50.356650 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m15:59:50.358146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.359062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:59:50.359856 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m15:59:50.361521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.364437 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m15:59:50.378880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m15:59:50.379546 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:59:50.386754 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.390770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.392285 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m15:59:50.393936 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m15:59:50.397736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:50.398288 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:59:50.412157 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:50.414189 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:50.415664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.417600 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.419322 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:50.421042 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:50.423973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.424596 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.432257 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m15:59:50.435641 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m15:59:50.442229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:50.444013 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:50.445766 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m15:59:50.447116 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m15:59:50.450324 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:59:50.450834 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:59:50.453712 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m15:59:50.455648 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m15:59:50.458630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78fb71d0>]}
[0m15:59:50.459679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78f2e4d0>]}
[0m15:59:50.461261 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.43s]
[0m15:59:50.462777 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.43s]
[0m15:59:50.464611 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:50.466196 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m15:59:50.468601 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m15:59:50.469773 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m15:59:50.471179 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m15:59:50.472441 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m15:59:50.479006 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.490015 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m15:59:50.527288 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.537495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.538901 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m15:59:50.540118 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:50.546153 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m15:59:50.547792 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.548941 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      
  
    

  create  table "crypto_analytics"."public_silver"."silver_klines_1m"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


  );
  
  
[0m15:59:50.565542 [debug] [Thread-4 (]: SQL status: SELECT 216 in 0.015 seconds
[0m15:59:50.571676 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:50.573141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:50.574825 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:50.577695 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.579440 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m15:59:50.580771 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78b13f50>]}
[0m15:59:50.582180 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mSELECT 216[0m in 0.11s]
[0m15:59:50.583570 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m15:59:50.585286 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m15:59:50.586476 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m15:59:50.587704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m15:59:50.588784 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m15:59:50.593025 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.601643 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m15:59:50.615466 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.629545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.631134 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m15:59:50.632665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:50.640196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m15:59:50.641960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.643807 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m15:59:50.670193 [debug] [Thread-2 (]: SQL status: SELECT 45 in 0.024 seconds
[0m15:59:50.674917 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.677175 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m15:59:50.679027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:59:50.681706 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:50.682833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.684485 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:50.687187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:50.690839 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m15:59:50.695219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:50.697097 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m15:59:50.699169 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:59:50.701651 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m15:59:50.704374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b538c073-2918-4b55-9add-72e50ad72b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d78b04e90>]}
[0m15:59:50.706760 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 45[0m in 0.12s]
[0m15:59:50.708891 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m15:59:50.713042 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.715045 [debug] [MainThread]: On master: BEGIN
[0m15:59:50.716705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:50.723879 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:59:50.725422 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.727508 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:50.729448 [debug] [MainThread]: On master: COMMIT
[0m15:59:50.731835 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:50.733878 [debug] [MainThread]: On master: Close
[0m15:59:50.735903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:50.737447 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m15:59:50.739654 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m15:59:50.741967 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m15:59:50.743734 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m15:59:50.745906 [info ] [MainThread]: 
[0m15:59:50.747299 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m15:59:50.751095 [debug] [MainThread]: Command end result
[0m15:59:50.805851 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:50.813754 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:50.830020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m15:59:50.832158 [info ] [MainThread]: 
[0m15:59:50.834497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:50.836185 [info ] [MainThread]: 
[0m15:59:50.838866 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:59:50.845221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5265245, "process_in_blocks": "151592", "process_kernel_time": 0.683724, "process_mem_max_rss": "138776", "process_out_blocks": "2312", "process_user_time": 4.532114}
[0m15:59:50.848039 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:50.847553 after 4.53 seconds
[0m15:59:50.850057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7f294350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7f2fb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7d266f90>]}
[0m15:59:50.852451 [debug] [MainThread]: Flushing usage events
[0m15:59:52.079939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bc48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441dd9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bccd90>]}


============================== 15:59:52.089024 | 9e7d349e-ef9b-4eb7-a85f-0db14baa232d ==============================
[0m15:59:52.089024 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:59:52.090750 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:59:52.348061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bd8090>]}
[0m15:59:52.456085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9444592c50>]}
[0m15:59:52.459403 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:59:52.562595 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:59:52.867270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:52.882739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:52.884228 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:59:52.885689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:52.931944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94403fcb90>]}
[0m15:59:53.038046 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:53.045641 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:53.075268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9440b347d0>]}
[0m15:59:53.076860 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m15:59:53.078489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bba410>]}
[0m15:59:53.082144 [info ] [MainThread]: 
[0m15:59:53.084193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:53.086260 [info ] [MainThread]: 
[0m15:59:53.088496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:53.095344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:53.170772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:53.171919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m15:59:53.212217 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:53.212797 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:53.213299 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m15:59:53.214513 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:53.216236 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:53.217943 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:59:53.219624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:53.221210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:53.222402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:53.231141 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m15:59:53.232601 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m15:59:53.235659 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:53.236522 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m15:59:53.239471 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:53.244674 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m15:59:53.250666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m15:59:53.251507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m15:59:53.252386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m15:59:53.260030 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:53.263695 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:53.267697 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:53.269704 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m15:59:53.271542 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m15:59:53.273335 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m15:59:53.275018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:53.277161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:53.279008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:53.286756 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:59:53.288127 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:59:53.289806 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:59:53.290462 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m15:59:53.292176 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m15:59:53.294024 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m15:59:53.295808 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m15:59:53.297394 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m15:59:53.298703 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m15:59:53.304856 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m15:59:53.305741 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:59:53.309436 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m15:59:53.310405 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:59:53.314150 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m15:59:53.316709 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m15:59:53.319520 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m15:59:53.322056 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m15:59:53.326627 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m15:59:53.337437 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.340291 [debug] [MainThread]: On master: BEGIN
[0m15:59:53.342881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:53.356753 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:59:53.358553 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.360293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:53.369191 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:59:53.374077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441bbaf50>]}
[0m15:59:53.376713 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:53.378708 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.380652 [debug] [MainThread]: On master: BEGIN
[0m15:59:53.383019 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:59:53.384877 [debug] [MainThread]: On master: COMMIT
[0m15:59:53.387134 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:53.389296 [debug] [MainThread]: On master: COMMIT
[0m15:59:53.391761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:53.393600 [debug] [MainThread]: On master: Close
[0m15:59:53.415335 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.415936 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.417751 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m15:59:53.419364 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m15:59:53.420783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m15:59:53.422126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m15:59:53.423251 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.424538 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.434542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.439195 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.446105 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.453164 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.504847 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.505933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.514838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.517005 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m15:59:53.517544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.518822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:53.520857 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m15:59:53.524076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:53.527143 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m15:59:53.528944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.530466 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m15:59:53.531821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:59:53.533764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.535226 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m15:59:53.536391 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:59:53.544921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:59:53.545563 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.549220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.551125 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m15:59:53.553466 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m15:59:53.556012 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:53.558350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:59:53.562710 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.566796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.568264 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m15:59:53.569611 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m15:59:53.571430 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:53.572738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:53.593220 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:53.595428 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:53.597385 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.599220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.600855 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m15:59:53.602438 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m15:59:53.606086 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:59:53.614111 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m15:59:53.614762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:59:53.625380 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m15:59:53.630116 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m15:59:53.631876 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m15:59:53.634401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m15:59:53.637421 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m15:59:53.643036 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:59:53.644231 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:59:53.647035 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m15:59:53.650303 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m15:59:53.657166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943ddc3ad0>]}
[0m15:59:53.658896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943dc41310>]}
[0m15:59:53.661377 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.23s]
[0m15:59:53.664946 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.24s]
[0m15:59:53.668391 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m15:59:53.671167 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m15:59:53.678926 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m15:59:53.681688 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m15:59:53.684035 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m15:59:53.686103 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m15:59:53.706571 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.721005 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m15:59:53.763942 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.765550 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp155953749219"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m15:59:53.767087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:53.778822 [debug] [Thread-4 (]: SQL status: SELECT 216 in 0.012 seconds
[0m15:59:53.795166 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.796729 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m15:59:53.798405 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m15:59:53.799864 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.801289 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp155953749219'
        
      order by ordinal_position

  
[0m15:59:53.825092 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.023 seconds
[0m15:59:53.832359 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.834970 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m15:59:53.841646 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.004 seconds
[0m15:59:53.854986 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.856757 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m15:59:53.861916 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.004 seconds
[0m15:59:53.888996 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.899624 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.901250 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp155953749219" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m15:59:53.906265 [debug] [Thread-4 (]: SQL status: MERGE 216 in 0.003 seconds
[0m15:59:53.909081 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:53.910765 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m15:59:53.912310 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m15:59:53.914931 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:53.916883 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m15:59:53.918632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943dce0450>]}
[0m15:59:53.920226 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 216[0m in 0.23s]
[0m15:59:53.922025 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m15:59:53.924360 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m15:59:53.925791 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m15:59:53.927236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m15:59:53.928838 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m15:59:53.933184 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.946314 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m15:59:53.960123 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.969878 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.971332 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m15:59:53.972519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:53.977955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:59:53.979561 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:53.981018 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m15:59:53.990270 [debug] [Thread-2 (]: SQL status: SELECT 45 in 0.008 seconds
[0m15:59:53.999400 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.001130 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m15:59:54.002988 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:59:54.008219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.009537 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m15:59:54.011126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:59:54.013763 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:54.015336 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.016887 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m15:59:54.018895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:54.022722 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m15:59:54.026759 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m15:59:54.027960 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m15:59:54.031870 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:59:54.034596 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m15:59:54.036076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e7d349e-ef9b-4eb7-a85f-0db14baa232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943ded7e50>]}
[0m15:59:54.037464 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 45[0m in 0.11s]
[0m15:59:54.038886 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m15:59:54.042114 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:54.043255 [debug] [MainThread]: On master: BEGIN
[0m15:59:54.044627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:54.050290 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:59:54.051639 [debug] [MainThread]: On master: COMMIT
[0m15:59:54.052987 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:54.054247 [debug] [MainThread]: On master: COMMIT
[0m15:59:54.055566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:54.056600 [debug] [MainThread]: On master: Close
[0m15:59:54.058343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:54.060045 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m15:59:54.061324 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m15:59:54.062686 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m15:59:54.063723 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m15:59:54.065396 [info ] [MainThread]: 
[0m15:59:54.067125 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m15:59:54.070067 [debug] [MainThread]: Command end result
[0m15:59:54.124510 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m15:59:54.133657 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m15:59:54.148225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m15:59:54.150231 [info ] [MainThread]: 
[0m15:59:54.152439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:54.153915 [info ] [MainThread]: 
[0m15:59:54.155754 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:59:54.163490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1718009, "process_in_blocks": "36496", "process_kernel_time": 0.439776, "process_mem_max_rss": "125992", "process_out_blocks": "0", "process_user_time": 3.188378}
[0m15:59:54.168641 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:54.168092 after 2.18 seconds
[0m15:59:54.171303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441dd9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441a23b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94462db710>]}
[0m15:59:54.173308 [debug] [MainThread]: Flushing usage events
[0m15:59:55.599295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:03.851662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff599ec3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5977f7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597604c90>]}


============================== 16:00:03.876119 | 095a6403-b63c-42f4-9480-d0036964af90 ==============================
[0m16:00:03.876119 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:03.879425 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt_crypto/logs', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m16:00:04.099855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff596f67e10>]}
[0m16:00:04.164801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff599ee0b10>]}
[0m16:00:04.167249 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:04.247632 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:04.600468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:04.602508 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:04.604056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:04.656312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5963ac4d0>]}
[0m16:00:04.778200 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:04.803785 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:04.929964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff596781510>]}
[0m16:00:04.932461 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:04.934351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff595b50450>]}
[0m16:00:04.938087 [info ] [MainThread]: 
[0m16:00:04.940032 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:04.942354 [info ] [MainThread]: 
[0m16:00:04.945256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:04.952703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:00:04.954765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:00:04.956069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:00:05.006640 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:05.007813 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:05.008510 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:05.009589 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:05.011356 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:05.012755 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:05.014626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.016011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.017464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.025207 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:00:05.026261 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:00:05.027210 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:00:05.028180 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:05.029523 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:05.030765 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:05.032508 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:05.033891 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:05.035305 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:05.041333 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:00:05.041950 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:00:05.042429 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:05.044192 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:05.046519 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:05.048329 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:05.049832 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:05.051111 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:05.052235 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:05.060772 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.062016 [debug] [MainThread]: On master: BEGIN
[0m16:00:05.063145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:05.069572 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:00:05.071258 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.072932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:05.079714 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:00:05.082013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095a6403-b63c-42f4-9480-d0036964af90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5975b7ad0>]}
[0m16:00:05.083448 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:05.084760 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.086037 [debug] [MainThread]: On master: BEGIN
[0m16:00:05.087473 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:00:05.088764 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.089847 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.090835 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.092025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:05.093235 [debug] [MainThread]: On master: Close
[0m16:00:05.099872 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.100464 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.100964 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.101439 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.102275 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:00:05.103582 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:00:05.104832 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:00:05.106263 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:00:05.107684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:00:05.109320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:00:05.110465 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:00:05.111646 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:00:05.112953 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.114846 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.116594 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.118115 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.134521 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.139095 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.144204 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.149250 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.156928 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.158869 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.164982 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.179399 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.182519 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.183087 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.188134 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.194425 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.200880 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.202510 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:00:05.203262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.204029 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.205704 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:05.207076 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.208992 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:00:05.210963 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:00:05.213991 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:00:05.216235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:05.217578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:00:05.218698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:05.220586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:05.223857 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:05.228079 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.230201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:05.230755 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:00:05.231892 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m16:00:05.232578 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:05.233104 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:05.234894 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:05.236250 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:05.237537 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.242623 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:00:05.244132 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.245475 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.247877 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:00:05.248504 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:05.252520 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:05.255107 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.14s]
[0m16:00:05.257384 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:00:05.258283 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m16:00:05.259996 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:00:05.261587 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:05.262821 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:00:05.264645 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:00:05.266634 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:00:05.267980 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.270027 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.16s]
[0m16:00:05.271180 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:00:05.272440 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.16s]
[0m16:00:05.273382 [info ] [Thread-4 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:00:05.275113 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:05.276780 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.17s]
[0m16:00:05.278592 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:05.280131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:00:05.281703 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.283384 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:05.285462 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.286560 [info ] [Thread-1 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:00:05.293493 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.294667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:00:05.297207 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.302450 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.308043 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.312455 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.313085 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.318328 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.327730 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.329537 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:00:05.330623 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.331340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:05.332832 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:00:05.335373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:05.339625 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:00:05.341118 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:05.341950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:05.343234 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.344869 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:05.347241 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:05.347855 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:05.351383 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:00:05.351999 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:05.353409 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:00:05.355700 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:00:05.357858 [info ] [Thread-4 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.08s]
[0m16:00:05.359102 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:00:05.360613 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:05.362814 [info ] [Thread-1 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.07s]
[0m16:00:05.365057 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:05.367709 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.368849 [debug] [MainThread]: On master: BEGIN
[0m16:00:05.369881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:05.375374 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:00:05.376636 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.378094 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:05.379620 [debug] [MainThread]: On master: COMMIT
[0m16:00:05.380999 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:05.382387 [debug] [MainThread]: On master: Close
[0m16:00:05.384012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:05.385372 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:00:05.386695 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:00:05.388228 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:00:05.389472 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:00:05.390616 [info ] [MainThread]: 
[0m16:00:05.392207 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:00:05.395361 [debug] [MainThread]: Command end result
[0m16:00:05.438618 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:05.447390 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:05.460730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:05.462501 [info ] [MainThread]: 
[0m16:00:05.464805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:05.466365 [info ] [MainThread]: 
[0m16:00:05.467957 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:05.470199 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7560347, "process_in_blocks": "103984", "process_kernel_time": 0.63051, "process_mem_max_rss": "127076", "process_out_blocks": "0", "process_user_time": 3.1427}
[0m16:00:05.472163 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:05.471788 after 1.76 seconds
[0m16:00:05.473519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59bc43850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59bba32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597511e90>]}
[0m16:00:05.474853 [debug] [MainThread]: Flushing usage events
[0m16:00:06.826631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:09.862040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4ef8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4f4fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4ef8f90>]}


============================== 16:00:09.870022 | 81b2eb40-edff-486c-bbb7-d4b0b8101e81 ==============================
[0m16:00:09.870022 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:09.872188 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'debug': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '.', 'static_parser': 'True'}
[0m16:00:09.870686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e4f6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e55ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e4f72d0>]}


============================== 16:00:09.878226 | 25592817-d08d-4f7f-9192-7dd1f984b9b4 ==============================
[0m16:00:09.878226 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:09.880542 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m16:00:10.069230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd48cee10>]}
[0m16:00:10.090729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182df774d0>]}
[0m16:00:10.132015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd78f13d0>]}
[0m16:00:10.134450 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:10.188820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1830efa1d0>]}
[0m16:00:10.191288 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:10.215327 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:10.303800 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:10.563950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:10.566695 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:10.568421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:10.639099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd3df0210>]}
[0m16:00:10.640642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:10.642098 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:10.643866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:10.707113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d3a3e50>]}
[0m16:00:10.767963 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:10.778406 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:10.827870 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:10.837010 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:10.905289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d7f3990>]}
[0m16:00:10.907952 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:10.910498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e42ffd0>]}
[0m16:00:10.929561 [info ] [MainThread]: 
[0m16:00:10.932009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:10.934029 [info ] [MainThread]: 
[0m16:00:10.936675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:11.435624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4954290>]}
[0m16:00:11.438373 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:11.440651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd41de3d0>]}
[0m16:00:11.445151 [info ] [MainThread]: 
[0m16:00:11.449137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:11.451521 [info ] [MainThread]: 
[0m16:00:11.454286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:11.462643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:00:11.463973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:00:11.465336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:00:11.520431 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.521193 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.522196 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.523581 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:11.525490 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:11.527141 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:11.528831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.530556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.532161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.561834 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m16:00:11.562612 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:00:11.564163 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.565896 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m16:00:11.566962 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.568779 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:11.570713 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.572598 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:11.575590 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:11.578990 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:00:11.582543 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:11.584176 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:00:11.584816 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:00:11.586418 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:11.589183 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:11.591967 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:11.595552 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:11.597135 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:11.605999 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.609219 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.611937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:10.943863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:00:11.628650 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:00:11.631602 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.611676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:00:11.633676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:11.644620 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m16:00:11.613891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:00:11.648861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b2eb40-edff-486c-bbb7-d4b0b8101e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4f20250>]}
[0m16:00:11.651315 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:11.653898 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.655931 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.658819 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:00:11.661008 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.663109 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.665161 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.667322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:11.669569 [debug] [MainThread]: On master: Close
[0m16:00:11.678047 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:00:11.678864 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:00:11.679970 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:00:11.681883 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:00:11.684339 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:00:11.686914 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.686500 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:00:11.687814 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.688591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.688941 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.690921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.695026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.689800 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.691579 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:00:11.695790 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:00:11.698681 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:00:11.702006 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:00:11.705134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:00:11.714322 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.023 seconds
[0m16:00:11.707838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:00:11.710126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:00:11.715019 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.020 seconds
[0m16:00:11.712257 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:00:11.714837 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.715749 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.027 seconds
[0m16:00:11.717972 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:00:11.723847 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:00:11.726756 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:00:11.733297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:00:11.717011 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.734793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:00:11.735809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:00:11.719130 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.746699 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.751200 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.757540 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.759457 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:11.721077 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.761513 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:11.763219 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:11.764914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:11.766637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:11.747384 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.768646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:11.756044 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.763626 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.770960 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.777529 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:00:11.779841 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:11.782806 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.783925 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:00:11.785944 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:11.787458 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:00:11.789158 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:11.792416 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:11.794682 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:11.796560 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:00:11.797263 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:11.802046 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:11.803851 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:00:11.784829 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.806272 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:11.809415 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:11.811641 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:00:11.791074 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.815729 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:11.818802 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:11.824124 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:11.811781 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.816164 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.817092 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.825768 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.834677 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.839892 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.844962 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.848320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:11.847528 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.849706 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.852050 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.853259 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:00:11.857839 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:00:11.866046 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:00:11.859106 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.868274 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.860906 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:00:11.869936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:11.863352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:11.866107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:11.868435 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:00:11.870092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:11.874728 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:11.880158 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:11.882933 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m16:00:11.882015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m16:00:11.882859 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:11.886171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182a73bad0>]}
[0m16:00:11.884070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:11.888212 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:11.890114 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.885427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:00:11.891921 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.886227 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:11.894238 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:00:11.888022 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.890023 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:11.895932 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.897501 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.892310 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:11.898967 [debug] [MainThread]: On master: COMMIT
[0m16:00:11.894468 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.900618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:11.897301 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.901872 [debug] [MainThread]: On master: Close
[0m16:00:11.898215 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:11.899665 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:00:11.902391 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:11.911239 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:00:11.903088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:11.912070 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:00:11.914033 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:00:11.909517 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:00:11.913373 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:00:11.915749 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:00:11.914143 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:11.917775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m16:00:11.919781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m16:00:11.916722 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:00:11.918316 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:00:11.921753 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:00:11.919952 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:00:11.922467 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:00:11.924298 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:00:11.927135 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.22s]
[0m16:00:11.928726 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.22s]
[0m16:00:11.924035 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:00:11.930100 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:00:11.931550 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.23s]
[0m16:00:11.933975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:00:11.938507 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:11.933343 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:11.935685 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:11.938085 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.23s]
[0m16:00:11.940085 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:11.942347 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:11.947532 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:00:11.943919 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:11.945631 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:11.948556 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:00:11.950938 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:00:11.954272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:00:11.956587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:00:11.958643 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:11.955149 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:00:11.960510 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:11.967121 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:11.975985 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:11.987222 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:11.993402 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:11.994615 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:12.001532 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:12.007608 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:12.008418 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:12.009834 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:00:12.011740 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:00:12.013354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:12.015282 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.014862 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:12.015814 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.020738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.021911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.023646 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.022920 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:12.025763 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:00:12.024756 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:12.026395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.026568 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:00:12.027985 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:12.027621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:12.028942 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:00:12.030746 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:12.031154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:12.031439 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:12.034796 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.036151 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.034606 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:00:12.037485 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:00:12.037045 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:00:12.037989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:00:12.038598 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:00:12.040158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.039704 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:00:12.041165 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.09s]
[0m16:00:12.042302 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:00:12.043166 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:00:12.043041 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.09s]
[0m16:00:12.044818 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:12.046599 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:12.050505 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.052087 [debug] [MainThread]: On master: BEGIN
[0m16:00:12.053062 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:00:12.053557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:12.052563 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.058122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.059982 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:00:12.059621 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:00:12.061506 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.063278 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.061076 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:00:12.064415 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.063766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.065846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:12.066975 [debug] [MainThread]: On master: Close
[0m16:00:12.068560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:12.065150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.070150 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:00:12.071521 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:00:12.072932 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:00:12.069033 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.074640 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:00:12.074153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.076202 [info ] [MainThread]: 
[0m16:00:12.076006 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:00:12.077797 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m16:00:12.077652 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:00:12.079766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.080614 [debug] [MainThread]: Command end result
[0m16:00:12.081164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.099613 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:00:12.102237 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:00:12.103728 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.105415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.107745 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:00:12.110228 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:00:12.113345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.114029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.122367 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:00:12.129221 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:12.125974 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:00:12.133658 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:00:12.135679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:00:12.137454 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:12.137499 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:00:12.139372 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:00:12.144278 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:00:12.145616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:00:12.149033 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:00:12.152812 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:12.155169 [info ] [MainThread]: 
[0m16:00:12.152580 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:00:12.158007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:12.158214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d36b0d0>]}
[0m16:00:12.160136 [info ] [MainThread]: 
[0m16:00:12.162528 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:12.159871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d777750>]}
[0m16:00:12.162873 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.24s]
[0m16:00:12.165595 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.24s]
[0m16:00:12.167798 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.397024, "process_in_blocks": "84968", "process_kernel_time": 0.401566, "process_mem_max_rss": "131120", "process_out_blocks": "0", "process_user_time": 3.542026}
[0m16:00:12.168155 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:00:12.170133 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:12.169621 after 2.40 seconds
[0m16:00:12.169768 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:00:12.171644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd510d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd96477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd95d1c50>]}
[0m16:00:12.172913 [debug] [MainThread]: Flushing usage events
[0m16:00:12.172777 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:00:12.174522 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:00:12.176164 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:00:12.177588 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:00:12.190207 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.201931 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:00:12.244404 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.246747 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp160012228144"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:00:12.248621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:12.263975 [debug] [Thread-4 (]: SQL status: SELECT 219 in 0.015 seconds
[0m16:00:12.282160 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.283645 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:00:12.285447 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:00:12.286813 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.288145 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp160012228144'
        
      order by ordinal_position

  
[0m16:00:12.298199 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.009 seconds
[0m16:00:12.304643 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.306039 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:00:12.310459 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:00:12.321352 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.323179 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:00:12.327940 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:00:12.355560 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.366997 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.368415 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp160012228144" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:00:12.372122 [debug] [Thread-4 (]: SQL status: MERGE 219 in 0.002 seconds
[0m16:00:12.375130 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:00:12.376620 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:00:12.378067 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:00:12.380830 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.382668 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:00:12.384241 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18286b5dd0>]}
[0m16:00:12.385897 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 219[0m in 0.21s]
[0m16:00:12.387664 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:00:12.390011 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:00:12.391970 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:00:12.393555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:00:12.394974 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:00:12.398880 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.408069 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:00:12.420707 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.430711 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.432695 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:00:12.434713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:12.440713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:00:12.442221 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.443406 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:00:12.452200 [debug] [Thread-2 (]: SQL status: SELECT 48 in 0.007 seconds
[0m16:00:12.459586 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.461244 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:00:12.463206 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:12.467655 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.469751 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:00:12.471538 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:12.474293 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:00:12.475650 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.477264 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:00:12.480308 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:12.484303 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:00:12.488641 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:00:12.490385 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:00:12.494338 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:00:12.496885 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:00:12.498272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25592817-d08d-4f7f-9192-7dd1f984b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18286c2b10>]}
[0m16:00:12.499886 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 48[0m in 0.10s]
[0m16:00:12.501380 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:00:12.504086 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.505175 [debug] [MainThread]: On master: BEGIN
[0m16:00:12.506081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:12.511057 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:00:12.512786 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.514287 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.515616 [debug] [MainThread]: On master: COMMIT
[0m16:00:12.517400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:12.519186 [debug] [MainThread]: On master: Close
[0m16:00:12.520750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:12.522381 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m16:00:12.523844 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:00:12.524886 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:00:12.525734 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:00:12.527188 [info ] [MainThread]: 
[0m16:00:12.528586 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m16:00:12.531174 [debug] [MainThread]: Command end result
[0m16:00:12.573637 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:12.583658 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:12.599264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:12.601687 [info ] [MainThread]: 
[0m16:00:12.604131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:12.605779 [info ] [MainThread]: 
[0m16:00:12.608115 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:00:12.611822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8360689, "process_in_blocks": "89664", "process_kernel_time": 0.617757, "process_mem_max_rss": "125632", "process_out_blocks": "0", "process_user_time": 3.586977}
[0m16:00:12.614521 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:12.614022 after 2.84 seconds
[0m16:00:12.616203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182e7dfd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1832c5b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1832bbb210>]}
[0m16:00:12.618333 [debug] [MainThread]: Flushing usage events
[0m16:00:13.619930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:14.151574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:25.413806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41ffcbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420182090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41ffcbb90>]}


============================== 16:00:25.433095 | 8b03ce27-86cd-4834-be35-b22b02d02102 ==============================
[0m16:00:25.433095 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:00:25.436505 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'log_path': '/opt/airflow/dbt_crypto/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True'}
[0m16:00:25.682039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41ffcea50>]}
[0m16:00:25.750920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42289d2d0>]}
[0m16:00:25.754166 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:25.918691 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:00:26.224157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:26.227252 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:00:26.229281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:26.285976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41e7f86d0>]}
[0m16:00:26.405839 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:26.431192 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:26.913470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41f3330d0>]}
[0m16:00:26.916647 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:00:26.918460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421c7a490>]}
[0m16:00:26.922789 [info ] [MainThread]: 
[0m16:00:26.926050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:26.928232 [info ] [MainThread]: 
[0m16:00:26.932211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:26.938977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:00:26.940193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:00:26.941314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:00:27.005344 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:27.006127 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:27.006972 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:27.008621 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:00:27.010715 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:00:27.012544 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:00:27.014282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:27.015731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:27.017864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:27.064934 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:00:27.066376 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:00:27.067492 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:00:27.068279 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:00:27.069695 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:00:27.071683 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:00:27.073077 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:00:27.074652 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:00:27.077747 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:00:27.081484 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:00:27.084518 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:00:27.085233 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:00:27.085872 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:00:27.086779 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:00:27.088715 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:00:27.091603 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:00:27.096756 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:00:27.098309 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:00:27.106833 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.108820 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.110767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:27.117800 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:00:27.119297 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.120505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:27.132740 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m16:00:27.135450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b03ce27-86cd-4834-be35-b22b02d02102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41dfb8b50>]}
[0m16:00:27.137124 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:27.138836 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.140504 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.142633 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:00:27.144492 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.146187 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.147634 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.149166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:27.150363 [debug] [MainThread]: On master: Close
[0m16:00:27.157001 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.157592 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.158117 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.158582 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.159531 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:00:27.161077 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:00:27.162606 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:00:27.164033 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:00:27.165834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:00:27.168084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:00:27.169418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:00:27.170783 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:00:27.173175 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.175371 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.177176 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.179218 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.197895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.202530 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.208546 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.214476 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.222871 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.224408 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.230891 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.231585 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.245693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.249038 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.254529 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.258821 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.267398 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.268977 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.270796 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.271601 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:00:27.272181 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.273347 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:00:27.275252 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:00:27.276756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:27.278473 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:00:27.280070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:27.281853 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:27.284654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:27.288878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:00:27.291599 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:00:27.293326 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.293886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:27.295366 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m16:00:27.296421 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:27.297027 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:00:27.298885 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:00:27.300455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:00:27.305817 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:00:27.307691 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.309354 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.311221 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:00:27.313273 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:00:27.316883 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:00:27.317852 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.318669 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:27.321731 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.15s]
[0m16:00:27.324814 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:00:27.329011 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:00:27.329726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:27.331462 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:00:27.333205 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:00:27.334383 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:00:27.336452 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:00:27.337731 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.339287 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.17s]
[0m16:00:27.340839 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.17s]
[0m16:00:27.342286 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:00:27.343454 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:00:27.345421 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:00:27.347738 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:00:27.349693 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.18s]
[0m16:00:27.350952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:00:27.352415 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.354865 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:00:27.356217 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.357672 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:00:27.364371 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.366533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:00:27.369059 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.374231 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.381291 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.385400 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.385945 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.390314 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.396292 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.398069 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:00:27.398722 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.400063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:27.401671 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:00:27.404235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:27.408069 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:00:27.409654 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:00:27.411037 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.412558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m16:00:27.413585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:00:27.414363 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:00:27.416790 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:00:27.418075 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:00:27.419702 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:00:27.422564 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.07s]
[0m16:00:27.423773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:00:27.425238 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:00:27.427684 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:00:27.430210 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:00:27.431877 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.07s]
[0m16:00:27.433293 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:00:27.435996 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.437334 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.438989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:27.445485 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:00:27.446996 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.448405 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.449680 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.451337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:27.452885 [debug] [MainThread]: On master: Close
[0m16:00:27.455022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:27.456759 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:00:27.458464 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:00:27.460002 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:00:27.461460 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:00:27.462992 [info ] [MainThread]: 
[0m16:00:27.464807 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:00:27.467497 [debug] [MainThread]: Command end result
[0m16:00:27.512352 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:00:27.520245 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:00:27.532680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:00:27.534290 [info ] [MainThread]: 
[0m16:00:27.536568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:27.538239 [info ] [MainThread]: 
[0m16:00:27.540021 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:27.543957 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.256362, "process_in_blocks": "97304", "process_kernel_time": 0.498768, "process_mem_max_rss": "126296", "process_out_blocks": "0", "process_user_time": 3.200431}
[0m16:00:27.545547 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:27.545247 after 2.26 seconds
[0m16:00:27.546791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420182010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420181ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42455db50>]}
[0m16:00:27.548172 [debug] [MainThread]: Flushing usage events
[0m16:00:29.238447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:05.571253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec00b90150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec021b5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec00b90210>]}


============================== 16:05:05.612170 | a6d64b88-54b2-4ed7-b309-061711678111 ==============================
[0m16:05:05.612170 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:05:05.613463 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:05:05.859347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0175f510>]}
[0m16:05:05.918135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfff32650>]}
[0m16:05:05.921371 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:05:05.981816 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:05:06.277032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:06.278497 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:05:06.279971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:06.328232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfffdda90>]}
[0m16:05:06.436013 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:05:06.443517 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:05:06.477751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febff364450>]}
[0m16:05:06.480138 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:05:06.481943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febff7c4c50>]}
[0m16:05:06.484716 [info ] [MainThread]: 
[0m16:05:06.486441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:06.488343 [info ] [MainThread]: 
[0m16:05:06.490427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:06.496445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:05:06.549852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:05:06.550707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:05:06.594247 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:05:06.594766 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:05:06.595213 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:05:06.596389 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:05:06.597745 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:05:06.598787 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:05:06.600003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:06.601036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:06.602454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:06.610938 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.010 seconds
[0m16:05:06.611605 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m16:05:06.613411 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:05:06.615053 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.015 seconds
[0m16:05:06.616284 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:05:06.619523 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:05:06.623652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:05:06.624263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:05:06.624860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:05:06.630667 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:05:06.633968 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:05:06.637204 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:05:06.638764 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:05:06.639874 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:05:06.640915 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:05:06.642293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:06.643846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:06.644868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:06.650602 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:05:06.651976 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:05:06.652822 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:05:06.653758 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:05:06.654199 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:05:06.655662 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:05:06.657270 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:05:06.659777 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:05:06.661638 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:05:06.662890 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:05:06.667391 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:05:06.668556 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:05:06.669873 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:05:06.672478 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:05:06.673967 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:05:06.676770 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:05:06.678578 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:05:06.681530 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:05:06.687977 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:06.689859 [debug] [MainThread]: On master: BEGIN
[0m16:05:06.691617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:06.697697 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:05:06.699332 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:06.701075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:06.706584 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m16:05:06.708963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febff779f50>]}
[0m16:05:06.711050 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:06.713058 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:06.714519 [debug] [MainThread]: On master: BEGIN
[0m16:05:06.716501 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:05:06.717754 [debug] [MainThread]: On master: COMMIT
[0m16:05:06.719344 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:06.720901 [debug] [MainThread]: On master: COMMIT
[0m16:05:06.722969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:06.725100 [debug] [MainThread]: On master: Close
[0m16:05:06.733945 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:05:06.734489 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:05:06.735605 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:05:06.737655 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:05:06.739356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m16:05:06.741293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m16:05:06.743291 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:05:06.745027 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:05:06.752912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.756383 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.764940 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:05:06.772641 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:05:06.807206 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.807802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.818179 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.819046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.820663 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:05:06.822496 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:05:06.824183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:06.825854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:06.831369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:05:06.832733 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.833520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m16:05:06.834169 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:05:06.835900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.837829 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:05:06.840698 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:05:06.841401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:05:06.847639 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.851257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.853163 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:05:06.854658 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:05:06.856486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:05:06.858197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:05:06.861367 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.864948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.866119 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:05:06.867348 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:05:06.869529 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:05:06.870008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:05:06.884999 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:05:06.887459 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:05:06.888770 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.891442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.892455 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:05:06.893770 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:05:06.898289 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m16:05:06.899035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:05:06.905004 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:05:06.907953 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:05:06.913857 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:05:06.916244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:05:06.918317 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:05:06.920326 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:05:06.925939 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:05:06.926923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:05:06.929693 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:05:06.932325 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:05:06.935939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfc408b50>]}
[0m16:05:06.936612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfc40e810>]}
[0m16:05:06.938103 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.19s]
[0m16:05:06.939840 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.20s]
[0m16:05:06.941241 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:05:06.942481 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:05:06.945370 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:05:06.946600 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:05:06.948410 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:05:06.949347 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:05:06.957935 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:05:06.965658 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:05:07.000642 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.002990 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp160506987859"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:05:07.004602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:05:07.016184 [debug] [Thread-4 (]: SQL status: SELECT 234 in 0.012 seconds
[0m16:05:07.028812 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.030579 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:05:07.032450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:05:07.033809 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.035068 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp160506987859'
        
      order by ordinal_position

  
[0m16:05:07.043499 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.007 seconds
[0m16:05:07.049323 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.050853 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:05:07.055033 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:05:07.064708 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.066587 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:05:07.070792 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:05:07.092682 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.103606 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.105271 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp160506987859" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:05:07.112484 [debug] [Thread-4 (]: SQL status: MERGE 234 in 0.005 seconds
[0m16:05:07.115645 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:05:07.117343 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:05:07.118781 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:05:07.121328 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:05:07.123390 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:05:07.124783 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfcd60110>]}
[0m16:05:07.126790 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 234[0m in 0.18s]
[0m16:05:07.128309 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:05:07.130456 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:05:07.131845 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:05:07.133062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:05:07.134798 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:05:07.141099 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.154502 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:05:07.167532 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.182186 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.183347 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:05:07.184677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:07.189975 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m16:05:07.191394 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.192711 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:05:07.224540 [debug] [Thread-2 (]: SQL status: SELECT 51 in 0.030 seconds
[0m16:05:07.231838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.233880 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:05:07.235933 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:05:07.240000 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.241163 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:05:07.242610 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:05:07.245018 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:05:07.245940 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.246983 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:05:07.249294 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:05:07.252698 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:05:07.257069 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:05:07.259157 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:05:07.264875 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:05:07.267300 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:05:07.268799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d64b88-54b2-4ed7-b309-061711678111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec00c23b90>]}
[0m16:05:07.270479 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 51[0m in 0.14s]
[0m16:05:07.272068 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:05:07.274672 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:07.276076 [debug] [MainThread]: On master: BEGIN
[0m16:05:07.277621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:07.283360 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:05:07.284750 [debug] [MainThread]: On master: COMMIT
[0m16:05:07.285880 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:07.286945 [debug] [MainThread]: On master: COMMIT
[0m16:05:07.288331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:07.289669 [debug] [MainThread]: On master: Close
[0m16:05:07.291003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:07.292423 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m16:05:07.293824 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:05:07.294805 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:05:07.295707 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:05:07.296793 [info ] [MainThread]: 
[0m16:05:07.298142 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m16:05:07.299751 [debug] [MainThread]: Command end result
[0m16:05:07.336662 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:05:07.344789 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:05:07.355888 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:05:07.357523 [info ] [MainThread]: 
[0m16:05:07.358696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:07.359834 [info ] [MainThread]: 
[0m16:05:07.360892 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:05:07.362944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8710771, "process_in_blocks": "40056", "process_kernel_time": 0.236855, "process_mem_max_rss": "135532", "process_out_blocks": "0", "process_user_time": 2.713968}
[0m16:05:07.364299 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:07.364179 after 1.87 seconds
[0m16:05:07.365363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec05254610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec052432d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec05243150>]}
[0m16:05:07.366532 [debug] [MainThread]: Flushing usage events
[0m16:05:09.380113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:13.975407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308635cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3086356d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308635c290>]}


============================== 16:05:13.982852 | 2885f0b5-5f21-4b95-a4b1-37bdd641b130 ==============================
[0m16:05:13.982852 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:05:13.984428 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False'}
[0m16:05:14.185667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2885f0b5-5f21-4b95-a4b1-37bdd641b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30857d7710>]}
[0m16:05:14.242933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2885f0b5-5f21-4b95-a4b1-37bdd641b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3088d4e290>]}
[0m16:05:14.263010 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:05:14.333861 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:05:14.631910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:14.633952 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:05:14.635128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:14.677940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2885f0b5-5f21-4b95-a4b1-37bdd641b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3084b64e10>]}
[0m16:05:14.786943 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:05:14.793548 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:05:14.881701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2885f0b5-5f21-4b95-a4b1-37bdd641b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3087ee4dd0>]}
[0m16:05:14.883199 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:05:14.885196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2885f0b5-5f21-4b95-a4b1-37bdd641b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3086357750>]}
[0m16:05:14.888691 [info ] [MainThread]: 
[0m16:05:14.890303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:14.891727 [info ] [MainThread]: 
[0m16:05:14.893544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:14.900254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:05:14.901451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:05:14.902377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:05:14.939198 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:05:14.939732 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:05:14.940133 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:05:14.941316 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:05:14.942734 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:05:14.943832 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:05:14.944862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:14.946320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:14.947365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:14.953745 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:05:14.954317 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:05:14.955392 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:05:14.956464 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:05:14.957543 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:05:14.958689 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:05:14.960136 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:05:14.961208 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:05:14.963578 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:05:14.965816 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:05:14.967912 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:05:14.968425 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:05:14.969496 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m16:05:14.970177 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:05:14.972108 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:05:14.974559 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:05:14.977619 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:05:14.978918 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:05:14.985768 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:14.987996 [debug] [MainThread]: On master: BEGIN
[0m16:05:14.989329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:14.995186 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:05:14.996836 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:14.998407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:15.004318 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m16:05:15.006644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2885f0b5-5f21-4b95-a4b1-37bdd641b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3085773750>]}
[0m16:05:15.008298 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:15.010295 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:15.011816 [debug] [MainThread]: On master: BEGIN
[0m16:05:15.013320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:05:15.014787 [debug] [MainThread]: On master: COMMIT
[0m16:05:15.016151 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:15.017665 [debug] [MainThread]: On master: COMMIT
[0m16:05:15.019031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:15.020274 [debug] [MainThread]: On master: Close
[0m16:05:15.026677 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:05:15.027282 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:05:15.027744 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:05:15.028368 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:05:15.029245 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:05:15.031121 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:05:15.032883 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:05:15.034695 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:05:15.036411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:05:15.038059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:05:15.039866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:05:15.041746 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:05:15.043829 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:05:15.045785 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:05:15.047401 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:05:15.049276 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:05:15.065209 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:05:15.069799 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:05:15.077397 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:05:15.081964 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:05:15.091982 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:05:15.093190 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:05:15.099513 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:05:15.100024 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:05:15.113939 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:05:15.116556 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:05:15.121640 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:05:15.125744 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:05:15.133308 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:05:15.134482 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:05:15.135422 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:05:15.136041 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:05:15.137189 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:05:15.137667 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:05:15.139523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:05:15.140716 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:05:15.142633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:15.144021 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:05:15.146958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:15.149720 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:05:15.150215 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:05:15.152948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:05:15.154067 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:05:15.155765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:05:15.156237 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:05:15.156621 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m16:05:15.157595 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:05:15.159293 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:05:15.161123 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:05:15.162593 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:05:15.164838 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:05:15.165330 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:15.167093 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:15.168355 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:05:15.170350 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:15.174007 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:05:15.176480 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:05:15.179299 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:05:15.179761 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:05:15.180770 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:05:15.181673 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:05:15.182640 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:05:15.184167 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:05:15.185566 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.15s]
[0m16:05:15.186868 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.15s]
[0m16:05:15.188015 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.15s]
[0m16:05:15.189094 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:05:15.190508 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:05:15.192032 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:05:15.193630 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:05:15.194908 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.15s]
[0m16:05:15.195879 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:05:15.197017 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:05:15.199288 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:05:15.200627 [info ] [Thread-3 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:05:15.202181 [info ] [Thread-1 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:05:15.204918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:05:15.206353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:05:15.207625 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:05:15.208924 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:05:15.213772 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:05:15.218728 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:05:15.225487 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:05:15.225972 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:05:15.229102 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:05:15.232556 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:05:15.239522 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:05:15.240490 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:05:15.241317 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:05:15.242569 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:05:15.243638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:15.245231 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:05:15.250630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:05:15.251609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m16:05:15.252421 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:05:15.254007 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:05:15.255257 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:05:15.256496 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:05:15.258456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:15.259082 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:15.260531 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:05:15.262690 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:05:15.263840 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:05:15.265016 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:05:15.266228 [info ] [Thread-1 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.06s]
[0m16:05:15.267282 [info ] [Thread-3 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.06s]
[0m16:05:15.268123 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:05:15.269961 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:05:15.272951 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:15.274256 [debug] [MainThread]: On master: BEGIN
[0m16:05:15.275207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:15.280328 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:05:15.281778 [debug] [MainThread]: On master: COMMIT
[0m16:05:15.282933 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:15.283886 [debug] [MainThread]: On master: COMMIT
[0m16:05:15.285522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:15.286830 [debug] [MainThread]: On master: Close
[0m16:05:15.288027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:15.288963 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:05:15.290067 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:05:15.290984 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:05:15.291850 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:05:15.292780 [info ] [MainThread]: 
[0m16:05:15.294316 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m16:05:15.296557 [debug] [MainThread]: Command end result
[0m16:05:15.335739 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:05:15.342953 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:05:15.355241 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:05:15.356500 [info ] [MainThread]: 
[0m16:05:15.357949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:15.359312 [info ] [MainThread]: 
[0m16:05:15.360793 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:05:15.362219 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4623249, "process_in_blocks": "30304", "process_kernel_time": 0.339017, "process_mem_max_rss": "134132", "process_out_blocks": "0", "process_user_time": 2.29335}
[0m16:05:15.363888 [debug] [MainThread]: Command `dbt test` succeeded at 16:05:15.363775 after 1.46 seconds
[0m16:05:15.364907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30876b8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3086569a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308aaaf850>]}
[0m16:05:15.366287 [debug] [MainThread]: Flushing usage events
[0m16:05:16.825875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:03.998728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926d3ac390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926d403b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926d3aca10>]}


============================== 16:10:04.005584 | f3db1055-a9d0-4463-8a38-f653bccfbbf0 ==============================
[0m16:10:04.005584 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:10:04.007174 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'write_json': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '.'}
[0m16:10:04.202718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926d241790>]}
[0m16:10:04.262404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926d39a350>]}
[0m16:10:04.264395 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:10:04.323681 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:10:04.602221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:04.604083 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:10:04.605153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:04.650111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926bbcb290>]}
[0m16:10:04.763043 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:10:04.771954 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:10:04.802227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926bb10690>]}
[0m16:10:04.803608 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:10:04.804984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926bbc9950>]}
[0m16:10:04.807941 [info ] [MainThread]: 
[0m16:10:04.809372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:04.810458 [info ] [MainThread]: 
[0m16:10:04.811622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:04.818252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:10:04.873739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:10:04.874788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:10:04.916282 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:10:04.916823 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:10:04.917406 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:10:04.918539 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:10:04.919910 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:10:04.921141 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:10:04.922223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:04.923345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:04.924584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:04.931581 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m16:10:04.932062 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.010 seconds
[0m16:10:04.932490 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m16:10:04.934519 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:10:04.936379 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:10:04.938942 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:10:04.943517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:10:04.944232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:10:04.944885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:10:04.952157 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:10:04.956190 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:10:04.962370 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:10:04.964725 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:10:04.966980 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:10:04.969178 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:10:04.971148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:04.973161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:04.977196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:04.987954 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:10:04.989412 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:10:04.990589 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:10:04.992528 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:10:04.993567 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:10:04.994491 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:10:04.996673 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:10:04.998890 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:10:05.004066 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:10:05.007889 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:10:05.011275 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:10:05.012040 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:10:05.012584 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:10:05.014292 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:10:05.016912 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:10:05.019605 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:10:05.023754 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:10:05.025581 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:10:05.033493 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:05.035294 [debug] [MainThread]: On master: BEGIN
[0m16:10:05.036902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:05.042575 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:10:05.044508 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:05.046468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:05.052595 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m16:10:05.055293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9269553b90>]}
[0m16:10:05.057641 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:05.059155 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:05.060339 [debug] [MainThread]: On master: BEGIN
[0m16:10:05.062075 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:10:05.063294 [debug] [MainThread]: On master: COMMIT
[0m16:10:05.064875 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:05.066335 [debug] [MainThread]: On master: COMMIT
[0m16:10:05.068245 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:05.070059 [debug] [MainThread]: On master: Close
[0m16:10:05.076574 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:10:05.077104 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:10:05.078981 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:10:05.080927 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:10:05.082720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_historical_klines)
[0m16:10:05.084260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_realtime_klines)
[0m16:10:05.085864 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:10:05.087633 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:10:05.096968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.102194 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.113971 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:10:05.115808 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:10:05.164312 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.165658 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.176913 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.178150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.179279 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:10:05.180523 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:10:05.182520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:05.184919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:05.191207 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:10:05.192137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:10:05.193119 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.194311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.195412 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:10:05.196758 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:10:05.201428 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:10:05.201911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:10:05.208491 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.212440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.214144 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:10:05.215414 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:10:05.218013 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:05.219069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:05.223062 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.226971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.228633 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:10:05.230664 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:10:05.233000 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:05.234055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:05.250896 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:10:05.253204 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:10:05.254716 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.256008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.257787 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:10:05.259563 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:10:05.264905 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m16:10:05.265670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:10:05.272330 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:10:05.275784 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:10:05.281502 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:10:05.283556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:10:05.285186 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:10:05.286783 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:10:05.290768 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:10:05.294457 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:10:05.294961 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:10:05.298123 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9269582350>]}
[0m16:10:05.300438 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:10:05.302372 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.21s]
[0m16:10:05.304286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92695fad50>]}
[0m16:10:05.305401 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:10:05.306768 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.22s]
[0m16:10:05.309707 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:10:05.311790 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:10:05.313305 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:10:05.315071 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:10:05.316383 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:10:05.325338 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.336153 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:10:05.372058 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.374683 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp161005358816"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:10:05.376661 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:05.388324 [debug] [Thread-4 (]: SQL status: SELECT 246 in 0.012 seconds
[0m16:10:05.402069 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.404645 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:10:05.406469 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:10:05.407798 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.409159 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp161005358816'
        
      order by ordinal_position

  
[0m16:10:05.418170 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.008 seconds
[0m16:10:05.424545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.425963 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:10:05.430557 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:10:05.440115 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.442489 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:10:05.447017 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:10:05.470384 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.480847 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.482109 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp161005358816" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:10:05.485763 [debug] [Thread-4 (]: SQL status: MERGE 246 in 0.002 seconds
[0m16:10:05.488365 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:10:05.490068 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:10:05.491915 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:10:05.493809 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:05.495529 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:10:05.497144 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926dfd19d0>]}
[0m16:10:05.498806 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 246[0m in 0.18s]
[0m16:10:05.500241 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:10:05.502455 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:10:05.504438 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:10:05.505671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:10:05.506660 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:10:05.510461 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.526418 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:10:05.539120 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.552029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.553641 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:10:05.555110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:05.561258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:10:05.562681 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.564203 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:10:05.574417 [debug] [Thread-2 (]: SQL status: SELECT 51 in 0.009 seconds
[0m16:10:05.582053 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.583958 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:10:05.586200 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:05.590192 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.591172 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:10:05.592846 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:05.595480 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:10:05.596706 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.598462 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:10:05.600734 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:05.603829 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:10:05.607017 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:10:05.609008 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:10:05.612957 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:10:05.615409 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:10:05.617380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1055-a9d0-4463-8a38-f653bccfbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92684d5c50>]}
[0m16:10:05.619320 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 51[0m in 0.11s]
[0m16:10:05.621283 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:10:05.624325 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:05.626402 [debug] [MainThread]: On master: BEGIN
[0m16:10:05.627615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:05.633257 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:10:05.634833 [debug] [MainThread]: On master: COMMIT
[0m16:10:05.635963 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:05.637390 [debug] [MainThread]: On master: COMMIT
[0m16:10:05.638787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:05.639835 [debug] [MainThread]: On master: Close
[0m16:10:05.641095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:05.642229 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m16:10:05.643474 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:10:05.644440 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:10:05.645806 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:10:05.647107 [info ] [MainThread]: 
[0m16:10:05.648542 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m16:10:05.650450 [debug] [MainThread]: Command end result
[0m16:10:05.692521 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:10:05.700660 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:10:05.712837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:10:05.714714 [info ] [MainThread]: 
[0m16:10:05.716691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:05.718595 [info ] [MainThread]: 
[0m16:10:05.720521 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:10:05.722605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.803195, "process_in_blocks": "48", "process_kernel_time": 0.311748, "process_mem_max_rss": "135368", "process_out_blocks": "0", "process_user_time": 3.097369}
[0m16:10:05.724729 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:05.724558 after 1.81 seconds
[0m16:10:05.726908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926d67fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9271a2f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92719bb310>]}
[0m16:10:05.728418 [debug] [MainThread]: Flushing usage events
[0m16:10:07.846575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:11.313563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542ddd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542ddc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542ddc590>]}


============================== 16:10:11.320045 | f88bf46e-61d1-4ea7-8b7e-0c1af45053a8 ==============================
[0m16:10:11.320045 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:10:11.321446 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir .', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'quiet': 'False'}
[0m16:10:11.513958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f88bf46e-61d1-4ea7-8b7e-0c1af45053a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5421bf450>]}
[0m16:10:11.571214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f88bf46e-61d1-4ea7-8b7e-0c1af45053a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541d7e950>]}
[0m16:10:11.573523 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:10:11.650747 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:10:11.911091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:11.912919 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:10:11.914593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:11.963082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f88bf46e-61d1-4ea7-8b7e-0c1af45053a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541598450>]}
[0m16:10:12.077736 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:10:12.084971 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:10:12.182497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f88bf46e-61d1-4ea7-8b7e-0c1af45053a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa544773650>]}
[0m16:10:12.184637 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:10:12.186597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88bf46e-61d1-4ea7-8b7e-0c1af45053a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541d75210>]}
[0m16:10:12.191092 [info ] [MainThread]: 
[0m16:10:12.192954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:12.194541 [info ] [MainThread]: 
[0m16:10:12.197412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:12.204431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:10:12.207435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:10:12.208798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:10:12.267838 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:10:12.268389 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:10:12.268918 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:10:12.270055 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:10:12.271192 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:10:12.272446 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:10:12.273720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:12.275258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:12.276841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:12.283895 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:10:12.285067 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:10:12.285678 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:10:12.286722 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:10:12.287934 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:10:12.289243 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:10:12.290728 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:10:12.292101 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:10:12.293444 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:10:12.298932 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:10:12.299845 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:10:12.301126 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:10:12.303169 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:10:12.306284 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:10:12.309350 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:10:12.310947 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:10:12.312108 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:10:12.313218 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:10:12.324360 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.326050 [debug] [MainThread]: On master: BEGIN
[0m16:10:12.327520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:12.333550 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:10:12.335359 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.336817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:12.343202 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:10:12.346060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88bf46e-61d1-4ea7-8b7e-0c1af45053a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa540d84c90>]}
[0m16:10:12.347716 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:12.353672 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.355903 [debug] [MainThread]: On master: BEGIN
[0m16:10:12.358298 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:10:12.359654 [debug] [MainThread]: On master: COMMIT
[0m16:10:12.361144 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.362356 [debug] [MainThread]: On master: COMMIT
[0m16:10:12.363946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:12.365630 [debug] [MainThread]: On master: Close
[0m16:10:12.371065 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:10:12.371631 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:10:12.372125 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:10:12.372623 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:10:12.373264 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:10:12.374418 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:10:12.375680 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:10:12.377118 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:10:12.378650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:10:12.380737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:10:12.382405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:10:12.384025 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:10:12.385590 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:10:12.386872 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:10:12.388463 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:10:12.390163 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:10:12.406771 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:10:12.411484 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:10:12.416841 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:10:12.421734 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:10:12.429114 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:10:12.430560 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:10:12.436244 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:10:12.447172 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:10:12.450705 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:10:12.451246 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:10:12.456456 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:10:12.461936 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:10:12.469365 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:10:12.470044 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:10:12.471296 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:10:12.471921 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:10:12.473046 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:10:12.473976 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:10:12.475248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:12.476857 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:10:12.478200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:12.479424 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:10:12.481878 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:12.484070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:12.485282 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:10:12.488179 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:10:12.489015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:10:12.490653 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:10:12.491267 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:10:12.492131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m16:10:12.492793 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:10:12.495548 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:10:12.496036 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:10:12.497198 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:10:12.498480 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:10:12.499637 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:10:12.504161 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:10:12.505438 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:10:12.509903 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:10:12.510407 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:10:12.510893 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:10:12.512216 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:10:12.513785 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:10:12.515433 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.13s]
[0m16:10:12.517232 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:10:12.519117 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:10:12.520494 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:10:12.521782 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:10:12.523445 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:10:12.524652 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:10:12.526333 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.14s]
[0m16:10:12.528174 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:10:12.529935 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.15s]
[0m16:10:12.531214 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.15s]
[0m16:10:12.532416 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:10:12.533904 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:10:12.535158 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:10:12.536922 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:10:12.538507 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:10:12.540272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:10:12.544063 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:10:12.545292 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:10:12.546694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:10:12.551853 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:10:12.553987 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:10:12.561011 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:10:12.567178 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:10:12.570860 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:10:12.571485 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:10:12.575937 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:10:12.583278 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:10:12.584206 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:10:12.585480 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:10:12.587485 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:10:12.588993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:12.590323 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:12.596634 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:10:12.598347 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:10:12.599790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:10:12.600667 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:10:12.602180 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:10:12.604522 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:10:12.604978 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:10:12.608302 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:10:12.608882 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:10:12.609898 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:10:12.611547 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:10:12.613544 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.07s]
[0m16:10:12.614938 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:10:12.616084 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:10:12.617498 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.07s]
[0m16:10:12.619895 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:10:12.622401 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.623578 [debug] [MainThread]: On master: BEGIN
[0m16:10:12.624641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:12.629990 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:10:12.631564 [debug] [MainThread]: On master: COMMIT
[0m16:10:12.633042 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.634324 [debug] [MainThread]: On master: COMMIT
[0m16:10:12.635832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:12.636791 [debug] [MainThread]: On master: Close
[0m16:10:12.638107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:12.639465 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:10:12.640781 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:10:12.641991 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:10:12.643174 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:10:12.644421 [info ] [MainThread]: 
[0m16:10:12.646005 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:10:12.648104 [debug] [MainThread]: Command end result
[0m16:10:12.698463 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:10:12.705380 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:10:12.719526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:10:12.720856 [info ] [MainThread]: 
[0m16:10:12.722092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:12.723400 [info ] [MainThread]: 
[0m16:10:12.725062 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:10:12.727297 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4877318, "process_in_blocks": "1248", "process_kernel_time": 0.334742, "process_mem_max_rss": "132976", "process_out_blocks": "0", "process_user_time": 2.454781}
[0m16:10:12.728625 [debug] [MainThread]: Command `dbt test` succeeded at 16:10:12.728521 after 1.49 seconds
[0m16:10:12.730541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542fe9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54743f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5473b4510>]}
[0m16:10:12.732497 [debug] [MainThread]: Flushing usage events
[0m16:10:14.331300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:04.372135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006fda0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006fd9af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006fd9b950>]}


============================== 16:15:04.378938 | e9ce618f-5738-442c-b3fe-50bbb155f33f ==============================
[0m16:15:04.378938 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:15:04.380749 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error': 'None', 'profiles_dir': '.', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt_crypto/logs', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'empty': 'False', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m16:15:04.586422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f167990>]}
[0m16:15:04.642221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00726b5090>]}
[0m16:15:04.645300 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:15:04.726838 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:15:04.968455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:04.970796 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:15:04.972482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:05.018845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006fd8e510>]}
[0m16:15:05.119855 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:15:05.129117 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:15:05.159713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006e5951d0>]}
[0m16:15:05.161541 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:15:05.163414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006e5f3f50>]}
[0m16:15:05.166443 [info ] [MainThread]: 
[0m16:15:05.168036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:05.169359 [info ] [MainThread]: 
[0m16:15:05.171496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:05.177362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:15:05.251219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:15:05.252756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:15:05.294539 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:15:05.295385 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:15:05.296224 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:15:05.297988 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:15:05.300358 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:15:05.301915 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:15:05.303439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:05.305115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:05.306923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:05.316247 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m16:15:05.316839 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.012 seconds
[0m16:15:05.319179 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:15:05.319892 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m16:15:05.322547 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:15:05.328215 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:15:05.334502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:15:05.335558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:15:05.336526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:15:05.343868 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:15:05.347136 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:15:05.351003 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:15:05.352889 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:15:05.354960 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:15:05.356449 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:15:05.357693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:05.359045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:05.360694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:05.366599 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:15:05.368354 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:15:05.368820 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:15:05.370106 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:15:05.371709 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:15:05.373174 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:15:05.378584 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:05.380173 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:15:05.382158 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:15:05.383425 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:15:05.383996 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:05.385327 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:15:05.386534 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:15:05.389701 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:15:05.394136 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:15:05.397516 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m16:15:05.401088 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:15:05.403417 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:15:05.410336 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:05.412043 [debug] [MainThread]: On master: BEGIN
[0m16:15:05.415415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:05.424357 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:15:05.426026 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:05.428411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:05.434884 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:15:05.438011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0071bd6250>]}
[0m16:15:05.439969 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:05.442673 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:05.444169 [debug] [MainThread]: On master: BEGIN
[0m16:15:05.446361 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:15:05.448115 [debug] [MainThread]: On master: COMMIT
[0m16:15:05.449534 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:05.450610 [debug] [MainThread]: On master: COMMIT
[0m16:15:05.451859 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:05.453088 [debug] [MainThread]: On master: Close
[0m16:15:05.460153 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:15:05.461699 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:15:05.463824 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:15:05.466070 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:15:05.467398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_historical_klines)
[0m16:15:05.468882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_realtime_klines)
[0m16:15:05.470339 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:15:05.471566 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:15:05.479769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.483928 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.493868 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:15:05.494752 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:15:05.544725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.545992 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.553332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.555167 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:15:05.555715 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.556952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:05.558384 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:15:05.561152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:05.564681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m16:15:05.566117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.567643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:15:05.568206 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:15:05.569559 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.571790 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:15:05.574246 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:15:05.575563 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:15:05.582172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.586367 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.587902 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:15:05.589226 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:15:05.591277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:05.591795 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:05.595367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.600194 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.602465 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:15:05.604078 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:15:05.606089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:05.607274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:05.625463 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:15:05.627429 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:15:05.629818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.631290 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.632601 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:15:05.633924 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:15:05.645143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:15:05.645693 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m16:15:05.653041 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:15:05.656643 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:15:05.662917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:15:05.664973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:15:05.666647 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:15:05.667966 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:15:05.672467 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:15:05.673666 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:15:05.676534 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:15:05.679042 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:15:05.682099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006c179510>]}
[0m16:15:05.682825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005fd76390>]}
[0m16:15:05.683970 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.21s]
[0m16:15:05.685504 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.21s]
[0m16:15:05.686920 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:15:05.688762 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:15:05.691428 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:15:05.692769 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:15:05.694130 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:15:05.695360 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:15:05.705270 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.717836 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:15:05.753887 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.756280 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp161505740975"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:15:05.757894 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:15:05.801747 [debug] [Thread-4 (]: SQL status: SELECT 264 in 0.044 seconds
[0m16:15:05.814390 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.816718 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:15:05.818370 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:15:05.819694 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.821327 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp161505740975'
        
      order by ordinal_position

  
[0m16:15:05.830722 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.008 seconds
[0m16:15:05.837382 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.838839 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:15:05.842812 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:15:05.852610 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.853976 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:15:05.858292 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:15:05.881049 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.891970 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.893337 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp161505740975" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:15:05.897118 [debug] [Thread-4 (]: SQL status: MERGE 264 in 0.002 seconds
[0m16:15:05.899774 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:15:05.901152 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:15:05.902401 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:15:05.938169 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m16:15:05.939908 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:15:05.941708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005fde3650>]}
[0m16:15:05.943736 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 264[0m in 0.25s]
[0m16:15:05.945300 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:15:05.946987 [debug] [Thread-1 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:15:05.948201 [info ] [Thread-1 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:15:05.949557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_historical_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:15:05.950776 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:15:05.954973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:15:05.967762 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:15:05.980634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:15:05.995676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:15:05.997455 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:15:05.998801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:06.003977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:15:06.005456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:15:06.006745 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:15:06.016033 [debug] [Thread-1 (]: SQL status: SELECT 57 in 0.008 seconds
[0m16:15:06.023009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:15:06.024294 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:15:06.026217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:06.029755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:15:06.030882 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:15:06.032458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:06.034820 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:15:06.035840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:15:06.036792 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:15:06.038849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:15:06.042168 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:15:06.046590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:15:06.048222 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:15:06.052143 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:15:06.054542 [debug] [Thread-1 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:15:06.056242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ce618f-5738-442c-b3fe-50bbb155f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005fe629d0>]}
[0m16:15:06.058267 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 57[0m in 0.11s]
[0m16:15:06.060147 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:15:06.062709 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:06.063970 [debug] [MainThread]: On master: BEGIN
[0m16:15:06.064903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:06.070622 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:15:06.072690 [debug] [MainThread]: On master: COMMIT
[0m16:15:06.074315 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:06.075682 [debug] [MainThread]: On master: COMMIT
[0m16:15:06.077402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:06.078986 [debug] [MainThread]: On master: Close
[0m16:15:06.080910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:06.082630 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:15:06.084535 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_realtime_klines' was properly closed.
[0m16:15:06.086007 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m16:15:06.087770 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:15:06.088978 [info ] [MainThread]: 
[0m16:15:06.090215 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m16:15:06.091803 [debug] [MainThread]: Command end result
[0m16:15:06.130870 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:15:06.138512 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:15:06.152685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:15:06.154238 [info ] [MainThread]: 
[0m16:15:06.156296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:06.157777 [info ] [MainThread]: 
[0m16:15:06.159551 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:15:06.161371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8688223, "process_in_blocks": "24", "process_kernel_time": 0.33095, "process_mem_max_rss": "134068", "process_out_blocks": "0", "process_user_time": 3.018672}
[0m16:15:06.162735 [debug] [MainThread]: Command `dbt run` succeeded at 16:15:06.162636 after 1.87 seconds
[0m16:15:06.164287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006fdf7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006ffadb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0074403750>]}
[0m16:15:06.166018 [debug] [MainThread]: Flushing usage events
[0m16:15:08.964432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:13.973475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3ce18710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3d0258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3d025e90>]}


============================== 16:15:13.979544 | cc364e39-7707-43fb-adf1-916cab9c1ea0 ==============================
[0m16:15:13.979544 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:15:13.981167 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'empty': 'None', 'printer_width': '80', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'log_path': '/opt/airflow/dbt_crypto/logs'}
[0m16:15:14.182229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc364e39-7707-43fb-adf1-916cab9c1ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3e404050>]}
[0m16:15:14.243830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc364e39-7707-43fb-adf1-916cab9c1ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3f7420d0>]}
[0m16:15:14.246146 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:15:14.311239 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:15:14.559961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:14.561668 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:15:14.563285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:14.620048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc364e39-7707-43fb-adf1-916cab9c1ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3c5fbf90>]}
[0m16:15:14.732534 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:15:14.740503 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:15:14.824079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc364e39-7707-43fb-adf1-916cab9c1ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3c5f89d0>]}
[0m16:15:14.825622 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:15:14.827122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc364e39-7707-43fb-adf1-916cab9c1ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3c564fd0>]}
[0m16:15:14.829956 [info ] [MainThread]: 
[0m16:15:14.831725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:14.833018 [info ] [MainThread]: 
[0m16:15:14.834397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:14.839609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:15:14.840621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:15:14.841497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:15:14.877637 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:15:14.878220 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:15:14.878602 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:15:14.879845 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:15:14.881881 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:15:14.883587 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:15:14.885157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:14.886584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:14.887798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:14.894111 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:15:14.895008 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:15:14.896099 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:15:14.897777 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:15:14.899526 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:15:14.900839 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:15:14.901498 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:15:14.904010 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:15:14.906750 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:15:14.907485 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:15:14.909936 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:15:14.910326 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:14.913265 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:15:14.914842 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:15:14.915364 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:14.918124 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:15:14.920033 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:15:14.922326 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:15:14.928276 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:14.929828 [debug] [MainThread]: On master: BEGIN
[0m16:15:14.931343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:14.936727 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:15:14.937914 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:14.938963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:14.944952 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m16:15:14.947379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc364e39-7707-43fb-adf1-916cab9c1ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3e618d10>]}
[0m16:15:14.948593 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:14.949769 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:14.950901 [debug] [MainThread]: On master: BEGIN
[0m16:15:14.952684 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:15:14.954098 [debug] [MainThread]: On master: COMMIT
[0m16:15:14.955437 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:14.957247 [debug] [MainThread]: On master: COMMIT
[0m16:15:14.958840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:14.960686 [debug] [MainThread]: On master: Close
[0m16:15:14.965464 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:15:14.966032 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:15:14.966506 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:15:14.966990 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:15:14.967644 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:15:14.968859 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:15:14.970071 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:15:14.971437 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:15:14.972938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:15:14.974332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:15:14.975570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:15:14.976793 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:15:14.978025 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:15:14.979376 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:15:14.980325 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:15:14.982200 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:15:14.996693 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:15:15.000875 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:15:15.005927 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:15:15.011059 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:15:15.021535 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:15:15.022138 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:15:15.034700 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:15:15.039589 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:15:15.040205 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:15:15.045160 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:15:15.050350 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:15:15.056398 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:15:15.062687 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:15:15.064134 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:15:15.064592 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:15:15.065129 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:15:15.066289 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:15:15.066967 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:15:15.068406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:15.070106 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:15:15.071822 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:15:15.073122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:15.075122 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:15.076143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:15:15.078662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:15:15.081334 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:15:15.082483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:15:15.083100 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:15:15.084354 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:15:15.085546 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:15:15.085995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:15:15.086928 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:15:15.088153 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:15:15.089336 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:15:15.090251 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:15:15.092156 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:15.092666 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:15.093993 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:15.094638 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:15:15.098799 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:15:15.101663 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:15:15.103576 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:15:15.105639 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:15.106084 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:15:15.107211 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:15:15.108340 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:15:15.110163 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:15:15.111536 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.14s]
[0m16:15:15.112719 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.14s]
[0m16:15:15.114738 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.14s]
[0m16:15:15.115887 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:15:15.117261 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:15:15.118853 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:15:15.120357 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:15:15.122048 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.15s]
[0m16:15:15.123161 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:15:15.124339 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:15:15.126593 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:15:15.127684 [info ] [Thread-1 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:15:15.129284 [info ] [Thread-2 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:15:15.131367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:15:15.132511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:15:15.133652 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:15:15.134807 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:15:15.140025 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:15:15.145296 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:15:15.151698 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:15:15.155211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:15:15.155786 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:15:15.160694 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:15:15.168250 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:15:15.170536 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:15:15.171116 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:15:15.172056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:15.173495 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:15:15.176282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:15.179471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:15:15.180755 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:15:15.181378 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m16:15:15.182236 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:15:15.183685 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:15:15.185957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:15.186392 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:15:15.188852 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:15:15.191477 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:15.192056 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:15:15.193634 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:15:15.195362 [info ] [Thread-1 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.06s]
[0m16:15:15.196804 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:15:15.198144 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:15:15.199744 [info ] [Thread-2 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.07s]
[0m16:15:15.201853 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:15:15.205162 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:15.207200 [debug] [MainThread]: On master: BEGIN
[0m16:15:15.208685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:15.214310 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:15:15.215678 [debug] [MainThread]: On master: COMMIT
[0m16:15:15.216954 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:15.218404 [debug] [MainThread]: On master: COMMIT
[0m16:15:15.220046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:15.221478 [debug] [MainThread]: On master: Close
[0m16:15:15.222830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:15.224042 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:15:15.225162 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:15:15.226869 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:15:15.227971 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:15:15.229018 [info ] [MainThread]: 
[0m16:15:15.230393 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m16:15:15.232599 [debug] [MainThread]: Command end result
[0m16:15:15.275274 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:15:15.285893 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:15:15.300251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:15:15.302527 [info ] [MainThread]: 
[0m16:15:15.304956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:15.306854 [info ] [MainThread]: 
[0m16:15:15.308623 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:15:15.311457 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4177192, "process_in_blocks": "1232", "process_kernel_time": 0.271577, "process_mem_max_rss": "134060", "process_out_blocks": "0", "process_user_time": 2.916946}
[0m16:15:15.313728 [debug] [MainThread]: Command `dbt test` succeeded at 16:15:15.313564 after 1.42 seconds
[0m16:15:15.315808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf41353210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3d025ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf3d025fd0>]}
[0m16:15:15.317720 [debug] [MainThread]: Flushing usage events
[0m16:15:16.887140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:09.910809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2008a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd202a9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd20089e90>]}


============================== 16:20:09.936627 | 59d78d22-a848-4323-987f-facebf0ad238 ==============================
[0m16:20:09.936627 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:20:09.940056 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_crypto/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m16:20:10.372728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1f3322d0>]}
[0m16:20:10.448032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd22a5f3d0>]}
[0m16:20:10.450981 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:20:10.529714 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:20:11.192328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:11.195075 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:20:11.196817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:11.273489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1ebf7d10>]}
[0m16:20:11.516415 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:20:11.531049 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:20:11.605623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1f7abf10>]}
[0m16:20:11.608199 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:20:11.615552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1e71ff50>]}
[0m16:20:11.619971 [info ] [MainThread]: 
[0m16:20:11.622122 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:11.628522 [info ] [MainThread]: 
[0m16:20:11.630644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:11.643730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:20:11.813055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:20:11.818169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:20:11.985496 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:20:11.987794 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:20:11.989624 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:20:11.991417 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:20:11.995406 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:20:12.000253 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:20:12.003511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:12.010341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:12.012832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:12.034560 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.031 seconds
[0m16:20:12.035674 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.025 seconds
[0m16:20:12.038570 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.025 seconds
[0m16:20:12.042989 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:20:12.050232 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:20:12.053628 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:20:12.066908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:20:12.071058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:20:12.072878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:20:12.092855 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:20:12.098625 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:20:12.105702 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:20:12.112352 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:20:12.114581 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:20:12.118162 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:20:12.123777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:12.126046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:12.130132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:12.145952 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m16:20:12.147710 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m16:20:12.148885 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:20:12.153018 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m16:20:12.156308 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:20:12.158452 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:20:12.161542 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:20:12.168197 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:20:12.172450 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:20:12.185085 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m16:20:12.192439 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:20:12.194616 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m16:20:12.195542 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m16:20:12.197414 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:20:12.202484 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:20:12.207544 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:20:12.217018 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:20:12.218708 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:20:12.236440 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:12.238530 [debug] [MainThread]: On master: BEGIN
[0m16:20:12.240240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:12.268328 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m16:20:12.274299 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:12.277902 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:12.303468 [debug] [MainThread]: SQL status: SELECT 2 in 0.015 seconds
[0m16:20:12.311061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1ff45dd0>]}
[0m16:20:12.316423 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:12.320703 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:12.322699 [debug] [MainThread]: On master: BEGIN
[0m16:20:12.328691 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:12.330766 [debug] [MainThread]: On master: COMMIT
[0m16:20:12.334469 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:12.339900 [debug] [MainThread]: On master: COMMIT
[0m16:20:12.343094 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:20:12.349296 [debug] [MainThread]: On master: Close
[0m16:20:12.367249 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:20:12.369329 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:20:12.371074 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:20:12.373532 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:20:12.379438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m16:20:12.381947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_realtime_klines)
[0m16:20:12.385661 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:20:12.389482 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:20:12.407185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.414011 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.433185 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:20:12.436193 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:20:12.567082 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.578758 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.600083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.602784 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:20:12.604595 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.611031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:12.613794 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:20:12.621508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:12.630976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:20:12.635772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.637978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:20:12.639572 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:20:12.646720 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.650713 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:20:12.678195 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m16:20:12.679958 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m16:20:12.702989 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.713918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.716550 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:20:12.724658 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:20:12.730060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:20:12.732824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:20:12.745033 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.755265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.757146 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:20:12.759424 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:20:12.767408 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:12.769355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:12.845351 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:20:12.848708 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:20:12.851583 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.854388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.862032 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:20:12.864276 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:20:12.872691 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m16:20:12.873495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:12.895530 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:20:12.905420 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:20:12.923849 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:20:12.927805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:20:12.930320 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:20:12.936271 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:20:12.950482 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:20:12.951517 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:20:12.973004 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:20:12.977735 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:20:12.987790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1c19e0d0>]}
[0m16:20:12.991355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1c2a1c90>]}
[0m16:20:12.994972 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.60s]
[0m16:20:13.000887 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.61s]
[0m16:20:13.005245 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:20:13.009668 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:20:13.022559 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:20:13.026698 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:20:13.037286 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:20:13.039917 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:20:13.076147 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:20:13.107463 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:20:13.349496 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:13.355601 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp162013300485"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:20:13.360798 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:13.673104 [debug] [Thread-4 (]: SQL status: SELECT 279 in 0.312 seconds
[0m16:20:14.007185 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.010224 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:20:14.015166 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m16:20:14.019329 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.025567 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp162013300485'
        
      order by ordinal_position

  
[0m16:20:14.054658 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.025 seconds
[0m16:20:14.074117 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.078993 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:20:14.090598 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.006 seconds
[0m16:20:14.114537 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.117368 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:20:14.125045 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m16:20:14.169415 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.195084 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.200933 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp162013300485" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:20:14.230889 [debug] [Thread-4 (]: SQL status: MERGE 279 in 0.015 seconds
[0m16:20:14.241722 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:20:14.247700 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:20:14.257085 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:20:14.270930 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m16:20:14.278435 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:20:14.283686 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0df15390>]}
[0m16:20:14.294160 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 279[0m in 1.25s]
[0m16:20:14.303959 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:20:14.310551 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:20:14.316318 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:20:14.322494 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:20:14.326294 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:20:14.341502 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.399443 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:20:14.443064 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.469735 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.474563 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:20:14.479668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:14.497493 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:20:14.502873 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.505484 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:20:14.554745 [debug] [Thread-2 (]: SQL status: SELECT 60 in 0.046 seconds
[0m16:20:14.573408 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.576279 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:20:14.580797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:14.594092 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.596483 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:20:14.600714 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:14.611377 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:20:14.615598 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.619074 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:20:14.626808 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m16:20:14.636970 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:20:14.642795 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:20:14.646968 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:20:14.659372 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m16:20:14.667621 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:20:14.670185 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d78d22-a848-4323-987f-facebf0ad238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1f7cf3d0>]}
[0m16:20:14.673785 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 60[0m in 0.35s]
[0m16:20:14.677212 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:20:14.684164 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:14.686412 [debug] [MainThread]: On master: BEGIN
[0m16:20:14.688336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:14.696019 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:20:14.698170 [debug] [MainThread]: On master: COMMIT
[0m16:20:14.700380 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:14.702412 [debug] [MainThread]: On master: COMMIT
[0m16:20:14.704687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:14.706715 [debug] [MainThread]: On master: Close
[0m16:20:14.710267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:14.713264 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m16:20:14.715577 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:20:14.717627 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:20:14.719614 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:20:14.722009 [info ] [MainThread]: 
[0m16:20:14.724011 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m16:20:14.726504 [debug] [MainThread]: Command end result
[0m16:20:14.828676 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:20:14.839842 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:20:14.854266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:20:14.856247 [info ] [MainThread]: 
[0m16:20:14.858914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:14.861333 [info ] [MainThread]: 
[0m16:20:14.863391 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:20:14.866329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1322775, "process_in_blocks": "40", "process_kernel_time": 1.400259, "process_mem_max_rss": "134612", "process_out_blocks": "0", "process_user_time": 6.219993}
[0m16:20:14.868494 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:14.868332 after 5.13 seconds
[0m16:20:14.870286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd247ab710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24744610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd22599150>]}
[0m16:20:14.871794 [debug] [MainThread]: Flushing usage events
[0m16:20:17.175703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:29.902778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dac795710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dac7e3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dac795490>]}


============================== 16:20:29.919611 | 1ffeea21-14ea-4cbc-8b77-b5fcba368798 ==============================
[0m16:20:29.919611 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:20:29.922413 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'debug': 'False', 'profiles_dir': '.', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'introspect': 'True'}
[0m16:20:30.370565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ffeea21-14ea-4cbc-8b77-b5fcba368798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dabb65490>]}
[0m16:20:30.505777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ffeea21-14ea-4cbc-8b77-b5fcba368798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf0c29d0>]}
[0m16:20:30.528830 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:20:30.627963 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:20:31.205222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:31.211679 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:20:31.216887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:31.343034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ffeea21-14ea-4cbc-8b77-b5fcba368798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daafb3ad0>]}
[0m16:20:31.619646 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:20:31.632718 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:20:31.815585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ffeea21-14ea-4cbc-8b77-b5fcba368798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dabb59810>]}
[0m16:20:31.819741 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:20:31.824237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ffeea21-14ea-4cbc-8b77-b5fcba368798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dac795ad0>]}
[0m16:20:31.833353 [info ] [MainThread]: 
[0m16:20:31.836040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:31.838022 [info ] [MainThread]: 
[0m16:20:31.844530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:31.860877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:20:31.863411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:20:31.864972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:20:31.947080 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:20:31.947873 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:20:31.948908 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:20:31.954780 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:20:31.958021 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:20:31.960255 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:20:31.964370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:31.969203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:31.974131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:32.003548 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m16:20:32.005503 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m16:20:32.014062 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:20:32.014939 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m16:20:32.016394 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:20:32.022789 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:20:32.025207 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:20:32.027133 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:20:32.036283 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:20:32.045601 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:20:32.047877 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:20:32.050038 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:20:32.050978 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:20:32.058272 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:20:32.061918 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:20:32.065658 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:20:32.069207 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:20:32.079664 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:20:32.095391 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:32.100396 [debug] [MainThread]: On master: BEGIN
[0m16:20:32.103821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:32.115531 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:20:32.117747 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:32.120616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:32.128982 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:20:32.132102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ffeea21-14ea-4cbc-8b77-b5fcba368798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dadd96310>]}
[0m16:20:32.135149 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:32.137391 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:32.138883 [debug] [MainThread]: On master: BEGIN
[0m16:20:32.141638 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:32.145234 [debug] [MainThread]: On master: COMMIT
[0m16:20:32.149252 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:32.152842 [debug] [MainThread]: On master: COMMIT
[0m16:20:32.156219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:32.158535 [debug] [MainThread]: On master: Close
[0m16:20:32.165436 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:20:32.166506 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:20:32.167545 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:20:32.168905 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:20:32.171701 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:20:32.177567 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:20:32.181230 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:20:32.185578 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:20:32.190777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:20:32.194739 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:20:32.197916 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:20:32.201332 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:20:32.204318 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:20:32.206757 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:20:32.209261 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:20:32.211841 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:20:32.248797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:20:32.253825 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:20:32.261158 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:20:32.269970 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:20:32.280670 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:20:32.281425 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:20:32.288316 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:20:32.298902 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:20:32.302772 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:20:32.307365 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:20:32.318521 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:20:32.325530 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:20:32.336641 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:20:32.338918 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:20:32.341558 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:20:32.343389 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:20:32.351819 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:20:32.360015 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:20:32.363403 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:20:32.365949 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:20:32.369120 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:32.373275 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:32.377267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:32.380828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:32.397566 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m16:20:32.400914 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m16:20:32.402360 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:20:32.405535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:20:32.407835 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:20:32.411932 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:20:32.415794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m16:20:32.418072 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:20:32.420222 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:20:32.423470 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:20:32.424752 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:20:32.427844 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:20:32.435223 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:20:32.436203 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:20:32.445102 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:20:32.449391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:20:32.454214 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:20:32.455180 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:20:32.459985 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:20:32.463395 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:20:32.465639 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:20:32.469575 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:20:32.475218 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.27s]
[0m16:20:32.477541 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:20:32.480100 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.28s]
[0m16:20:32.483781 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:20:32.485401 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:20:32.487864 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.30s]
[0m16:20:32.489132 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:20:32.490825 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.30s]
[0m16:20:32.492217 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:20:32.494723 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:20:32.496220 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:20:32.497726 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:20:32.499559 [info ] [Thread-4 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:20:32.502499 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:20:32.505287 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:20:32.507890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:20:32.513469 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:20:32.519421 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:20:32.540573 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:20:32.554008 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:20:32.564791 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:20:32.570189 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:20:32.572234 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:20:32.579276 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:20:32.587106 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:20:32.588730 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:20:32.589344 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:20:32.590235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:32.591460 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:20:32.593397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:32.597379 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:20:32.599170 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:20:32.600540 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m16:20:32.601048 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:20:32.602589 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:20:32.606072 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:20:32.606860 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:20:32.611047 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:20:32.613025 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:20:32.616068 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:20:32.620638 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:20:32.628252 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.12s]
[0m16:20:32.630625 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:20:32.632311 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:20:32.636729 [info ] [Thread-4 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.13s]
[0m16:20:32.645034 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:20:32.654561 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:32.659167 [debug] [MainThread]: On master: BEGIN
[0m16:20:32.662138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:32.673826 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:20:32.676718 [debug] [MainThread]: On master: COMMIT
[0m16:20:32.685321 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:32.688409 [debug] [MainThread]: On master: COMMIT
[0m16:20:32.691454 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:32.694049 [debug] [MainThread]: On master: Close
[0m16:20:32.696462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:32.699482 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:20:32.701652 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:20:32.703754 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:20:32.705639 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:20:32.707772 [info ] [MainThread]: 
[0m16:20:32.709963 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:20:32.713369 [debug] [MainThread]: Command end result
[0m16:20:32.797511 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:20:32.809292 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:20:32.847637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:20:32.855216 [info ] [MainThread]: 
[0m16:20:32.865773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:32.869051 [info ] [MainThread]: 
[0m16:20:32.872213 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:20:32.875483 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1458037, "process_in_blocks": "1240", "process_kernel_time": 0.87939, "process_mem_max_rss": "134516", "process_out_blocks": "0", "process_user_time": 5.562884}
[0m16:20:32.879283 [debug] [MainThread]: Command `dbt test` succeeded at 16:20:32.878914 after 3.15 seconds
[0m16:20:32.883685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db0db4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db0e177d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dac876990>]}
[0m16:20:32.886555 [debug] [MainThread]: Flushing usage events
[0m16:20:34.340434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:14.002820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe971bded90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe971bdead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe971bdee50>]}


============================== 16:25:14.011608 | ec0c979b-8d9e-4aba-ab88-394251f71725 ==============================
[0m16:25:14.011608 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:25:14.013818 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_crypto/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'introspect': 'True'}
[0m16:25:14.316847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe970f51150>]}
[0m16:25:14.380389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97451aa90>]}
[0m16:25:14.434711 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:25:14.506729 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:25:14.806921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:14.809184 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:25:14.811402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:14.861839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9703b0190>]}
[0m16:25:14.968542 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:25:14.974993 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:25:15.008032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe970f94710>]}
[0m16:25:15.010073 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:25:15.011552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9707d2090>]}
[0m16:25:15.014507 [info ] [MainThread]: 
[0m16:25:15.016273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:15.017934 [info ] [MainThread]: 
[0m16:25:15.019841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:15.026928 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:25:15.082739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:25:15.083726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:25:15.180754 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:25:15.181344 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:25:15.181856 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:25:15.183696 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:25:15.185190 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:25:15.186785 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:25:15.188385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:15.190178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:15.192127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:15.203428 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.015 seconds
[0m16:25:15.204190 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.014 seconds
[0m16:25:15.204935 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m16:25:15.207075 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:25:15.209262 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:25:15.212443 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:25:15.218630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:25:15.219978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:25:15.221066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:25:15.228353 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:25:15.231823 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:25:15.236192 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:25:15.238024 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:25:15.239451 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:25:15.240925 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:25:15.242055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:15.243277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:15.244404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:15.251552 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:25:15.253120 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:25:15.254180 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:25:15.255856 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:25:15.257561 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:25:15.258045 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:25:15.259523 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:25:15.261504 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:25:15.265569 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:25:15.270721 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:25:15.271485 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:25:15.272200 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:25:15.274787 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:25:15.277700 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:25:15.280978 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:25:15.283306 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:25:15.284571 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:25:15.285929 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:25:15.296193 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:15.297663 [debug] [MainThread]: On master: BEGIN
[0m16:25:15.298839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:15.312928 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:25:15.314630 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:15.315825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:15.324260 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m16:25:15.327161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96ffe4c50>]}
[0m16:25:15.329388 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:15.331055 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:15.332456 [debug] [MainThread]: On master: BEGIN
[0m16:25:15.334241 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:25:15.336333 [debug] [MainThread]: On master: COMMIT
[0m16:25:15.337908 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:15.339244 [debug] [MainThread]: On master: COMMIT
[0m16:25:15.341234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:25:15.342976 [debug] [MainThread]: On master: Close
[0m16:25:15.352695 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:25:15.353352 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:25:15.354656 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:25:15.356778 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:25:15.358426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m16:25:15.360068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m16:25:15.361824 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:25:15.363842 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:25:15.373434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.377872 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.387082 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:25:15.394436 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:25:15.441651 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.442193 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.454241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.455717 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.456687 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:25:15.458313 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:25:15.459516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:15.461568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:15.468890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:25:15.469984 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:25:15.471483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.472956 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.474427 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:25:15.475755 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:25:15.484294 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:25:15.484886 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:25:15.492374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.498045 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.501040 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:25:15.503995 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:25:15.507687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:15.509258 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:15.513396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.523517 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.524865 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:25:15.526600 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:25:15.528763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:15.530554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:15.549503 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:25:15.551696 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:25:15.553676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.555625 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.557695 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:25:15.559525 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:25:15.562685 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:25:15.563184 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:25:15.569585 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:25:15.573188 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:25:15.580681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:25:15.582319 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:25:15.583794 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:25:15.585551 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:25:15.592157 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:25:15.592909 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:25:15.596452 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:25:15.599076 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:25:15.602848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96c467510>]}
[0m16:25:15.603799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96c443d10>]}
[0m16:25:15.605618 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.24s]
[0m16:25:15.607606 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.25s]
[0m16:25:15.609464 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:25:15.611397 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:25:15.615327 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:25:15.617679 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:25:15.619473 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:25:15.621195 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:25:15.634184 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.648605 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:25:15.710811 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.713092 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp162515688605"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:25:15.715353 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:25:15.738433 [debug] [Thread-4 (]: SQL status: SELECT 294 in 0.023 seconds
[0m16:25:15.768640 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.771122 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:25:15.774479 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:25:15.776380 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.777956 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp162515688605'
        
      order by ordinal_position

  
[0m16:25:15.792192 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.012 seconds
[0m16:25:15.799139 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.800788 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:25:15.805370 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:25:15.816482 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.818242 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:25:15.823907 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:25:15.857117 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.872976 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.875235 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp162515688605" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:25:15.882060 [debug] [Thread-4 (]: SQL status: MERGE 294 in 0.005 seconds
[0m16:25:15.885661 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:25:15.887722 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:25:15.889690 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:25:15.893298 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:25:15.895460 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:25:15.898035 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96c4cc790>]}
[0m16:25:15.899932 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 294[0m in 0.28s]
[0m16:25:15.902142 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:25:15.905309 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:25:15.907003 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:25:15.908919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:25:15.910466 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:25:15.914969 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:25:15.927316 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:25:15.940071 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:25:15.951660 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:25:15.953359 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:25:15.954639 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:15.961236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:25:15.962831 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:25:15.964331 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:25:15.976903 [debug] [Thread-2 (]: SQL status: SELECT 63 in 0.011 seconds
[0m16:25:15.984962 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:25:15.986545 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:25:15.989033 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:15.993568 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:25:15.995089 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:25:15.996792 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:25:15.999295 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:25:16.000822 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:25:16.002556 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:25:16.005118 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:25:16.008648 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:25:16.012492 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:25:16.013843 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:25:16.019164 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:25:16.021901 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:25:16.023955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0c979b-8d9e-4aba-ab88-394251f71725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe970f5df50>]}
[0m16:25:16.025502 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 63[0m in 0.12s]
[0m16:25:16.027191 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:25:16.030649 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:16.032228 [debug] [MainThread]: On master: BEGIN
[0m16:25:16.033591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:16.039501 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:25:16.041088 [debug] [MainThread]: On master: COMMIT
[0m16:25:16.042209 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:16.043360 [debug] [MainThread]: On master: COMMIT
[0m16:25:16.044996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:25:16.046294 [debug] [MainThread]: On master: Close
[0m16:25:16.048115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:16.049194 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m16:25:16.050257 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:25:16.052034 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:25:16.053178 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:25:16.054454 [info ] [MainThread]: 
[0m16:25:16.055722 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m16:25:16.057610 [debug] [MainThread]: Command end result
[0m16:25:16.102326 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:25:16.109492 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:25:16.123479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:25:16.125318 [info ] [MainThread]: 
[0m16:25:16.127582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:16.129428 [info ] [MainThread]: 
[0m16:25:16.131391 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:25:16.134472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2076313, "process_in_blocks": "56", "process_kernel_time": 1.753933, "process_mem_max_rss": "135816", "process_out_blocks": "0", "process_user_time": 5.343379}
[0m16:25:16.136321 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:16.136160 after 2.21 seconds
[0m16:25:16.138327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9761ec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9761db2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9761db150>]}
[0m16:25:16.139943 [debug] [MainThread]: Flushing usage events
[0m16:25:17.993059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:32.889818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144545410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144545650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144544810>]}


============================== 16:25:32.909020 | ffa94853-da41-4ae5-82aa-ec78ee86a493 ==============================
[0m16:25:32.909020 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:25:32.912406 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'invocation_command': 'dbt test --profiles-dir .', 'version_check': 'True', 'warn_error': 'None', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m16:25:33.594206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa94853-da41-4ae5-82aa-ec78ee86a493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1145143650>]}
[0m16:25:33.912317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffa94853-da41-4ae5-82aa-ec78ee86a493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1146f04fd0>]}
[0m16:25:33.916071 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:25:34.143948 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:25:34.626184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:34.632263 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:25:34.636134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:34.727734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffa94853-da41-4ae5-82aa-ec78ee86a493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11433f7e90>]}
[0m16:25:35.043817 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:25:35.060744 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:25:35.419189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffa94853-da41-4ae5-82aa-ec78ee86a493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1142b5ce50>]}
[0m16:25:35.422654 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:25:35.424999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa94853-da41-4ae5-82aa-ec78ee86a493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1142f0d650>]}
[0m16:25:35.431395 [info ] [MainThread]: 
[0m16:25:35.433678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:35.435449 [info ] [MainThread]: 
[0m16:25:35.437556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:35.445519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:25:35.447003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:25:35.449205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:25:35.516056 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:25:35.517252 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:25:35.518827 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:25:35.521625 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:25:35.524339 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:25:35.529328 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:25:35.532646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:35.535173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:35.537291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:35.551854 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m16:25:35.554380 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:25:35.556018 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:25:35.556780 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m16:25:35.558572 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:25:35.560813 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:25:35.563646 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:25:35.567499 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:25:35.574166 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:25:35.577511 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:25:35.582660 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:25:35.584823 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:25:35.586433 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:25:35.587445 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:25:35.593264 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:25:35.596904 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:25:35.606876 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:25:35.611809 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:25:35.625907 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:35.630488 [debug] [MainThread]: On master: BEGIN
[0m16:25:35.632885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:35.649245 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:25:35.652821 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:35.655125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:35.670500 [debug] [MainThread]: SQL status: SELECT 2 in 0.013 seconds
[0m16:25:35.674768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa94853-da41-4ae5-82aa-ec78ee86a493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114453c750>]}
[0m16:25:35.678902 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:35.685287 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:35.689601 [debug] [MainThread]: On master: BEGIN
[0m16:25:35.693817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:25:35.696307 [debug] [MainThread]: On master: COMMIT
[0m16:25:35.700655 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:35.704794 [debug] [MainThread]: On master: COMMIT
[0m16:25:35.709630 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:25:35.712290 [debug] [MainThread]: On master: Close
[0m16:25:35.780799 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:25:35.782108 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:25:35.782942 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:25:35.783758 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:25:35.786383 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:25:35.788347 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:25:35.792466 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:25:35.796039 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:25:35.800531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:25:35.803304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:25:35.806099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:25:35.812954 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:25:35.825481 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:25:35.830300 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:25:35.836920 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:25:35.842265 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:25:35.885488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:25:35.892032 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:25:35.903950 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:25:35.912656 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:25:35.930775 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:25:35.932311 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:25:35.936969 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:25:35.950370 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:25:35.975323 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:25:35.978656 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:25:35.987757 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:25:35.995913 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:25:36.011708 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:25:36.015869 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:25:36.018854 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:25:36.021458 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:25:36.024257 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:25:36.025084 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:25:36.028897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:25:36.032202 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:25:36.036123 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:25:36.040490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:25:36.046671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:36.049708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:36.059565 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m16:25:36.067670 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:25:36.069754 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m16:25:36.072084 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:25:36.073201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m16:25:36.074787 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m16:25:36.076016 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:25:36.082979 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:25:36.084286 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:25:36.087337 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:25:36.090882 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:25:36.094037 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:25:36.130984 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:25:36.133618 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:25:36.138172 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:25:36.142456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:25:36.145104 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:25:36.152089 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:25:36.153242 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:25:36.156124 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:25:36.162449 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.35s]
[0m16:25:36.166213 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:25:36.170302 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:25:36.173370 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:25:36.175595 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:25:36.181170 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.37s]
[0m16:25:36.185637 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:25:36.189794 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.39s]
[0m16:25:36.192370 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:25:36.195636 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:25:36.200715 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.40s]
[0m16:25:36.205053 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:25:36.210347 [info ] [Thread-3 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:25:36.213805 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:25:36.216718 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:25:36.224650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:25:36.230332 [info ] [Thread-4 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:25:36.236762 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:25:36.242001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:25:36.278839 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:25:36.294215 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:25:36.317386 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:25:36.333075 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:25:36.343253 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:25:36.354982 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:25:36.364933 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:25:36.384851 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:25:36.388346 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:25:36.392493 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:25:36.394387 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:25:36.402109 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:25:36.404697 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:25:36.409203 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m16:25:36.412190 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:25:36.416232 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:25:36.424191 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:25:36.425246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m16:25:36.439877 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:25:36.442610 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:25:36.446658 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:25:36.449019 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:25:36.455151 [info ] [Thread-4 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.21s]
[0m16:25:36.463808 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:25:36.465886 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:25:36.471698 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:25:36.474090 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:25:36.479990 [info ] [Thread-3 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.26s]
[0m16:25:36.486355 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:25:36.509477 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:36.514317 [debug] [MainThread]: On master: BEGIN
[0m16:25:36.517066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:36.538781 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m16:25:36.541608 [debug] [MainThread]: On master: COMMIT
[0m16:25:36.545109 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:36.549359 [debug] [MainThread]: On master: COMMIT
[0m16:25:36.555649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:25:36.558929 [debug] [MainThread]: On master: Close
[0m16:25:36.562810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:36.568879 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:25:36.574992 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:25:36.579971 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:25:36.582610 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:25:36.586544 [info ] [MainThread]: 
[0m16:25:36.594669 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m16:25:36.604438 [debug] [MainThread]: Command end result
[0m16:25:36.757789 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:25:36.770598 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:25:36.796221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:25:36.797999 [info ] [MainThread]: 
[0m16:25:36.801834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:36.806432 [info ] [MainThread]: 
[0m16:25:36.811000 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:25:36.817526 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.086184, "process_in_blocks": "12528", "process_kernel_time": 0.923671, "process_mem_max_rss": "128536", "process_out_blocks": "0", "process_user_time": 6.517017}
[0m16:25:36.820377 [debug] [MainThread]: Command `dbt test` succeeded at 16:25:36.819574 after 4.09 seconds
[0m16:25:36.823335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114439f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1148c53750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1148bb5b90>]}
[0m16:25:36.825954 [debug] [MainThread]: Flushing usage events
[0m16:25:39.000392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:07.442798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0e834f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0e834110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0e834dd0>]}


============================== 16:30:07.456170 | 3a2a98c7-c756-4d87-bbaf-96373c0ca3b9 ==============================
[0m16:30:07.456170 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:30:07.460581 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'version_check': 'True', 'use_experimental_parser': 'False'}
[0m16:30:08.219225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0e76af10>]}
[0m16:30:08.408499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f111f2810>]}
[0m16:30:08.412671 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:30:08.580925 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:30:09.293054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:09.298054 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:30:09.303075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:09.392307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0ea49bd0>]}
[0m16:30:09.557192 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:30:09.569545 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:30:09.629312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0d3769d0>]}
[0m16:30:09.632485 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:30:09.635191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0d78bc10>]}
[0m16:30:09.639513 [info ] [MainThread]: 
[0m16:30:09.642219 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:30:09.644323 [info ] [MainThread]: 
[0m16:30:09.647519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:09.660598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:30:09.838376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:30:09.841113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:30:09.966720 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:30:09.967987 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:30:09.968993 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:30:09.971334 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:30:09.974334 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:30:09.976463 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:30:09.979838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:09.983650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:09.987952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:10.010307 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.031 seconds
[0m16:30:10.011125 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.028 seconds
[0m16:30:10.012299 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.024 seconds
[0m16:30:10.014780 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:30:10.019807 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:30:10.026623 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:30:10.036196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:30:10.037807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:30:10.039363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:30:10.053409 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:30:10.058460 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:30:10.068060 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:30:10.070448 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:30:10.072853 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:30:10.075403 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:30:10.077369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:10.080658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:10.084483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:10.101804 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:30:10.106705 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:30:10.112256 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:30:10.114245 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:30:10.118094 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:30:10.119967 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:30:10.124236 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:30:10.128734 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:30:10.136726 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:30:10.140605 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m16:30:10.144954 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:30:10.146443 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m16:30:10.147684 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:30:10.150335 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:30:10.156453 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:30:10.161281 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:30:10.166084 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:30:10.169294 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:30:10.186335 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:10.189854 [debug] [MainThread]: On master: BEGIN
[0m16:30:10.193499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:10.207672 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:30:10.211400 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:10.216489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:10.246434 [debug] [MainThread]: SQL status: SELECT 2 in 0.021 seconds
[0m16:30:10.250501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0d783690>]}
[0m16:30:10.254893 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:10.260244 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:10.264627 [debug] [MainThread]: On master: BEGIN
[0m16:30:10.269487 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:30:10.273433 [debug] [MainThread]: On master: COMMIT
[0m16:30:10.275541 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:10.279217 [debug] [MainThread]: On master: COMMIT
[0m16:30:10.283615 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:10.287447 [debug] [MainThread]: On master: Close
[0m16:30:10.309211 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:30:10.310974 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:30:10.315353 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:30:10.319333 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:30:10.322041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_historical_klines)
[0m16:30:10.324625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_realtime_klines)
[0m16:30:10.327170 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:30:10.329668 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:30:10.349592 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.360912 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.376045 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:30:10.386318 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:30:10.503046 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.502013 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.520501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.522854 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:30:10.523879 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.525376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:10.527845 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:30:10.538615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:10.548322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:30:10.552739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.555590 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:30:10.559168 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:30:10.563828 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.567835 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:30:10.581080 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:30:10.582518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m16:30:10.600738 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.608674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.610778 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:30:10.615489 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:30:10.622758 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:30:10.623870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:30:10.635739 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.646319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.648635 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:30:10.653160 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:30:10.662323 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:30:10.666335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:30:10.744312 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:30:10.745749 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:30:10.748039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.751554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.758325 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:30:10.763664 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:30:10.767782 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:30:10.769206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:10.786846 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:30:10.794472 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:30:10.808234 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:30:10.813984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:30:10.820241 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:30:10.823280 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:30:10.834790 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:30:10.836838 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:30:10.843412 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:30:10.848051 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:30:10.859615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0e88e910>]}
[0m16:30:10.861058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0e779110>]}
[0m16:30:10.863657 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.53s]
[0m16:30:10.869508 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.54s]
[0m16:30:10.874697 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:30:10.878858 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:30:10.885043 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:30:10.889580 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:30:10.894452 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:30:10.898236 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:30:10.924236 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:30:10.950557 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:30:11.058856 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.062736 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp163011026012"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:30:11.069850 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:30:11.099545 [debug] [Thread-4 (]: SQL status: SELECT 309 in 0.030 seconds
[0m16:30:11.136641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.139165 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:30:11.142252 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m16:30:11.145654 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.150111 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp163011026012'
        
      order by ordinal_position

  
[0m16:30:11.194840 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.040 seconds
[0m16:30:11.208173 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.210885 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:30:11.221707 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m16:30:11.255687 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.260116 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:30:11.270655 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.006 seconds
[0m16:30:11.336908 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.366337 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.368771 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp163011026012" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:30:11.387013 [debug] [Thread-4 (]: SQL status: MERGE 309 in 0.015 seconds
[0m16:30:11.392224 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:30:11.396418 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:30:11.404992 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:30:11.411677 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:30:11.415299 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:30:11.417793 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f089bd950>]}
[0m16:30:11.422637 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 309[0m in 0.52s]
[0m16:30:11.427142 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:30:11.433031 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:30:11.435942 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:30:11.439563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:30:11.444170 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:30:11.455249 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.481913 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:30:11.510370 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.534389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.537546 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:30:11.539810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:11.554092 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:30:11.557064 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.559641 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:30:11.586493 [debug] [Thread-2 (]: SQL status: SELECT 66 in 0.024 seconds
[0m16:30:11.610212 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.614355 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:30:11.618190 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:11.626547 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.630773 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:30:11.636628 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:11.641875 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:30:11.644940 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.649388 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:30:11.657475 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m16:30:11.665087 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:30:11.675249 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:30:11.679762 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:30:11.695445 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:30:11.703942 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:30:11.709424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2a98c7-c756-4d87-bbaf-96373c0ca3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0aaf1e50>]}
[0m16:30:11.717350 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 66[0m in 0.27s]
[0m16:30:11.721044 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:30:11.728166 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:11.732636 [debug] [MainThread]: On master: BEGIN
[0m16:30:11.736681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:11.751009 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:30:11.753110 [debug] [MainThread]: On master: COMMIT
[0m16:30:11.755368 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:11.757784 [debug] [MainThread]: On master: COMMIT
[0m16:30:11.760711 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:11.765325 [debug] [MainThread]: On master: Close
[0m16:30:11.767689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:11.770269 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m16:30:11.772120 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:30:11.774904 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:30:11.778851 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:30:11.785080 [info ] [MainThread]: 
[0m16:30:11.787462 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m16:30:11.790670 [debug] [MainThread]: Command end result
[0m16:30:11.907015 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:30:11.924779 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:30:11.962275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:30:11.964880 [info ] [MainThread]: 
[0m16:30:11.968790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:11.976173 [info ] [MainThread]: 
[0m16:30:11.981931 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:30:11.988500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7497487, "process_in_blocks": "168", "process_kernel_time": 1.408042, "process_mem_max_rss": "135856", "process_out_blocks": "0", "process_user_time": 5.662344}
[0m16:30:11.991380 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:11.990945 after 4.75 seconds
[0m16:30:11.997080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f131567d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f12f53850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f12eb1b50>]}
[0m16:30:12.003427 [debug] [MainThread]: Flushing usage events
[0m16:30:14.432684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:29.440291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda895210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda895490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda894850>]}


============================== 16:30:29.456430 | 4020a4cf-6cf2-47a3-b09a-0e771ae19057 ==============================
[0m16:30:29.456430 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:30:29.459598 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'version_check': 'True', 'profiles_dir': '.', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m16:30:29.928835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4020a4cf-6cf2-47a3-b09a-0e771ae19057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda8ebcd0>]}
[0m16:30:30.075265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4020a4cf-6cf2-47a3-b09a-0e771ae19057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edd289b10>]}
[0m16:30:30.078341 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:30:30.297555 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:30:31.041665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:31.046228 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:30:31.050044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:31.137309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4020a4cf-6cf2-47a3-b09a-0e771ae19057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed93f0090>]}
[0m16:30:31.353575 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:30:31.374000 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:30:31.622018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4020a4cf-6cf2-47a3-b09a-0e771ae19057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed9fffd50>]}
[0m16:30:31.630319 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:30:31.636770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4020a4cf-6cf2-47a3-b09a-0e771ae19057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edbceda10>]}
[0m16:30:31.643065 [info ] [MainThread]: 
[0m16:30:31.645961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:30:31.651568 [info ] [MainThread]: 
[0m16:30:31.658485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:31.678182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:30:31.682370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:30:31.684352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:30:31.863611 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:30:31.866422 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:30:31.868298 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:30:31.872502 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:30:31.874763 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:30:31.878815 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:30:31.888205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:31.895418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:31.904286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:31.919508 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m16:30:31.923663 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:30:31.929799 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:30:31.935374 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:30:31.937175 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m16:30:31.938575 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:30:31.942279 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:30:31.950005 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:30:31.963098 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:30:31.964563 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:30:31.978287 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:30:31.980286 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m16:30:31.981964 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m16:30:31.991220 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:30:31.995318 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:30:31.998948 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:30:32.009978 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:30:32.015700 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:30:32.036354 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.042602 [debug] [MainThread]: On master: BEGIN
[0m16:30:32.049523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:32.068029 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:30:32.070989 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.073488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:32.090073 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m16:30:32.097267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4020a4cf-6cf2-47a3-b09a-0e771ae19057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edb46fc10>]}
[0m16:30:32.100322 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:32.103373 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.105785 [debug] [MainThread]: On master: BEGIN
[0m16:30:32.109415 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:30:32.115704 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.121063 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.123627 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.127027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:30:32.129077 [debug] [MainThread]: On master: Close
[0m16:30:32.143746 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:30:32.144669 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:30:32.145764 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:30:32.146751 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:30:32.148494 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:30:32.150704 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:30:32.156684 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:30:32.163439 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:30:32.166594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:30:32.171162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:30:32.173612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:30:32.176808 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:30:32.183591 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:30:32.189468 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:30:32.192135 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:30:32.194403 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:30:32.230292 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:30:32.237301 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:30:32.243820 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:30:32.255641 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:30:32.267953 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:30:32.277353 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:30:32.291727 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:30:32.318176 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:30:32.322003 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:30:32.316895 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:30:32.334136 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:30:32.344000 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:30:32.364195 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:30:32.365961 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:30:32.369716 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:30:32.371436 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:30:32.372322 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:30:32.375077 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:30:32.380387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:32.386088 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:30:32.389404 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:30:32.392681 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:30:32.398821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:32.406495 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:30:32.410603 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m16:30:32.418967 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:30:32.424911 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:30:32.428623 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m16:30:32.432465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:30:32.434216 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m16:30:32.438156 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:30:32.439653 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:30:32.441318 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:30:32.444522 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:30:32.450103 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:30:32.460822 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:30:32.466941 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:30:32.471795 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:30:32.476509 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:30:32.477703 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:30:32.486279 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:30:32.494023 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:30:32.495449 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:30:32.498221 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.33s]
[0m16:30:32.503601 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:30:32.510743 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:30:32.514057 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:30:32.517442 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:30:32.520200 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:30:32.525362 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.35s]
[0m16:30:32.529768 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:30:32.534955 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:30:32.538284 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.37s]
[0m16:30:32.540952 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:30:32.543879 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.37s]
[0m16:30:32.546276 [info ] [Thread-2 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:30:32.552519 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:30:32.557131 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:30:32.560151 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:30:32.563569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:30:32.568347 [info ] [Thread-4 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:30:32.577584 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:30:32.580187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:30:32.592773 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:30:32.594381 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:30:32.612201 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:30:32.621831 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:30:32.631766 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:30:32.634459 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:30:32.640713 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:30:32.663058 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:30:32.665186 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:30:32.666501 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:30:32.672647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:32.675821 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:30:32.685790 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:30:32.693085 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:30:32.697125 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:30:32.699673 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:30:32.702891 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m16:30:32.709124 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:30:32.712133 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:30:32.717387 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:30:32.722279 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:30:32.728594 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:30:32.732201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:30:32.740761 [info ] [Thread-2 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.18s]
[0m16:30:32.746637 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:30:32.751958 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:30:32.759648 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:30:32.766290 [info ] [Thread-4 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.19s]
[0m16:30:32.769849 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:30:32.781902 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.784676 [debug] [MainThread]: On master: BEGIN
[0m16:30:32.787256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:32.803890 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:30:32.806936 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.809128 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.811704 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.818701 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:32.823358 [debug] [MainThread]: On master: Close
[0m16:30:32.827387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:32.830118 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:30:32.834461 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:30:32.842798 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:30:32.846071 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:30:32.848958 [info ] [MainThread]: 
[0m16:30:32.851638 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m16:30:32.862556 [debug] [MainThread]: Command end result
[0m16:30:32.984089 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:30:33.004252 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:30:33.041255 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:30:33.048340 [info ] [MainThread]: 
[0m16:30:33.051608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:33.055609 [info ] [MainThread]: 
[0m16:30:33.060064 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:30:33.073964 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7735872, "process_in_blocks": "1296", "process_kernel_time": 0.990428, "process_mem_max_rss": "133008", "process_out_blocks": "0", "process_user_time": 6.79434}
[0m16:30:33.077143 [debug] [MainThread]: Command `dbt test` succeeded at 16:30:33.076799 after 3.78 seconds
[0m16:30:33.080368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda882a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edeeba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edefdf7d0>]}
[0m16:30:33.084384 [debug] [MainThread]: Flushing usage events
[0m16:30:34.739202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:08.649115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cf0fa390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cf0f9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cf0fb910>]}


============================== 16:35:08.673131 | 4486a705-d80a-4465-aa41-99133fa51b9c ==============================
[0m16:35:08.673131 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:35:08.679447 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'empty': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '.', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True'}
[0m16:35:09.363232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cfd178d0>]}
[0m16:35:09.539017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d1a22710>]}
[0m16:35:09.542109 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:09.782055 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:35:10.536184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:10.541976 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:35:10.546523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:10.702633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cd720590>]}
[0m16:35:11.076275 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:35:11.111707 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:35:11.239105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cdbf7f10>]}
[0m16:35:11.242274 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:35:11.248228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cf1669d0>]}
[0m16:35:11.259622 [info ] [MainThread]: 
[0m16:35:11.264788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:11.270951 [info ] [MainThread]: 
[0m16:35:11.280030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:11.293782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:35:11.543002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:35:11.545244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:35:11.696281 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:35:11.698468 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:35:11.701213 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:35:11.706426 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:35:11.712974 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:35:11.715899 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:35:11.720409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:11.728073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:11.732811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:11.759180 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.039 seconds
[0m16:35:11.760392 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.033 seconds
[0m16:35:11.768722 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.036 seconds
[0m16:35:11.769975 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:35:11.775196 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:35:11.784326 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:35:11.801744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:35:11.806695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:35:11.808951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:35:11.832963 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:35:11.849212 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:35:11.856422 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:35:11.862763 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:35:11.868454 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:35:11.871999 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:35:11.875180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:11.882432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:11.889414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:11.904252 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m16:35:11.906365 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:35:11.908165 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:35:11.909251 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m16:35:11.914633 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:35:11.921792 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:35:11.925018 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:35:11.928357 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:35:11.939136 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:35:11.948365 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m16:35:11.950572 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:35:11.957717 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m16:35:11.956429 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:35:11.964053 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:35:11.968477 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:35:11.973936 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:35:11.981013 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:35:11.985959 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:35:12.023401 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:12.026372 [debug] [MainThread]: On master: BEGIN
[0m16:35:12.033584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:12.049743 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:35:12.055111 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:12.061943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:12.077257 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m16:35:12.086846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cfcdfa10>]}
[0m16:35:12.091851 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:12.097875 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:12.100910 [debug] [MainThread]: On master: BEGIN
[0m16:35:12.107254 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:12.109938 [debug] [MainThread]: On master: COMMIT
[0m16:35:12.116219 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:12.118732 [debug] [MainThread]: On master: COMMIT
[0m16:35:12.124354 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:35:12.128844 [debug] [MainThread]: On master: Close
[0m16:35:12.175762 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:35:12.177228 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:35:12.179844 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:35:12.183803 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:35:12.190517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_historical_klines)
[0m16:35:12.197869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_realtime_klines)
[0m16:35:12.201835 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:35:12.205506 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:35:12.227913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.238201 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.260937 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:35:12.261985 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:35:12.389928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.391066 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.491778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.494526 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:35:12.497726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.503024 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:12.508029 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:35:12.512501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:12.522217 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m16:35:12.528722 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.530730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:35:12.532918 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:35:12.536415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.547883 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:35:12.627173 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.084 seconds
[0m16:35:12.633244 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.082 seconds
[0m16:35:12.661459 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.673167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.680794 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:35:12.685454 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:35:12.697061 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:35:12.702080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:35:12.715202 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.729110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.737000 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:35:12.744657 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:35:12.755334 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:35:12.758385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:35:12.858605 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:35:12.862535 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:35:12.868788 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:35:12.874402 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:12.877000 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:35:12.880618 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:35:12.936331 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m16:35:12.937542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m16:35:12.964135 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:35:12.983359 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:35:13.005275 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:35:13.010929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:35:13.014462 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:35:13.018005 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:35:13.044544 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.021 seconds
[0m16:35:13.053528 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.026 seconds
[0m16:35:13.052605 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:35:13.065349 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:35:13.076893 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc183350>]}
[0m16:35:13.079781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc10b490>]}
[0m16:35:13.087010 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.88s]
[0m16:35:13.096586 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.89s]
[0m16:35:13.104096 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:35:13.108592 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:35:13.118378 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:35:13.125711 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:35:13.131978 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:35:13.137685 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:35:13.168686 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.201880 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:35:13.338637 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.347700 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp163513280432"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:35:13.353451 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:35:13.431564 [debug] [Thread-4 (]: SQL status: SELECT 324 in 0.077 seconds
[0m16:35:13.481071 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.485772 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:35:13.496301 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m16:35:13.499002 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.502450 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp163513280432'
        
      order by ordinal_position

  
[0m16:35:13.553842 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.046 seconds
[0m16:35:13.579547 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.585199 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:35:13.593365 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m16:35:13.640528 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.645399 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:35:13.667589 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.013 seconds
[0m16:35:13.776119 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.830402 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.858036 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp163513280432" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:35:13.871795 [debug] [Thread-4 (]: SQL status: MERGE 324 in 0.010 seconds
[0m16:35:13.877782 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:35:13.886385 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:35:13.889313 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:35:13.972977 [debug] [Thread-4 (]: SQL status: COMMIT in 0.080 seconds
[0m16:35:13.978036 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:35:13.985718 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c4f05750>]}
[0m16:35:13.994697 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 324[0m in 0.85s]
[0m16:35:13.999683 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:35:14.007822 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:35:14.013700 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:35:14.019010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:35:14.027313 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:35:14.041537 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.078711 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:35:14.166107 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.218889 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.223763 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:35:14.227163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:14.259645 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m16:35:14.269162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.276154 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:35:14.352715 [debug] [Thread-2 (]: SQL status: SELECT 69 in 0.073 seconds
[0m16:35:14.396805 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.409168 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:35:14.415954 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:35:14.436276 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.442422 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:35:14.452282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:14.459603 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:35:14.475484 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.490123 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:35:14.555497 [debug] [Thread-2 (]: SQL status: COMMIT in 0.059 seconds
[0m16:35:14.572185 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:35:14.594424 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:35:14.597064 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:35:14.623558 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.019 seconds
[0m16:35:14.630673 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:35:14.640837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4486a705-d80a-4465-aa41-99133fa51b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc274c90>]}
[0m16:35:14.644955 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 69[0m in 0.62s]
[0m16:35:14.658019 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:35:14.676225 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:14.698950 [debug] [MainThread]: On master: BEGIN
[0m16:35:14.702661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:14.715033 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:35:14.726964 [debug] [MainThread]: On master: COMMIT
[0m16:35:14.731543 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:14.737189 [debug] [MainThread]: On master: COMMIT
[0m16:35:14.745105 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:35:14.753519 [debug] [MainThread]: On master: Close
[0m16:35:14.758246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:14.762165 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:35:14.772219 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:35:14.775034 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m16:35:14.789866 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:35:14.793466 [info ] [MainThread]: 
[0m16:35:14.797487 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m16:35:14.809055 [debug] [MainThread]: Command end result
[0m16:35:15.060874 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:35:15.097922 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:35:15.154647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:35:15.157447 [info ] [MainThread]: 
[0m16:35:15.162411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:15.165774 [info ] [MainThread]: 
[0m16:35:15.169091 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:35:15.174068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.724048, "process_in_blocks": "8", "process_kernel_time": 1.496698, "process_mem_max_rss": "134328", "process_out_blocks": "0", "process_user_time": 9.612595}
[0m16:35:15.183372 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:15.181638 after 6.73 seconds
[0m16:35:15.193051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d36e4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d376f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cf31a490>]}
[0m16:35:15.199623 [debug] [MainThread]: Flushing usage events
[0m16:35:18.070518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:33.376297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7e445010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7e444c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7e445250>]}


============================== 16:35:33.402652 | 65bb36ba-466a-4b73-a81f-738efba2c83f ==============================
[0m16:35:33.402652 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:35:33.409137 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'empty': 'None', 'printer_width': '80', 'log_format': 'default', 'log_path': '/opt/airflow/dbt_crypto/logs', 'profiles_dir': '.', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False'}
[0m16:35:34.235036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65bb36ba-466a-4b73-a81f-738efba2c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7dba7b90>]}
[0m16:35:34.618302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65bb36ba-466a-4b73-a81f-738efba2c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac80e78b10>]}
[0m16:35:34.626878 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:35.001309 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:35:35.794823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:35.803691 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:35:35.810481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:35.930229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65bb36ba-466a-4b73-a81f-738efba2c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7cfefad0>]}
[0m16:35:36.104153 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:35:36.116931 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:35:36.357162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65bb36ba-466a-4b73-a81f-738efba2c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d3f1d90>]}
[0m16:35:36.360828 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:35:36.363795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bb36ba-466a-4b73-a81f-738efba2c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7cfe5b50>]}
[0m16:35:36.380764 [info ] [MainThread]: 
[0m16:35:36.383661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:36.390525 [info ] [MainThread]: 
[0m16:35:36.396601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:36.423832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:35:36.426990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:35:36.428889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:35:36.555759 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:35:36.556544 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:35:36.557446 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:35:36.560021 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:35:36.566490 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:35:36.572734 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:35:36.575592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:36.578438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:36.581248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:36.628377 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:35:36.631299 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m16:35:36.632590 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:35:36.635553 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m16:35:36.641036 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:35:36.646833 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:35:36.649235 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:35:36.652819 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:35:36.661734 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:35:36.674879 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m16:35:36.682713 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:35:36.683679 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.019 seconds
[0m16:35:36.684352 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m16:35:36.686635 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:35:36.693010 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:35:36.701878 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:35:36.713003 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:35:36.719387 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:35:36.749568 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.754619 [debug] [MainThread]: On master: BEGIN
[0m16:35:36.757359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:36.776274 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:35:36.779244 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.782342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:36.798853 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m16:35:36.804819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bb36ba-466a-4b73-a81f-738efba2c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7c783bd0>]}
[0m16:35:36.812127 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:36.816991 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.820050 [debug] [MainThread]: On master: BEGIN
[0m16:35:36.824142 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:36.830065 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.835252 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.837288 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.840395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:36.842878 [debug] [MainThread]: On master: Close
[0m16:35:36.861718 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:35:36.864186 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:35:36.868338 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:35:36.871005 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:35:36.875282 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:35:36.878905 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:35:36.881898 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:35:36.886568 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:35:36.894704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:35:36.898277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:35:36.900911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:35:36.903402 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:35:36.905127 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:35:36.909082 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:35:36.913086 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:35:36.915413 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:35:37.015393 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:35:37.016761 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:35:37.009108 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:35:37.044376 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:35:37.059433 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:35:37.062498 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:35:37.072799 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:35:37.074225 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:35:37.165886 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:35:37.155861 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:35:37.167757 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:35:37.183387 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:35:37.206442 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:35:37.208621 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:35:37.210191 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:35:37.211293 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:35:37.214829 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:35:37.216653 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:35:37.222354 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:35:37.224774 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:35:37.231957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:37.238729 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:35:37.245392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:37.250979 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:35:37.256656 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m16:35:37.264486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:35:37.269500 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:35:37.273678 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:35:37.277565 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m16:35:37.279411 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:35:37.280721 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m16:35:37.286022 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:35:37.292314 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:35:37.299251 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:35:37.300576 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:35:37.306425 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:35:37.309700 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:35:37.314889 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:35:37.327616 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:35:37.339795 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:35:37.340574 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m16:35:37.346100 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:35:37.348307 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:35:37.355082 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:35:37.361712 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:35:37.366401 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:35:37.370071 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.47s]
[0m16:35:37.376128 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.48s]
[0m16:35:37.382556 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:35:37.385052 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:35:37.387762 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:35:37.390809 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:35:37.398935 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.50s]
[0m16:35:37.405041 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.50s]
[0m16:35:37.407537 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:35:37.410587 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:35:37.413114 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:35:37.415596 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:35:37.418089 [info ] [Thread-4 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:35:37.423514 [info ] [Thread-1 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:35:37.431534 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:35:37.435039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:35:37.437121 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:35:37.440695 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:35:37.464679 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:35:37.475653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:35:37.504090 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:35:37.516763 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:35:37.525031 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:35:37.525922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:35:37.550712 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:35:37.569618 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:35:37.564461 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:35:37.575943 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:35:37.585499 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:35:37.594225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:37.610349 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m16:35:37.615529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:35:37.617624 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:35:37.621283 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:35:37.624031 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:35:37.627640 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:35:37.638966 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:35:37.641638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:35:37.647112 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:35:37.652958 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:35:37.659533 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:35:37.665302 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:35:37.671537 [info ] [Thread-4 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.24s]
[0m16:35:37.674362 [info ] [Thread-1 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.24s]
[0m16:35:37.676701 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:35:37.680236 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:35:37.694527 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:37.697065 [debug] [MainThread]: On master: BEGIN
[0m16:35:37.700792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:37.718545 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:35:37.721584 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.727237 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:37.733164 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.736654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:37.739338 [debug] [MainThread]: On master: Close
[0m16:35:37.744838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:37.751743 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:35:37.755282 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:35:37.761521 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:35:37.767089 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:35:37.769640 [info ] [MainThread]: 
[0m16:35:37.774018 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m16:35:37.780232 [debug] [MainThread]: Command end result
[0m16:35:37.898900 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:35:37.919276 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:35:37.946595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:35:37.952313 [info ] [MainThread]: 
[0m16:35:37.955168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:37.958384 [info ] [MainThread]: 
[0m16:35:37.962052 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:35:37.972975 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.821148, "process_in_blocks": "1232", "process_kernel_time": 1.093455, "process_mem_max_rss": "133580", "process_out_blocks": "0", "process_user_time": 7.380822}
[0m16:35:37.976536 [debug] [MainThread]: Command `dbt test` succeeded at 16:35:37.976053 after 4.83 seconds
[0m16:35:37.979117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7e717d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7e46ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac82b6c4d0>]}
[0m16:35:37.982411 [debug] [MainThread]: Flushing usage events
[0m16:35:39.724731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:04.875787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b74fa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b750c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b7563490>]}


============================== 16:40:04.927393 | 8213439d-27b0-4633-983c-1e94dd6e50f4 ==============================
[0m16:40:04.927393 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:40:04.929048 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir .'}
[0m16:40:05.205532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b6ecc450>]}
[0m16:40:05.270917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b9e34a90>]}
[0m16:40:05.273447 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:40:05.340689 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:40:05.770518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:05.773010 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:40:05.774948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:05.847298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b63c6ed0>]}
[0m16:40:05.964770 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:40:05.975284 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:40:06.073720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b77ecdd0>]}
[0m16:40:06.076251 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:40:06.078279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b6f4fe50>]}
[0m16:40:06.082011 [info ] [MainThread]: 
[0m16:40:06.083964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:06.085871 [info ] [MainThread]: 
[0m16:40:06.087798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:06.096574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:40:06.157697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:40:06.163983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:40:06.209886 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:40:06.210735 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:40:06.211456 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:40:06.212786 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:40:06.215140 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:40:06.217589 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:40:06.219744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:06.222201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:06.224746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:06.235474 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.016 seconds
[0m16:40:06.236528 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.014 seconds
[0m16:40:06.237372 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.013 seconds
[0m16:40:06.239843 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:40:06.243323 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:40:06.246698 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:40:06.254470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:40:06.256073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:40:06.257473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:40:06.266599 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:40:06.271168 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:40:06.276283 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:40:06.278604 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:40:06.280274 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:40:06.282246 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:40:06.284419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:06.286570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:06.288697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:06.296357 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:40:06.298084 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:40:06.299085 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:40:06.299860 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:40:06.300901 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:40:06.303175 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:40:06.305565 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:40:06.309483 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:40:06.311753 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:40:06.321006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:40:06.333212 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:40:06.335508 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:40:06.351811 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m16:40:06.355397 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:40:06.362297 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:40:06.363829 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.056 seconds
[0m16:40:06.367850 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:40:06.370039 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:40:06.377894 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.380893 [debug] [MainThread]: On master: BEGIN
[0m16:40:06.382575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:06.390502 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:40:06.392564 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.394744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:06.403533 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m16:40:06.407008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b47314d0>]}
[0m16:40:06.409459 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:06.411667 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.413618 [debug] [MainThread]: On master: BEGIN
[0m16:40:06.415428 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:06.417176 [debug] [MainThread]: On master: COMMIT
[0m16:40:06.419117 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.420750 [debug] [MainThread]: On master: COMMIT
[0m16:40:06.422788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:06.424711 [debug] [MainThread]: On master: Close
[0m16:40:06.433913 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:40:06.434781 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:40:06.436537 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:40:06.438958 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:40:06.441151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_historical_klines)
[0m16:40:06.443078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m16:40:06.445140 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:40:06.447064 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:40:06.457215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.461907 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.472394 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:40:06.480366 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:40:06.522975 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.524437 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.534356 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.535904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.536893 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:40:06.538842 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:40:06.541071 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:06.542683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:06.548740 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:40:06.550204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:40:06.551141 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.553148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.554642 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:40:06.556485 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:40:06.570862 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:40:06.571678 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:40:06.580639 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.586798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.589663 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:40:06.591951 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:40:06.595023 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:06.596751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:06.600871 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.606719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.609242 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:40:06.611573 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:40:06.614597 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:06.616309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:06.636683 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:40:06.639699 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:40:06.641973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.643806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.646147 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:40:06.648468 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:40:06.732128 [debug] [Thread-2 (]: SQL status: COMMIT in 0.082 seconds
[0m16:40:06.733168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.081 seconds
[0m16:40:06.742027 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:40:06.746677 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:40:06.756923 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:40:06.759800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:40:06.762251 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:40:06.764755 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:40:06.771718 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:40:06.773263 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:40:06.777320 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:40:06.780867 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:40:06.784799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b7633fd0>]}
[0m16:40:06.786046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b6788f50>]}
[0m16:40:06.788105 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.34s]
[0m16:40:06.790249 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.34s]
[0m16:40:06.792516 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:40:06.794626 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:40:06.798231 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:40:06.800021 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:40:06.802322 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:40:06.804214 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:40:06.814990 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:40:06.834012 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:40:06.878137 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:06.881057 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp164006864095"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:40:06.883167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:06.988211 [debug] [Thread-4 (]: SQL status: SELECT 339 in 0.105 seconds
[0m16:40:07.005087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.007158 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:40:07.009462 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:40:07.011205 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.012917 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp164006864095'
        
      order by ordinal_position

  
[0m16:40:07.022836 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.009 seconds
[0m16:40:07.029761 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.031427 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:40:07.036155 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:40:07.046874 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.049113 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:40:07.054425 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:40:07.080711 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.096535 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.098836 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp164006864095" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:40:07.104137 [debug] [Thread-4 (]: SQL status: MERGE 339 in 0.004 seconds
[0m16:40:07.107824 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:40:07.110069 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:40:07.111868 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:40:07.115626 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:40:07.118218 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:40:07.120858 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b46b9310>]}
[0m16:40:07.123265 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 339[0m in 0.32s]
[0m16:40:07.125576 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:40:07.128400 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:40:07.131348 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:40:07.133969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:40:07.136141 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:40:07.141444 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.160242 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:40:07.183079 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.200972 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.203377 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:40:07.205551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:07.218765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:07.221388 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.223582 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:40:07.254133 [debug] [Thread-2 (]: SQL status: SELECT 72 in 0.028 seconds
[0m16:40:07.266826 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.269524 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:40:07.273757 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:07.281654 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.283890 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:40:07.286986 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:07.291520 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:40:07.293688 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.295740 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:40:07.298732 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:40:07.304162 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:40:07.309645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:40:07.311835 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:40:07.317251 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:40:07.320689 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:40:07.323484 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8213439d-27b0-4633-983c-1e94dd6e50f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b46c0290>]}
[0m16:40:07.325835 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 72[0m in 0.19s]
[0m16:40:07.328047 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:40:07.331773 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:07.334127 [debug] [MainThread]: On master: BEGIN
[0m16:40:07.336207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:07.343334 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:40:07.345352 [debug] [MainThread]: On master: COMMIT
[0m16:40:07.346863 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:07.348491 [debug] [MainThread]: On master: COMMIT
[0m16:40:07.350714 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:07.352253 [debug] [MainThread]: On master: Close
[0m16:40:07.354336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:07.356226 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:40:07.358126 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m16:40:07.359716 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:40:07.361451 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:40:07.363318 [info ] [MainThread]: 
[0m16:40:07.365337 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m16:40:07.367990 [debug] [MainThread]: Command end result
[0m16:40:07.419974 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:40:07.430339 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:40:07.446238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:40:07.448405 [info ] [MainThread]: 
[0m16:40:07.450596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:07.452577 [info ] [MainThread]: 
[0m16:40:07.454558 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:40:07.457718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.669057, "process_in_blocks": "16", "process_kernel_time": 0.362388, "process_mem_max_rss": "133796", "process_out_blocks": "0", "process_user_time": 3.656824}
[0m16:40:07.460388 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:07.460051 after 2.67 seconds
[0m16:40:07.463221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b77dfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64bbb08610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64bbb97850>]}
[0m16:40:07.465395 [debug] [MainThread]: Flushing usage events
[0m16:40:09.775899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:17.681508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59fb7d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59fbd3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59fb7cf90>]}


============================== 16:40:17.688370 | 26b65c71-0253-4c9b-9fc4-73ce1a182778 ==============================
[0m16:40:17.688370 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:40:17.690118 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'log_path': '/opt/airflow/dbt_crypto/logs', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'target_path': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m16:40:17.914101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26b65c71-0253-4c9b-9fc4-73ce1a182778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59f5a4a50>]}
[0m16:40:17.980203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26b65c71-0253-4c9b-9fc4-73ce1a182778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a248e790>]}
[0m16:40:17.983030 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:40:18.045078 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:40:18.368443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:18.370446 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:40:18.372029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:18.423577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26b65c71-0253-4c9b-9fc4-73ce1a182778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59e9a0d10>]}
[0m16:40:18.534469 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:40:18.545279 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:40:18.745576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26b65c71-0253-4c9b-9fc4-73ce1a182778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a16a6a10>]}
[0m16:40:18.747581 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:40:18.749367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26b65c71-0253-4c9b-9fc4-73ce1a182778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59edb2bd0>]}
[0m16:40:18.752571 [info ] [MainThread]: 
[0m16:40:18.754013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:18.755418 [info ] [MainThread]: 
[0m16:40:18.757344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:18.764325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:40:18.765351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:40:18.768687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:40:18.808626 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:40:18.809205 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:40:18.809753 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:40:18.811254 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:40:18.813281 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:40:18.815312 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:40:18.817727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:18.819778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:18.821649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:18.829703 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:40:18.830807 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:40:18.831419 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:40:18.832096 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:40:18.834023 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:40:18.835725 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:40:18.837016 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:40:18.839266 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:40:18.841405 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:40:18.847825 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:40:18.848514 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:40:18.851198 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:40:18.851742 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:40:18.854887 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:40:18.857243 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:40:18.859556 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:40:18.861392 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:40:18.864237 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:40:18.872206 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.874053 [debug] [MainThread]: On master: BEGIN
[0m16:40:18.875981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:18.882991 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:40:18.884735 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.886366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:18.893155 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:40:18.895729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26b65c71-0253-4c9b-9fc4-73ce1a182778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a2251d10>]}
[0m16:40:18.897710 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:18.899395 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.900913 [debug] [MainThread]: On master: BEGIN
[0m16:40:18.902863 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:18.904540 [debug] [MainThread]: On master: COMMIT
[0m16:40:18.906098 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.907466 [debug] [MainThread]: On master: COMMIT
[0m16:40:18.908898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:18.910661 [debug] [MainThread]: On master: Close
[0m16:40:18.917475 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:40:18.918018 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:40:18.918593 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:40:18.919225 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:40:18.920273 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:40:18.922167 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:40:18.924103 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:40:18.926181 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:40:18.927639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:40:18.929706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:40:18.931557 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:40:18.933396 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:40:18.934978 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:40:18.936814 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:40:18.938563 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:40:18.940829 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:40:18.958930 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:40:18.964844 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:40:18.972010 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:40:18.977980 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:40:18.988275 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:40:18.989946 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:40:18.996595 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:40:19.009746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:40:19.010331 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:40:19.014336 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:40:19.019850 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:40:19.026398 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:40:19.035481 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:40:19.036283 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:40:19.038086 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:40:19.038650 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:40:19.039306 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:40:19.040042 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:40:19.041957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:19.044188 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:40:19.045525 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:40:19.047625 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:19.050898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:19.052808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:19.054570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:19.060482 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:40:19.061810 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m16:40:19.063559 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:40:19.064537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m16:40:19.065884 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:40:19.066429 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:40:19.069383 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:40:19.070303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:19.071319 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:40:19.072841 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:40:19.074558 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:40:19.079494 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:40:19.082012 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:19.082636 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:40:19.086685 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:19.087142 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:40:19.089695 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:40:19.092865 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:19.094819 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:40:19.097280 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.17s]
[0m16:40:19.098806 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:40:19.101627 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:40:19.103973 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:40:19.105489 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:40:19.107671 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.17s]
[0m16:40:19.109528 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:40:19.111479 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.18s]
[0m16:40:19.113099 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:40:19.115057 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:40:19.117473 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.19s]
[0m16:40:19.119145 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:40:19.121207 [info ] [Thread-1 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:40:19.123843 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:40:19.126110 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:40:19.129373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:40:19.131361 [info ] [Thread-4 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:40:19.135098 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:40:19.137134 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:40:19.144464 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:40:19.145897 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:40:19.153455 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:40:19.162067 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:40:19.163451 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:40:19.167513 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:40:19.172989 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:40:19.182880 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:40:19.186907 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:40:19.187996 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:40:19.190707 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:40:19.193510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:19.195715 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:19.206652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:19.208929 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:19.210469 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:40:19.213374 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:40:19.216366 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:40:19.218837 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:40:19.223686 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:19.224712 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:19.228939 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:40:19.233413 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:40:19.236872 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:40:19.239183 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:40:19.241480 [info ] [Thread-1 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.11s]
[0m16:40:19.243624 [info ] [Thread-4 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.11s]
[0m16:40:19.245542 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:40:19.247866 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:40:19.254011 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:19.256234 [debug] [MainThread]: On master: BEGIN
[0m16:40:19.258407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:19.266176 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:40:19.268201 [debug] [MainThread]: On master: COMMIT
[0m16:40:19.269964 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:19.271782 [debug] [MainThread]: On master: COMMIT
[0m16:40:19.273503 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:19.275134 [debug] [MainThread]: On master: Close
[0m16:40:19.276953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:19.278503 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:40:19.280055 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:40:19.282027 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:40:19.283768 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:40:19.285733 [info ] [MainThread]: 
[0m16:40:19.287670 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:40:19.290510 [debug] [MainThread]: Command end result
[0m16:40:19.343730 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:40:19.353656 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:40:19.369063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:40:19.371048 [info ] [MainThread]: 
[0m16:40:19.372920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:19.374871 [info ] [MainThread]: 
[0m16:40:19.377055 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:40:19.379228 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7885277, "process_in_blocks": "1232", "process_kernel_time": 0.434802, "process_mem_max_rss": "134336", "process_out_blocks": "0", "process_user_time": 2.990594}
[0m16:40:19.381386 [debug] [MainThread]: Command `dbt test` succeeded at 16:40:19.381220 after 1.79 seconds
[0m16:40:19.383332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a41db710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59fd89790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59fd89a90>]}
[0m16:40:19.385422 [debug] [MainThread]: Flushing usage events
[0m16:40:21.156515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:05.653766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4736094610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4736367d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473608b490>]}


============================== 16:45:05.660660 | 7f75d14e-48cb-4b1b-b9ea-0278b1b4d317 ==============================
[0m16:45:05.660660 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:45:05.662521 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'debug': 'False', 'profiles_dir': '.', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:45:05.907784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4736082890>]}
[0m16:45:05.970712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4738a86b10>]}
[0m16:45:05.973288 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:45:06.059437 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:45:06.363192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:06.364881 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:45:06.366606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:06.420621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4734bc3e50>]}
[0m16:45:06.530383 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:45:06.538326 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:45:06.565952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4734b64ad0>]}
[0m16:45:06.567968 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:45:06.569684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47347e1890>]}
[0m16:45:06.573311 [info ] [MainThread]: 
[0m16:45:06.575382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:06.576630 [info ] [MainThread]: 
[0m16:45:06.578249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:06.584108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:45:06.640307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:45:06.641363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:45:06.696028 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:45:06.696688 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:45:06.697507 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:45:06.699036 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:45:06.700898 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:45:06.703018 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:45:06.704897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:06.706554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:06.708119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:06.715773 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.011 seconds
[0m16:45:06.718149 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.010 seconds
[0m16:45:06.719518 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:45:06.719994 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.013 seconds
[0m16:45:06.722495 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:45:06.726781 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:45:06.731404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:45:06.732137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:45:06.732730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:45:06.739416 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:45:06.743184 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:45:06.746833 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:45:06.748828 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:45:06.750653 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:45:06.752345 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:45:06.754310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:06.756215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:06.757887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:06.765301 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:45:06.766875 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:45:06.768157 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:45:06.768892 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:45:06.769899 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:45:06.770919 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:45:06.773438 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:45:06.775251 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:45:06.775972 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:45:06.777026 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:45:06.781027 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:45:06.784301 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:45:06.785372 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:45:06.788185 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:45:06.788961 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:45:06.791890 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:45:06.794300 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:45:06.798459 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:45:06.806500 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:06.808897 [debug] [MainThread]: On master: BEGIN
[0m16:45:06.810505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:06.818124 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:45:06.819970 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:06.822116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:06.829194 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:45:06.832353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4737555090>]}
[0m16:45:06.833882 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:06.836099 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:06.837947 [debug] [MainThread]: On master: BEGIN
[0m16:45:06.840177 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:45:06.841820 [debug] [MainThread]: On master: COMMIT
[0m16:45:06.843463 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:06.844891 [debug] [MainThread]: On master: COMMIT
[0m16:45:06.846910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:06.848295 [debug] [MainThread]: On master: Close
[0m16:45:06.857294 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:45:06.857921 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:45:06.859655 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:45:06.862013 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:45:06.864395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_historical_klines)
[0m16:45:06.866340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_realtime_klines)
[0m16:45:06.867700 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:45:06.869539 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:45:06.878932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:45:06.883134 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:06.895607 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:45:06.896465 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:45:06.939358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:45:06.940125 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:06.951184 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:06.953199 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:45:06.954019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:45:06.955150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:06.956633 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:45:06.959578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:06.963052 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:45:06.964634 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:06.966353 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:45:06.967020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:45:06.969499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:45:06.971301 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:45:06.973013 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:45:06.982580 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:06.983165 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:45:06.984850 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:45:06.989362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:45:06.992041 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:06.992765 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:45:06.997735 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:07.000368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:07.001143 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:45:07.005596 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:45:07.007834 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:07.009120 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:45:07.030836 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:45:07.032497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:07.034165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:07.037208 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:45:07.039059 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:45:07.040884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:45:07.043646 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:45:07.044301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:45:07.046287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:07.054019 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:45:07.057964 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:45:07.065456 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:45:07.067412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:45:07.069216 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:45:07.070512 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:45:07.074868 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:45:07.075676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:45:07.078907 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:45:07.081528 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:45:07.085051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47301306d0>]}
[0m16:45:07.086030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4730145750>]}
[0m16:45:07.087696 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.22s]
[0m16:45:07.089411 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.22s]
[0m16:45:07.090490 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:45:07.092351 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:45:07.095955 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:45:07.097541 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:45:07.099370 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:45:07.101043 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:45:07.114031 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.128453 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:45:07.181436 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.183944 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp164507161430"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:45:07.186568 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:07.204244 [debug] [Thread-4 (]: SQL status: SELECT 354 in 0.018 seconds
[0m16:45:07.224598 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.226903 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:45:07.229599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m16:45:07.231305 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.233564 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp164507161430'
        
      order by ordinal_position

  
[0m16:45:07.244590 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.009 seconds
[0m16:45:07.253613 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.256098 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:45:07.261057 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:45:07.271689 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.274095 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:45:07.279161 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:45:07.305432 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.320584 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.322575 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp164507161430" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:45:07.327404 [debug] [Thread-4 (]: SQL status: MERGE 354 in 0.003 seconds
[0m16:45:07.330718 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:45:07.332513 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:45:07.334132 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:45:07.337389 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:07.340096 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:45:07.342403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47301a9450>]}
[0m16:45:07.344332 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 354[0m in 0.24s]
[0m16:45:07.345994 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:45:07.348465 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:45:07.350155 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:45:07.352170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:45:07.353888 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:45:07.357751 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.371943 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:45:07.385858 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.399981 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.401816 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:45:07.403505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:07.409872 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:45:07.411362 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.413172 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:45:07.422940 [debug] [Thread-2 (]: SQL status: SELECT 75 in 0.008 seconds
[0m16:45:07.430583 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.432524 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:45:07.434655 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:07.438902 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.440428 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:45:07.442645 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:07.445475 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:45:07.447061 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.448552 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:45:07.451397 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:07.455914 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:45:07.460304 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:45:07.462153 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:45:07.466564 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:45:07.469399 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:45:07.471415 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f75d14e-48cb-4b1b-b9ea-0278b1b4d317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4732219810>]}
[0m16:45:07.473294 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 75[0m in 0.12s]
[0m16:45:07.475466 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:45:07.478849 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:07.480199 [debug] [MainThread]: On master: BEGIN
[0m16:45:07.481924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:07.488185 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:45:07.489819 [debug] [MainThread]: On master: COMMIT
[0m16:45:07.491653 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:07.493297 [debug] [MainThread]: On master: COMMIT
[0m16:45:07.495228 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:07.497085 [debug] [MainThread]: On master: Close
[0m16:45:07.499005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:07.500290 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:45:07.502078 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m16:45:07.503518 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:45:07.505089 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:45:07.506325 [info ] [MainThread]: 
[0m16:45:07.507988 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m16:45:07.509990 [debug] [MainThread]: Command end result
[0m16:45:07.557042 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:45:07.565081 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:45:07.578707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:45:07.580863 [info ] [MainThread]: 
[0m16:45:07.583119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:07.584753 [info ] [MainThread]: 
[0m16:45:07.586587 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:45:07.589491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0166779, "process_in_blocks": "144", "process_kernel_time": 0.369672, "process_mem_max_rss": "135732", "process_out_blocks": "0", "process_user_time": 2.977921}
[0m16:45:07.591214 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:07.591067 after 2.02 seconds
[0m16:45:07.593033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47360bed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47360ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473a7e7850>]}
[0m16:45:07.594953 [debug] [MainThread]: Flushing usage events
[0m16:45:09.794734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:18.777162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227fa7c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227fb5e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227fad3b90>]}


============================== 16:45:18.784486 | 26c7cd9b-5a16-4d81-af90-8b1c22b503fa ==============================
[0m16:45:18.784486 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:45:18.786534 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'debug': 'False', 'log_path': '/opt/airflow/dbt_crypto/logs', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True'}
[0m16:45:19.004939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26c7cd9b-5a16-4d81-af90-8b1c22b503fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22821de710>]}
[0m16:45:19.066770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26c7cd9b-5a16-4d81-af90-8b1c22b503fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22823ac4d0>]}
[0m16:45:19.069252 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:45:19.129472 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:45:19.437662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:19.439765 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:45:19.441569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:19.487654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c7cd9b-5a16-4d81-af90-8b1c22b503fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227e5e8810>]}
[0m16:45:19.634353 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:45:19.640232 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:45:19.734659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c7cd9b-5a16-4d81-af90-8b1c22b503fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227e986250>]}
[0m16:45:19.737203 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:45:19.739198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c7cd9b-5a16-4d81-af90-8b1c22b503fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228067ae90>]}
[0m16:45:19.742413 [info ] [MainThread]: 
[0m16:45:19.744211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:19.745833 [info ] [MainThread]: 
[0m16:45:19.747776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:19.753889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:45:19.754719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:45:19.756060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:45:19.793519 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:45:19.794064 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:45:19.794570 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:45:19.795987 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:45:19.797526 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:45:19.799516 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:45:19.801156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:19.803095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:19.804561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:19.810879 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:45:19.811995 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:45:19.813096 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:45:19.813663 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:45:19.815218 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:45:19.816843 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:45:19.817725 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:45:19.818799 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:45:19.820241 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:45:19.825149 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:45:19.825977 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m16:45:19.827440 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:45:19.828648 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:45:19.831235 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:45:19.833548 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:45:19.835626 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:45:19.837343 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:45:19.839003 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:45:19.848986 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.850798 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.852360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:19.858308 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:45:19.860154 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.861540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:19.867216 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m16:45:19.869850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c7cd9b-5a16-4d81-af90-8b1c22b503fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22824d0190>]}
[0m16:45:19.871990 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:19.874039 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.876160 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.878002 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:45:19.879780 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.881321 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.882713 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.884998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.886870 [debug] [MainThread]: On master: Close
[0m16:45:19.893796 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:45:19.894511 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:45:19.895032 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:45:19.895600 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:45:19.896596 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:45:19.898628 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:45:19.900484 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:45:19.902082 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:45:19.904053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:45:19.906216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:45:19.908719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:45:19.910686 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:45:19.912437 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:45:19.914317 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:45:19.915838 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:45:19.917694 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:45:19.935243 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:45:19.941457 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:45:19.946691 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:45:19.952468 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:45:19.961552 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:45:19.962350 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:45:19.963443 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:45:19.969304 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:45:19.991065 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:45:19.994060 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:45:20.000651 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:45:20.004652 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:45:20.013590 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:45:20.014444 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:45:20.015474 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:45:20.015905 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:45:20.017401 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:45:20.018291 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:45:20.020180 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:45:20.022257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:20.024056 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:45:20.025779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:20.027288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:20.030603 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:20.035094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:45:20.037524 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:45:20.038120 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:45:20.039654 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:45:20.040369 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:45:20.041229 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:45:20.042312 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:45:20.044193 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:45:20.046152 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:45:20.047661 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:45:20.050321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:45:20.050792 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:45:20.053173 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:45:20.053678 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:45:20.057826 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:45:20.060555 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:45:20.062580 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:45:20.064127 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:45:20.066540 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:45:20.068868 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:45:20.071371 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:45:20.073434 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:45:20.074989 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.17s]
[0m16:45:20.076424 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:45:20.077818 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:45:20.079460 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.17s]
[0m16:45:20.080493 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:45:20.082338 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.18s]
[0m16:45:20.083880 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.17s]
[0m16:45:20.085147 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:45:20.087290 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:45:20.089124 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:45:20.090750 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:45:20.092491 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:45:20.094228 [info ] [Thread-1 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:45:20.098572 [info ] [Thread-3 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:45:20.100083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:45:20.102061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:45:20.103370 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:45:20.105183 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:45:20.110826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:45:20.116938 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:45:20.129924 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:45:20.134559 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:45:20.135099 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:45:20.140300 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:45:20.147689 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:45:20.149227 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:45:20.149784 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:45:20.150959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:20.152229 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:45:20.155628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:20.158061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:45:20.159761 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:45:20.161313 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:45:20.162637 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:45:20.164064 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:45:20.164746 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:45:20.166003 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:45:20.168422 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:45:20.171049 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:45:20.171715 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:45:20.174267 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:45:20.177089 [info ] [Thread-1 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.08s]
[0m16:45:20.178580 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:45:20.179891 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:45:20.181933 [info ] [Thread-3 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.08s]
[0m16:45:20.184788 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:45:20.187835 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:20.189943 [debug] [MainThread]: On master: BEGIN
[0m16:45:20.191328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:20.197783 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:45:20.199567 [debug] [MainThread]: On master: COMMIT
[0m16:45:20.200828 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:20.202335 [debug] [MainThread]: On master: COMMIT
[0m16:45:20.204241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:20.206141 [debug] [MainThread]: On master: Close
[0m16:45:20.207597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:20.209348 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:45:20.210616 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:45:20.212190 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:45:20.213718 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:45:20.214800 [info ] [MainThread]: 
[0m16:45:20.216475 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:45:20.218863 [debug] [MainThread]: Command end result
[0m16:45:20.267561 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:45:20.276075 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:45:20.290100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:45:20.292548 [info ] [MainThread]: 
[0m16:45:20.294773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:20.296885 [info ] [MainThread]: 
[0m16:45:20.298780 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:45:20.301167 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6273885, "process_in_blocks": "1296", "process_kernel_time": 0.283455, "process_mem_max_rss": "134036", "process_out_blocks": "0", "process_user_time": 2.782059}
[0m16:45:20.303276 [debug] [MainThread]: Command `dbt test` succeeded at 16:45:20.303000 after 1.63 seconds
[0m16:45:20.305260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227fd4fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f227fc89f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22840ff7d0>]}
[0m16:45:20.307119 [debug] [MainThread]: Flushing usage events
[0m16:45:21.840422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:05.807155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c59428450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c59428a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c59428c50>]}


============================== 16:50:05.815018 | f4c720d9-b266-439f-a953-8d401a2b451b ==============================
[0m16:50:05.815018 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:50:05.817253 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'empty': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs'}
[0m16:50:06.087080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c59337a50>]}
[0m16:50:06.184577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5be1e550>]}
[0m16:50:06.187113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:50:06.286026 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:50:06.747829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:06.750466 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:50:06.752197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:06.829634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5942b510>]}
[0m16:50:06.964122 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:50:06.977610 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:50:07.024027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c58b62090>]}
[0m16:50:07.026184 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:50:07.027604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c57bfdc10>]}
[0m16:50:07.031646 [info ] [MainThread]: 
[0m16:50:07.033135 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:07.034856 [info ] [MainThread]: 
[0m16:50:07.039500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:50:07.051196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:50:07.500975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:50:07.502765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:50:07.552827 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:50:07.553406 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:50:07.553874 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:50:07.555741 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:50:07.557745 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:50:07.559592 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:50:07.561710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:07.563349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:07.564835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:07.590111 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.025 seconds
[0m16:50:07.590679 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.027 seconds
[0m16:50:07.591182 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.030 seconds
[0m16:50:07.593474 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:50:07.595670 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:50:07.598160 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:50:07.603599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:50:07.604517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:50:07.605296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:50:07.612395 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:50:07.615582 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:50:07.618907 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:50:07.620716 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:50:07.622361 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:50:07.623698 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:50:07.625413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:07.627568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:07.628859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:07.635320 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:50:07.636644 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:50:07.637436 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:50:07.638289 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:50:07.638989 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:50:07.640401 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:50:07.641779 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:50:07.643517 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:50:07.646422 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:50:07.649599 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:50:07.652654 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:50:07.653257 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:50:07.654699 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m16:50:07.655440 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:50:07.658095 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:50:07.662521 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:50:07.666900 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:50:07.668540 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:50:07.677849 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:07.679414 [debug] [MainThread]: On master: BEGIN
[0m16:50:07.680534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:07.687856 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:50:07.689635 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:07.690991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:07.698429 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:50:07.701005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c59558250>]}
[0m16:50:07.703263 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:07.704881 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:07.706086 [debug] [MainThread]: On master: BEGIN
[0m16:50:07.708186 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:50:07.710469 [debug] [MainThread]: On master: COMMIT
[0m16:50:07.711802 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:07.713276 [debug] [MainThread]: On master: COMMIT
[0m16:50:07.715120 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:50:07.716594 [debug] [MainThread]: On master: Close
[0m16:50:07.725546 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:50:07.726304 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:50:07.727891 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:50:07.729794 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:50:07.731622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_historical_klines)
[0m16:50:07.733489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_realtime_klines)
[0m16:50:07.735219 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:50:07.736582 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:50:07.745551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.749957 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.759891 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:50:07.761453 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:50:07.823614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.824141 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.833164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.834072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.835902 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:50:07.838231 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:50:07.840430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:07.842401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:07.849484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:50:07.850922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:50:07.851857 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.853469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.855037 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:50:07.857209 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:50:07.862309 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:50:07.869927 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:50:07.872117 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.877407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.880092 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:50:07.882430 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:50:07.885599 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:50:07.887358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:50:07.891549 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.896845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.899266 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:50:07.901607 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:50:07.904108 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:50:07.905682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:50:07.923439 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:50:07.925361 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:50:07.927926 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.930352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.932444 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:50:07.934186 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:50:07.937701 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:50:07.938168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:50:07.945301 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:50:07.948711 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:50:07.956095 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:50:07.957830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:50:07.959278 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:50:07.960658 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:50:07.964977 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:50:07.966223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:50:07.969392 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:50:07.972212 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:50:07.975992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5450e510>]}
[0m16:50:07.977059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c556fad90>]}
[0m16:50:07.978742 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.24s]
[0m16:50:07.980599 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.25s]
[0m16:50:07.982896 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:50:07.984650 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:50:07.988617 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:50:07.990138 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:50:07.992398 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:50:07.994144 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:50:08.005005 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.019685 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:50:08.065825 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.067980 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp165008048793"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:50:08.069528 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:50:08.083022 [debug] [Thread-4 (]: SQL status: SELECT 369 in 0.013 seconds
[0m16:50:08.097358 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.099153 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:50:08.100826 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:50:08.102226 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.103640 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp165008048793'
        
      order by ordinal_position

  
[0m16:50:08.114156 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.009 seconds
[0m16:50:08.121094 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.123249 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:50:08.128166 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:50:08.139518 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.141478 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:50:08.146364 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:50:08.174602 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.191040 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.193310 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp165008048793" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:50:08.199682 [debug] [Thread-4 (]: SQL status: MERGE 369 in 0.004 seconds
[0m16:50:08.204149 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:50:08.206364 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:50:08.209447 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:50:08.213730 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:50:08.216913 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:50:08.219288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c545b6850>]}
[0m16:50:08.221461 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 369[0m in 0.23s]
[0m16:50:08.223546 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:50:08.229189 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:50:08.231388 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:50:08.233326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:50:08.235344 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:50:08.241131 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.257541 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:50:08.272998 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.289144 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.291424 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:50:08.293229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:08.299654 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:50:08.301526 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.303334 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:50:08.314020 [debug] [Thread-2 (]: SQL status: SELECT 78 in 0.008 seconds
[0m16:50:08.323545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.325824 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:50:08.328590 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:50:08.334219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.336020 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:50:08.338440 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:50:08.341636 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:50:08.343372 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.345372 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:50:08.348410 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:50:08.352753 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:50:08.357861 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:50:08.360001 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:50:08.364591 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:50:08.368039 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:50:08.370146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c720d9-b266-439f-a953-8d401a2b451b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c545cfc50>]}
[0m16:50:08.372371 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 78[0m in 0.14s]
[0m16:50:08.374441 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:50:08.379312 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:08.381331 [debug] [MainThread]: On master: BEGIN
[0m16:50:08.383248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:08.391520 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:50:08.393337 [debug] [MainThread]: On master: COMMIT
[0m16:50:08.394901 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:08.396523 [debug] [MainThread]: On master: COMMIT
[0m16:50:08.398475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:50:08.400271 [debug] [MainThread]: On master: Close
[0m16:50:08.402580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:08.404537 [debug] [MainThread]: Connection 'list_crypto_analytics_public_gold' was properly closed.
[0m16:50:08.406502 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:50:08.408541 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:50:08.410640 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:50:08.412437 [info ] [MainThread]: 
[0m16:50:08.415356 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m16:50:08.417826 [debug] [MainThread]: Command end result
[0m16:50:08.481105 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:50:08.493067 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:50:08.509643 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:50:08.511867 [info ] [MainThread]: 
[0m16:50:08.514108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:08.516121 [info ] [MainThread]: 
[0m16:50:08.517772 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:50:08.523670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.856376, "process_in_blocks": "54696", "process_kernel_time": 0.516325, "process_mem_max_rss": "127952", "process_out_blocks": "0", "process_user_time": 3.316401}
[0m16:50:08.526699 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:08.526084 after 2.86 seconds
[0m16:50:08.529119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c594804d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c55798350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5db737d0>]}
[0m16:50:08.531193 [debug] [MainThread]: Flushing usage events
[0m16:50:10.265500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:18.252321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab9c70750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabc643ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab9cbff10>]}


============================== 16:50:18.259018 | 041ae908-3f68-4763-a309-29c9165981e7 ==============================
[0m16:50:18.259018 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:50:18.260965 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': '/opt/airflow/dbt_crypto/logs', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True'}
[0m16:50:18.509663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041ae908-3f68-4763-a309-29c9165981e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab9bafad0>]}
[0m16:50:18.579828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041ae908-3f68-4763-a309-29c9165981e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabc662710>]}
[0m16:50:18.582208 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:50:18.643477 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:50:18.940047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:18.941943 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:50:18.943332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:18.988702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041ae908-3f68-4763-a309-29c9165981e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab87648d0>]}
[0m16:50:19.097322 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:50:19.105852 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:50:19.240480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041ae908-3f68-4763-a309-29c9165981e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab93ef0d0>]}
[0m16:50:19.242737 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:50:19.244483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041ae908-3f68-4763-a309-29c9165981e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab9d03610>]}
[0m16:50:19.247973 [info ] [MainThread]: 
[0m16:50:19.250158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:19.251411 [info ] [MainThread]: 
[0m16:50:19.252984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:50:19.261408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:50:19.262695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:50:19.263896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:50:19.306804 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:50:19.307390 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:50:19.307893 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:50:19.309388 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:50:19.310890 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:50:19.313072 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:50:19.314494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:19.316370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:19.318193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:19.325375 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:50:19.327407 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:50:19.328091 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:50:19.329032 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:50:19.330839 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:50:19.332753 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:50:19.334265 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:50:19.335713 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:50:19.337200 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:50:19.342939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:50:19.343895 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:50:19.347219 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:50:19.350103 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:50:19.350821 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:50:19.352473 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:50:19.353538 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:50:19.355640 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:50:19.360768 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:50:19.367526 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.369198 [debug] [MainThread]: On master: BEGIN
[0m16:50:19.370825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:19.377523 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:50:19.379151 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.380834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:19.387236 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:50:19.390070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041ae908-3f68-4763-a309-29c9165981e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab9344750>]}
[0m16:50:19.391572 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:19.393170 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.394963 [debug] [MainThread]: On master: BEGIN
[0m16:50:19.397336 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:50:19.399124 [debug] [MainThread]: On master: COMMIT
[0m16:50:19.401053 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.402905 [debug] [MainThread]: On master: COMMIT
[0m16:50:19.404544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:50:19.406118 [debug] [MainThread]: On master: Close
[0m16:50:19.414730 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:50:19.415348 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:50:19.415970 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:50:19.416467 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:50:19.417967 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:50:19.419747 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:50:19.421991 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:50:19.423545 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:50:19.425905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:50:19.428448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:50:19.430284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:50:19.432132 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:50:19.433927 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:50:19.435767 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:50:19.437536 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:50:19.439042 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:50:19.457742 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:50:19.464773 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:50:19.470375 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:50:19.476463 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:50:19.487149 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:50:19.489019 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:50:19.495336 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:50:19.505975 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:50:19.511177 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:50:19.515342 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:50:19.521043 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:50:19.525367 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:50:19.537521 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:50:19.538858 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:50:19.540061 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:50:19.540772 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:50:19.541528 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:50:19.542636 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:50:19.545141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:50:19.547439 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:50:19.549567 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:50:19.551816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:19.556415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:19.558389 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:50:19.559491 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m16:50:19.565531 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:50:19.566655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:50:19.567768 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:50:19.569720 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:50:19.570393 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:50:19.573025 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:50:19.573860 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:50:19.574660 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:50:19.575643 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:50:19.578548 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:50:19.583780 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:50:19.584600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:50:19.585861 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:50:19.587851 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:50:19.590141 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:50:19.592932 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:50:19.596351 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:50:19.597312 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:50:19.598181 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.17s]
[0m16:50:19.600070 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:50:19.602815 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:50:19.605920 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:50:19.607952 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:50:19.609954 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.18s]
[0m16:50:19.611338 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:50:19.612955 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:50:19.614676 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:50:19.616378 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:50:19.618664 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.19s]
[0m16:50:19.620929 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.19s]
[0m16:50:19.622315 [info ] [Thread-3 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:50:19.624017 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:50:19.625885 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:50:19.627833 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:50:19.629381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:50:19.631259 [info ] [Thread-1 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:50:19.634745 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:50:19.636815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:50:19.643067 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:50:19.645242 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:50:19.652655 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:50:19.661649 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:50:19.666068 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:50:19.666645 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:50:19.672754 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:50:19.680696 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:50:19.682970 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:50:19.683761 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:50:19.685108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:50:19.687202 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:50:19.690644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:19.693620 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m16:50:19.695169 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:50:19.696909 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:50:19.697898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:50:19.699645 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:50:19.700112 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:50:19.701533 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:50:19.704001 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:50:19.706883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:50:19.707781 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:50:19.709738 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:50:19.712042 [info ] [Thread-3 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.08s]
[0m16:50:19.713407 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:50:19.715170 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:50:19.717265 [info ] [Thread-1 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.08s]
[0m16:50:19.721031 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:50:19.724945 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.727243 [debug] [MainThread]: On master: BEGIN
[0m16:50:19.729340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:19.735847 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:50:19.737836 [debug] [MainThread]: On master: COMMIT
[0m16:50:19.739793 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:19.741575 [debug] [MainThread]: On master: COMMIT
[0m16:50:19.743568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:50:19.745572 [debug] [MainThread]: On master: Close
[0m16:50:19.747550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:19.749470 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:50:19.750719 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:50:19.752208 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4' was properly closed.
[0m16:50:19.753992 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m16:50:19.755763 [info ] [MainThread]: 
[0m16:50:19.757641 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:50:19.760216 [debug] [MainThread]: Command end result
[0m16:50:19.808677 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:50:19.816397 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:50:19.829775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:50:19.831917 [info ] [MainThread]: 
[0m16:50:19.833817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:19.835407 [info ] [MainThread]: 
[0m16:50:19.837316 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:50:19.839302 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6719931, "process_in_blocks": "1272", "process_kernel_time": 0.31864, "process_mem_max_rss": "133836", "process_out_blocks": "0", "process_user_time": 2.877725}
[0m16:50:19.840705 [debug] [MainThread]: Command `dbt test` succeeded at 16:50:19.840574 after 1.67 seconds
[0m16:50:19.841973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe321b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe3232d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe323150>]}
[0m16:50:19.843755 [debug] [MainThread]: Flushing usage events
[0m16:50:21.462666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:11.164150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1840692b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18406927d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1840693350>]}


============================== 16:55:11.172703 | 11e499e5-4dd7-4dd7-9041-96e2ae8a4362 ==============================
[0m16:55:11.172703 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:55:11.174848 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'introspect': 'True', 'profiles_dir': '.', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m16:55:11.451517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18405c7890>]}
[0m16:55:11.517180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1843062150>]}
[0m16:55:11.519515 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:55:11.588943 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:55:11.998618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:12.010087 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:55:12.019551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:12.161030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183f1af910>]}
[0m16:55:12.472909 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:55:12.513854 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:55:12.956664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183fd9aa50>]}
[0m16:55:12.971376 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:55:12.981522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183f10c410>]}
[0m16:55:13.000604 [info ] [MainThread]: 
[0m16:55:13.007238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:13.014961 [info ] [MainThread]: 
[0m16:55:13.035716 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:13.096338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:55:17.287223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:55:17.288704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m16:55:17.401301 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:55:17.404323 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:55:17.405058 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m16:55:17.406629 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:55:17.409297 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:55:17.411194 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:55:17.414144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:17.418265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:17.423391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:17.453679 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.040 seconds
[0m16:55:17.454836 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.032 seconds
[0m16:55:17.461958 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:55:17.467876 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:55:17.473014 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.055 seconds
[0m16:55:17.481987 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m16:55:17.490443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m16:55:17.491993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m16:55:17.493392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m16:55:17.507091 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:55:17.510946 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:55:17.516171 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:55:17.520959 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:55:17.524827 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:55:17.527639 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:55:17.529307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:17.531150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:17.533596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:17.547100 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m16:55:17.549566 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m16:55:17.550824 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:55:17.552213 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:55:17.554599 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:55:17.558355 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:55:17.562527 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:55:17.567125 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:55:17.570372 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:55:17.583033 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:55:17.584394 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m16:55:17.586315 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m16:55:17.589838 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:55:17.593599 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:55:17.597984 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:55:17.602790 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:55:17.605677 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:55:17.609395 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:55:17.632539 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:17.634745 [debug] [MainThread]: On master: BEGIN
[0m16:55:17.637089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:17.656276 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:55:17.659412 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:17.661874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:17.690908 [debug] [MainThread]: SQL status: SELECT 2 in 0.027 seconds
[0m16:55:17.695908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183fd57990>]}
[0m16:55:17.699754 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:17.705374 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:17.711613 [debug] [MainThread]: On master: BEGIN
[0m16:55:17.714822 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:55:17.717182 [debug] [MainThread]: On master: COMMIT
[0m16:55:17.721258 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:17.725210 [debug] [MainThread]: On master: COMMIT
[0m16:55:17.731903 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:55:17.735806 [debug] [MainThread]: On master: Close
[0m16:55:17.790393 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m16:55:17.791567 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m16:55:17.794166 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m16:55:17.796341 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m16:55:17.800397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_historical_klines)
[0m16:55:17.805119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m16:55:17.808421 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m16:55:17.811043 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m16:55:17.827327 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m16:55:17.833686 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:17.852744 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m16:55:17.861850 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m16:55:17.997798 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.001058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.014345 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.016237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.018978 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m16:55:18.021280 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m16:55:18.023243 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:18.026028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:18.040434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:55:18.042384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:55:18.043034 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.044584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.047127 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m16:55:18.050908 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m16:55:18.062915 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:55:18.064056 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:55:18.080149 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.086371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.090410 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m16:55:18.093856 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m16:55:18.097764 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:55:18.098463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:18.104938 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.116562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.118396 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m16:55:18.121410 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m16:55:18.129655 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:55:18.132941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:18.168122 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:55:18.173008 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:55:18.176381 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.180073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.182549 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m16:55:18.184398 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m16:55:18.212035 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m16:55:18.214097 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m16:55:18.228458 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m16:55:18.239318 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m16:55:18.251302 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m16:55:18.255758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m16:55:18.259916 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m16:55:18.262535 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m16:55:18.274011 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m16:55:18.275830 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m16:55:18.282135 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m16:55:18.285351 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m16:55:18.293752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183c8e3a90>]}
[0m16:55:18.297103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183c81a350>]}
[0m16:55:18.299875 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.49s]
[0m16:55:18.303135 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.50s]
[0m16:55:18.306817 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m16:55:18.311331 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m16:55:18.318393 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m16:55:18.320301 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m16:55:18.321954 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m16:55:18.323968 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m16:55:18.343780 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.364236 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m16:55:18.424772 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.427487 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp165518398971"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m16:55:18.430069 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:55:18.471481 [debug] [Thread-4 (]: SQL status: SELECT 378 in 0.041 seconds
[0m16:55:18.498348 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.501925 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m16:55:18.504839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m16:55:18.506629 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.509772 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp165518398971'
        
      order by ordinal_position

  
[0m16:55:18.550760 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.036 seconds
[0m16:55:18.567634 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.571687 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:55:18.583078 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.007 seconds
[0m16:55:18.605991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.608797 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m16:55:18.619966 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.007 seconds
[0m16:55:18.662078 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.692561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.696209 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp165518398971" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m16:55:18.704187 [debug] [Thread-4 (]: SQL status: MERGE 378 in 0.005 seconds
[0m16:55:18.714198 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:55:18.716803 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m16:55:18.719413 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m16:55:18.726658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m16:55:18.735356 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m16:55:18.738609 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183c84c3d0>]}
[0m16:55:18.741422 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 378[0m in 0.42s]
[0m16:55:18.745498 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m16:55:18.754430 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m16:55:18.757728 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m16:55:18.760214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m16:55:18.763285 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m16:55:18.777141 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.797850 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m16:55:18.824712 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.845373 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.848300 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m16:55:18.850576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:18.865321 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:55:18.868173 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.869952 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m16:55:18.889640 [debug] [Thread-2 (]: SQL status: SELECT 81 in 0.018 seconds
[0m16:55:18.907645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.910919 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m16:55:18.915163 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:55:18.926208 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.928439 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m16:55:18.931539 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:18.942461 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:55:18.946398 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.948538 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m16:55:18.952894 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:55:18.960497 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m16:55:18.968984 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m16:55:18.971231 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m16:55:18.982538 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m16:55:18.987159 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m16:55:18.990026 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e499e5-4dd7-4dd7-9041-96e2ae8a4362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183f1743d0>]}
[0m16:55:18.993638 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 81[0m in 0.23s]
[0m16:55:18.998386 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m16:55:19.005610 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:19.007724 [debug] [MainThread]: On master: BEGIN
[0m16:55:19.010035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:19.025209 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:55:19.028477 [debug] [MainThread]: On master: COMMIT
[0m16:55:19.030500 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:19.034380 [debug] [MainThread]: On master: COMMIT
[0m16:55:19.039846 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:55:19.043495 [debug] [MainThread]: On master: Close
[0m16:55:19.046960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:19.049123 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m16:55:19.051478 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m16:55:19.055296 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m16:55:19.058685 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m16:55:19.063837 [info ] [MainThread]: 
[0m16:55:19.066070 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 6.04 seconds (6.04s).
[0m16:55:19.069290 [debug] [MainThread]: Command end result
[0m16:55:19.150335 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:55:19.168678 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:55:19.190661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:55:19.194319 [info ] [MainThread]: 
[0m16:55:19.201320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:19.204192 [info ] [MainThread]: 
[0m16:55:19.206747 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:55:19.222381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.200502, "process_in_blocks": "131064", "process_kernel_time": 2.190004, "process_mem_max_rss": "127296", "process_out_blocks": "0", "process_user_time": 5.16671}
[0m16:55:19.225509 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:19.224687 after 8.20 seconds
[0m16:55:19.228459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1844dc3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1840983f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1844d21b50>]}
[0m16:55:19.231357 [debug] [MainThread]: Flushing usage events
[0m16:55:21.436156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:37.956547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16321ac790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16321ac2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16321ac990>]}


============================== 16:55:37.971200 | bc865a5b-e64f-45bb-bd87-d39cc60ad558 ==============================
[0m16:55:37.971200 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:55:37.974915 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'profiles_dir': '.', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs'}
[0m16:55:38.528549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc865a5b-e64f-45bb-bd87-d39cc60ad558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1632206090>]}
[0m16:55:38.706150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc865a5b-e64f-45bb-bd87-d39cc60ad558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634abe490>]}
[0m16:55:38.831368 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:55:39.373574 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:55:40.150978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:40.154701 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:55:40.157283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:40.335110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc865a5b-e64f-45bb-bd87-d39cc60ad558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630d5fa10>]}
[0m16:55:40.535856 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:55:40.555749 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:55:41.173951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc865a5b-e64f-45bb-bd87-d39cc60ad558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16315feb50>]}
[0m16:55:41.176645 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m16:55:41.178855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc865a5b-e64f-45bb-bd87-d39cc60ad558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630d5fc10>]}
[0m16:55:41.188688 [info ] [MainThread]: 
[0m16:55:41.194125 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:41.198410 [info ] [MainThread]: 
[0m16:55:41.202529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:41.224146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m16:55:41.226525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m16:55:41.228115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m16:55:41.391296 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:55:41.392176 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:55:41.392919 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:55:41.394770 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m16:55:41.398762 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m16:55:41.404359 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m16:55:41.408737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:41.411124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:41.413650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:41.429836 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:55:41.431704 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:55:41.432863 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m16:55:41.433906 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m16:55:41.435616 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m16:55:41.437779 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:55:41.440614 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m16:55:41.445830 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:55:41.451311 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:55:41.455168 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:55:41.464077 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m16:55:41.465107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m16:55:41.465944 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:55:41.468252 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m16:55:41.474821 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m16:55:41.477798 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m16:55:41.485206 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m16:55:41.487052 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m16:55:41.506248 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:41.508101 [debug] [MainThread]: On master: BEGIN
[0m16:55:41.510002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:41.524320 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:55:41.526376 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:41.528113 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:41.537150 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m16:55:41.541548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc865a5b-e64f-45bb-bd87-d39cc60ad558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16321adc50>]}
[0m16:55:41.543956 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:41.546422 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:41.548956 [debug] [MainThread]: On master: BEGIN
[0m16:55:41.553942 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:55:41.558702 [debug] [MainThread]: On master: COMMIT
[0m16:55:41.561326 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:41.563554 [debug] [MainThread]: On master: COMMIT
[0m16:55:41.565283 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:55:41.566966 [debug] [MainThread]: On master: Close
[0m16:55:41.581342 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:55:41.582200 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:55:41.583088 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:55:41.583999 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:55:41.585118 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m16:55:41.586873 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m16:55:41.588433 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m16:55:41.592999 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m16:55:41.597903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m16:55:41.602131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m16:55:41.604914 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m16:55:41.608877 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m16:55:41.611461 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:55:41.615495 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:55:41.621644 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:55:41.625798 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:55:41.676653 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:55:41.679185 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:55:41.691272 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:55:41.710655 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:55:41.737036 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:55:41.740733 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:55:41.746233 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:55:41.759640 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:55:41.787145 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:55:41.790131 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:55:41.798518 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:55:41.808463 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:55:41.883127 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:55:41.884083 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:55:41.885945 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m16:55:41.887209 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:55:41.888102 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:55:41.890527 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m16:55:41.896283 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:55:41.901165 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m16:55:41.904445 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m16:55:41.906751 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:41.911302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:41.915858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:41.922368 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m16:55:41.928866 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m16:55:41.930527 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m16:55:41.931939 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m16:55:41.935163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:55:41.939113 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m16:55:41.942419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m16:55:41.947105 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m16:55:41.947844 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:55:41.950217 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:55:41.952940 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m16:55:41.958869 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m16:55:41.971109 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m16:55:41.974316 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:55:41.976409 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:55:41.985483 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:55:41.987724 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m16:55:41.992499 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m16:55:41.993518 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:55:41.997453 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m16:55:42.003639 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.39s]
[0m16:55:42.009249 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m16:55:42.012419 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m16:55:42.015576 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m16:55:42.018302 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m16:55:42.025087 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.42s]
[0m16:55:42.030303 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m16:55:42.032795 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.44s]
[0m16:55:42.035980 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:55:42.039866 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m16:55:42.046573 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.44s]
[0m16:55:42.052541 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m16:55:42.054756 [info ] [Thread-4 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m16:55:42.057919 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:55:42.060132 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m16:55:42.067089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m16:55:42.072310 [info ] [Thread-2 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m16:55:42.076371 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:55:42.078880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m16:55:42.091867 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:55:42.093679 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:55:42.103228 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:55:42.116634 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:55:42.117911 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:55:42.124374 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:55:42.133249 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:55:42.147417 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:55:42.151949 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:55:42.153055 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m16:55:42.155239 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m16:55:42.157556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:42.160902 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:42.178508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:55:42.180639 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:55:42.181335 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m16:55:42.183837 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m16:55:42.188605 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:55:42.193121 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:55:42.197204 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:55:42.198721 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:55:42.201367 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m16:55:42.209775 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m16:55:42.214373 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m16:55:42.216394 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m16:55:42.218634 [info ] [Thread-2 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.14s]
[0m16:55:42.220621 [info ] [Thread-4 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.15s]
[0m16:55:42.222755 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m16:55:42.227049 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m16:55:42.237629 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:42.240335 [debug] [MainThread]: On master: BEGIN
[0m16:55:42.242033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:42.260009 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:55:42.262458 [debug] [MainThread]: On master: COMMIT
[0m16:55:42.264455 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:42.266795 [debug] [MainThread]: On master: COMMIT
[0m16:55:42.273339 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:55:42.279125 [debug] [MainThread]: On master: Close
[0m16:55:42.281710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:42.284384 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m16:55:42.287262 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m16:55:42.290929 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7' was properly closed.
[0m16:55:42.296148 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m16:55:42.300121 [info ] [MainThread]: 
[0m16:55:42.346570 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m16:55:42.350761 [debug] [MainThread]: Command end result
[0m16:55:42.446895 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m16:55:42.469848 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m16:55:42.505178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m16:55:42.507551 [info ] [MainThread]: 
[0m16:55:42.509927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:42.512274 [info ] [MainThread]: 
[0m16:55:42.513888 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:55:42.516910 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.7506075, "process_in_blocks": "18216", "process_kernel_time": 1.277055, "process_mem_max_rss": "130660", "process_out_blocks": "0", "process_user_time": 7.69348}
[0m16:55:42.519180 [debug] [MainThread]: Command `dbt test` succeeded at 16:55:42.519005 after 4.75 seconds
[0m16:55:42.521395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163247ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16366e3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16367931d0>]}
[0m16:55:42.523676 [debug] [MainThread]: Flushing usage events
[0m16:55:44.279370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:20.971750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f1414c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f1414c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f1414c410>]}


============================== 17:00:21.005425 | 13a133b1-716a-49cb-bd19-fd0283a03cfd ==============================
[0m17:00:21.005425 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:00:21.014471 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/opt/airflow/dbt_crypto/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager'}
[0m17:00:21.629307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f13b4b290>]}
[0m17:00:21.839194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f16b0eb90>]}
[0m17:00:21.870494 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:00:22.060442 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:00:22.717112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:22.722250 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:00:22.725273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:22.839237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f12ff7c50>]}
[0m17:00:23.101680 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m17:00:23.118625 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m17:00:23.195214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f12f554d0>]}
[0m17:00:23.201987 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m17:00:23.205033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f12b0d150>]}
[0m17:00:23.216937 [info ] [MainThread]: 
[0m17:00:23.222889 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:23.226931 [info ] [MainThread]: 
[0m17:00:23.231780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:23.253372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m17:00:23.454807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m17:00:23.458735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m17:00:23.609898 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m17:00:23.612972 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m17:00:23.614489 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m17:00:23.619015 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:00:23.622221 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:00:23.625041 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:00:23.630625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:23.636606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:23.641199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:23.664285 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.035 seconds
[0m17:00:23.670497 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m17:00:23.671923 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.035 seconds
[0m17:00:23.674491 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.033 seconds
[0m17:00:23.690753 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m17:00:23.695852 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m17:00:23.710562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m17:00:23.713552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m17:00:23.718369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m17:00:23.735061 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m17:00:23.746602 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m17:00:23.753793 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m17:00:23.758629 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m17:00:23.763396 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m17:00:23.767598 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m17:00:23.771253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:23.774358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:23.781587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:23.802721 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m17:00:23.804851 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m17:00:23.809046 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:00:23.810044 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m17:00:23.811991 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m17:00:23.815175 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m17:00:23.818603 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m17:00:23.824181 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m17:00:23.830513 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m17:00:23.845724 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m17:00:23.846603 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:00:23.848197 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:00:23.854222 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m17:00:23.859743 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m17:00:23.864835 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m17:00:23.869922 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m17:00:23.876272 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m17:00:23.881721 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m17:00:23.922450 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:23.926796 [debug] [MainThread]: On master: BEGIN
[0m17:00:23.929269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:23.945813 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:00:23.949911 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:23.954826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:23.972074 [debug] [MainThread]: SQL status: SELECT 2 in 0.012 seconds
[0m17:00:23.980626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f15d5b250>]}
[0m17:00:23.985172 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:23.990581 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:23.996857 [debug] [MainThread]: On master: BEGIN
[0m17:00:24.003312 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:00:24.006965 [debug] [MainThread]: On master: COMMIT
[0m17:00:24.010871 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:24.023848 [debug] [MainThread]: On master: COMMIT
[0m17:00:24.025957 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:24.027715 [debug] [MainThread]: On master: Close
[0m17:00:24.036593 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m17:00:24.037235 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m17:00:24.039481 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m17:00:24.041989 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m17:00:24.044125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_historical_klines)
[0m17:00:24.046725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now model.dbt_crypto.bronze_realtime_klines)
[0m17:00:24.050675 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m17:00:24.053079 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m17:00:24.066301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.071544 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.085078 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m17:00:24.093121 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m17:00:24.153133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.153945 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.166401 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.169210 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m17:00:24.170211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.171830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:24.173717 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m17:00:24.177918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:24.181122 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:00:24.183492 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.185863 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m17:00:24.187286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:00:24.190650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.195357 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m17:00:24.196177 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:00:24.206623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:00:24.207431 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.211824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.214685 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m17:00:24.216990 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m17:00:24.220120 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:24.222805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:24.228938 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.240584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.242474 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m17:00:24.245232 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m17:00:24.248617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:24.250889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:24.274396 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m17:00:24.276703 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m17:00:24.278987 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.281550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.284044 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m17:00:24.286484 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m17:00:24.290558 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:00:24.293386 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:24.313324 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m17:00:24.319941 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m17:00:24.339979 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:00:24.344716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:00:24.352337 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m17:00:24.356601 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m17:00:24.392445 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.024 seconds
[0m17:00:24.393453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m17:00:24.403780 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m17:00:24.408321 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m17:00:24.422535 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f188f1590>]}
[0m17:00:24.424627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f14274290>]}
[0m17:00:24.428987 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.37s]
[0m17:00:24.434886 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.38s]
[0m17:00:24.443410 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m17:00:24.449693 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m17:00:24.465150 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m17:00:24.471886 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m17:00:24.475635 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m17:00:24.479165 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m17:00:24.516777 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m17:00:24.543330 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m17:00:24.616583 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:24.622939 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp170024591199"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m17:00:24.627929 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:00:24.669162 [debug] [Thread-4 (]: SQL status: SELECT 378 in 0.041 seconds
[0m17:00:24.722222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:24.728355 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m17:00:24.732757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m17:00:24.744065 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:24.750538 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp170024591199'
        
      order by ordinal_position

  
[0m17:00:24.788910 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.033 seconds
[0m17:00:24.881159 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:24.884396 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m17:00:24.910439 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.021 seconds
[0m17:00:24.980576 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:24.986116 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m17:00:25.018404 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.015 seconds
[0m17:00:25.115191 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m17:00:25.183134 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:25.197173 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp170024591199" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m17:00:25.210725 [debug] [Thread-4 (]: SQL status: MERGE 378 in 0.010 seconds
[0m17:00:25.224889 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m17:00:25.242529 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:00:25.247200 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m17:00:25.256006 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m17:00:25.272345 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m17:00:25.287927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f10124c50>]}
[0m17:00:25.308448 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 378[0m in 0.80s]
[0m17:00:25.327208 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m17:00:25.333962 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m17:00:25.352611 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m17:00:25.356684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m17:00:25.357479 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m17:00:25.387797 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.459202 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m17:00:25.532536 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.578471 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.584312 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m17:00:25.590193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:25.606476 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m17:00:25.612706 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.617065 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m17:00:25.655268 [debug] [Thread-2 (]: SQL status: SELECT 84 in 0.035 seconds
[0m17:00:25.679555 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.685148 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m17:00:25.696810 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:25.718928 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.722982 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m17:00:25.729474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:00:25.743642 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m17:00:25.754049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.761789 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m17:00:25.772994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m17:00:25.797127 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m17:00:25.814810 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:00:25.823496 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m17:00:25.842242 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.013 seconds
[0m17:00:25.855054 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m17:00:25.865712 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a133b1-716a-49cb-bd19-fd0283a03cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f102b0150>]}
[0m17:00:25.874818 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 84[0m in 0.51s]
[0m17:00:25.885058 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m17:00:25.893700 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:25.904053 [debug] [MainThread]: On master: BEGIN
[0m17:00:25.912023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:25.939346 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:00:25.941813 [debug] [MainThread]: On master: COMMIT
[0m17:00:25.944038 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:25.946394 [debug] [MainThread]: On master: COMMIT
[0m17:00:25.948909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:25.950789 [debug] [MainThread]: On master: Close
[0m17:00:25.956491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:25.964288 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m17:00:25.967850 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m17:00:25.969898 [debug] [MainThread]: Connection 'list_crypto_analytics_public_bronze' was properly closed.
[0m17:00:25.971825 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m17:00:25.979638 [info ] [MainThread]: 
[0m17:00:25.984715 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m17:00:25.991745 [debug] [MainThread]: Command end result
[0m17:00:26.146733 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m17:00:26.169630 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m17:00:26.224595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m17:00:26.228109 [info ] [MainThread]: 
[0m17:00:26.237158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:26.246128 [info ] [MainThread]: 
[0m17:00:26.253911 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:00:26.265032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5198092, "process_in_blocks": "92472", "process_kernel_time": 1.893978, "process_mem_max_rss": "127572", "process_out_blocks": "0", "process_user_time": 8.114203}
[0m17:00:26.277453 [debug] [MainThread]: Command `dbt run` succeeded at 17:00:26.277002 after 5.54 seconds
[0m17:00:26.289025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f13fa7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f18a5e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f187d0510>]}
[0m17:00:26.299194 [debug] [MainThread]: Flushing usage events
[0m17:00:28.594524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:45.574163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc81ecf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc82d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc81ec390>]}


============================== 17:00:45.581197 | 85f86501-f748-429d-afe0-99101060d4ce ==============================
[0m17:00:45.581197 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:00:45.582932 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'None', 'target_path': 'None', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_crypto/logs', 'send_anonymous_usage_stats': 'True'}
[0m17:00:45.846540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85f86501-f748-429d-afe0-99101060d4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc7534cd0>]}
[0m17:00:45.925654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85f86501-f748-429d-afe0-99101060d4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc7142650>]}
[0m17:00:45.928699 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:00:46.002517 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:00:46.321823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:46.323677 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:00:46.325602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:46.377616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85f86501-f748-429d-afe0-99101060d4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc69f8390>]}
[0m17:00:46.499962 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m17:00:46.510238 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m17:00:46.617643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85f86501-f748-429d-afe0-99101060d4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc6d7ad10>]}
[0m17:00:46.620635 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m17:00:46.622887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f86501-f748-429d-afe0-99101060d4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc6da5cd0>]}
[0m17:00:46.626474 [info ] [MainThread]: 
[0m17:00:46.628170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:46.630277 [info ] [MainThread]: 
[0m17:00:46.632189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:46.639428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_bronze'
[0m17:00:46.640537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_gold'
[0m17:00:46.642184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics_public_silver'
[0m17:00:46.690714 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m17:00:46.691400 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m17:00:46.691944 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m17:00:46.693658 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m17:00:46.695235 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m17:00:46.697097 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m17:00:46.699210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:46.701120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:46.702695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:46.710584 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:00:46.712501 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:00:46.713282 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m17:00:46.713995 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:00:46.715721 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m17:00:46.717190 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m17:00:46.718911 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m17:00:46.720777 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m17:00:46.723979 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m17:00:46.727113 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m17:00:46.729940 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m17:00:46.730747 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m17:00:46.732671 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m17:00:46.733444 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m17:00:46.735660 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m17:00:46.740783 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m17:00:46.743170 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m17:00:46.744494 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m17:00:46.754078 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:46.756237 [debug] [MainThread]: On master: BEGIN
[0m17:00:46.758875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:46.766437 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:00:46.768480 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:46.770081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:46.777395 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m17:00:46.780552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f86501-f748-429d-afe0-99101060d4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bca5d7390>]}
[0m17:00:46.782738 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:46.784635 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:46.786652 [debug] [MainThread]: On master: BEGIN
[0m17:00:46.789010 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:00:46.790864 [debug] [MainThread]: On master: COMMIT
[0m17:00:46.792552 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:46.793903 [debug] [MainThread]: On master: COMMIT
[0m17:00:46.795883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:46.797400 [debug] [MainThread]: On master: Close
[0m17:00:46.804919 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m17:00:46.805713 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m17:00:46.806609 [debug] [Thread-3 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m17:00:46.807424 [debug] [Thread-4 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m17:00:46.808701 [info ] [Thread-1 (]: 1 of 6 START test not_null_gold_klines_5m_bucket_5m ............................ [RUN]
[0m17:00:46.811068 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_klines_5m_symbol ............................... [RUN]
[0m17:00:46.812917 [info ] [Thread-3 (]: 3 of 6 START test not_null_silver_klines_1m_close .............................. [RUN]
[0m17:00:46.814751 [info ] [Thread-4 (]: 4 of 6 START test not_null_silver_klines_1m_minute_ts .......................... [RUN]
[0m17:00:46.816935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_silver, now test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7)
[0m17:00:46.819502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4)
[0m17:00:46.821518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb)
[0m17:00:46.823504 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0'
[0m17:00:46.825423 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m17:00:46.827141 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m17:00:46.828918 [debug] [Thread-3 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m17:00:46.830775 [debug] [Thread-4 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m17:00:46.848131 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m17:00:46.853550 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m17:00:46.860410 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m17:00:46.866721 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m17:00:46.877902 [debug] [Thread-3 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m17:00:46.879425 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m17:00:46.886013 [debug] [Thread-4 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m17:00:46.892202 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m17:00:46.900929 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m17:00:46.903841 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m17:00:46.910232 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m17:00:46.915045 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m17:00:46.927232 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m17:00:46.929038 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m17:00:46.929921 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: BEGIN
[0m17:00:46.930477 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m17:00:46.931259 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m17:00:46.932013 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: BEGIN
[0m17:00:46.933680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:46.935825 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: BEGIN
[0m17:00:46.937641 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: BEGIN
[0m17:00:46.939735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:46.942949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:46.944956 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:00:46.946601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:00:46.951958 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"
[0m17:00:46.953330 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m17:00:46.954736 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bucket_5m
from "crypto_analytics"."public_gold"."gold_klines_5m"
where bucket_5m is null



  
  
      
    ) dbt_internal_test
[0m17:00:46.956064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m17:00:46.957357 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"
[0m17:00:46.958217 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m17:00:46.961153 [debug] [Thread-3 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"
[0m17:00:46.961798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:46.963357 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_gold"."gold_klines_5m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m17:00:46.965255 [debug] [Thread-4 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"
[0m17:00:46.967290 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "crypto_analytics"."public_silver"."silver_klines_1m"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:00:46.972546 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: ROLLBACK
[0m17:00:46.975670 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select minute_ts
from "crypto_analytics"."public_silver"."silver_klines_1m"
where minute_ts is null



  
  
      
    ) dbt_internal_test
[0m17:00:46.976614 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:46.978667 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:00:46.979657 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7: Close
[0m17:00:46.983204 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: ROLLBACK
[0m17:00:46.983772 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:00:46.986810 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: ROLLBACK
[0m17:00:46.989016 [info ] [Thread-1 (]: 1 of 6 PASS not_null_gold_klines_5m_bucket_5m .................................. [[32mPASS[0m in 0.17s]
[0m17:00:46.990833 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4: Close
[0m17:00:46.993435 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: ROLLBACK
[0m17:00:46.995552 [debug] [Thread-3 (]: On test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb: Close
[0m17:00:46.997371 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7
[0m17:00:47.000009 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_klines_5m_symbol ..................................... [[32mPASS[0m in 0.18s]
[0m17:00:47.001594 [debug] [Thread-4 (]: On test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0: Close
[0m17:00:47.003184 [info ] [Thread-3 (]: 3 of 6 PASS not_null_silver_klines_1m_close .................................... [[32mPASS[0m in 0.18s]
[0m17:00:47.004742 [debug] [Thread-1 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m17:00:47.007255 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4
[0m17:00:47.010205 [info ] [Thread-4 (]: 4 of 6 PASS not_null_silver_klines_1m_minute_ts ................................ [[32mPASS[0m in 0.19s]
[0m17:00:47.011913 [debug] [Thread-3 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb
[0m17:00:47.013484 [info ] [Thread-1 (]: 5 of 6 START test not_null_silver_klines_1m_open ............................... [RUN]
[0m17:00:47.015255 [debug] [Thread-2 (]: Began running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m17:00:47.017203 [debug] [Thread-4 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0
[0m17:00:47.020784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_bucket_5m.c375b769b7, now test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b)
[0m17:00:47.023049 [info ] [Thread-2 (]: 6 of 6 START test not_null_silver_klines_1m_symbol ............................. [RUN]
[0m17:00:47.026816 [debug] [Thread-1 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m17:00:47.029048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_crypto.not_null_gold_klines_5m_symbol.ae0ee21dc4, now test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca)
[0m17:00:47.051446 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m17:00:47.053776 [debug] [Thread-2 (]: Began compiling node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m17:00:47.062022 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m17:00:47.072143 [debug] [Thread-1 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m17:00:47.073230 [debug] [Thread-2 (]: Began executing node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m17:00:47.077571 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m17:00:47.081951 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m17:00:47.093716 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m17:00:47.096089 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: BEGIN
[0m17:00:47.096816 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m17:00:47.098377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:47.099997 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: BEGIN
[0m17:00:47.103459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:47.107350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:00:47.109189 [debug] [Thread-1 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"
[0m17:00:47.111042 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "crypto_analytics"."public_silver"."silver_klines_1m"
where open is null



  
  
      
    ) dbt_internal_test
[0m17:00:47.111779 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m17:00:47.114260 [debug] [Thread-2 (]: Using postgres connection "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"
[0m17:00:47.115025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:47.116498 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_analytics"."public_silver"."silver_klines_1m"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m17:00:47.118818 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: ROLLBACK
[0m17:00:47.121382 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:00:47.122091 [debug] [Thread-1 (]: On test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b: Close
[0m17:00:47.124484 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: ROLLBACK
[0m17:00:47.127311 [info ] [Thread-1 (]: 5 of 6 PASS not_null_silver_klines_1m_open ..................................... [[32mPASS[0m in 0.11s]
[0m17:00:47.129300 [debug] [Thread-2 (]: On test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca: Close
[0m17:00:47.131079 [debug] [Thread-1 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b
[0m17:00:47.133154 [info ] [Thread-2 (]: 6 of 6 PASS not_null_silver_klines_1m_symbol ................................... [[32mPASS[0m in 0.10s]
[0m17:00:47.136138 [debug] [Thread-2 (]: Finished running node test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca
[0m17:00:47.140106 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:47.141997 [debug] [MainThread]: On master: BEGIN
[0m17:00:47.143823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:47.151017 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:00:47.152766 [debug] [MainThread]: On master: COMMIT
[0m17:00:47.154271 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:47.156009 [debug] [MainThread]: On master: COMMIT
[0m17:00:47.157801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:47.159462 [debug] [MainThread]: On master: Close
[0m17:00:47.161639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:47.163553 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_close.c996922eeb' was properly closed.
[0m17:00:47.165282 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_symbol.4fc87351ca' was properly closed.
[0m17:00:47.166967 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_open.8b6c169a5b' was properly closed.
[0m17:00:47.168844 [debug] [MainThread]: Connection 'test.dbt_crypto.not_null_silver_klines_1m_minute_ts.ed219ab3d0' was properly closed.
[0m17:00:47.170785 [info ] [MainThread]: 
[0m17:00:47.235319 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m17:00:47.238050 [debug] [MainThread]: Command end result
[0m17:00:47.287912 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m17:00:47.295555 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m17:00:47.310943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m17:00:47.313477 [info ] [MainThread]: 
[0m17:00:47.315676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:47.317376 [info ] [MainThread]: 
[0m17:00:47.318797 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:00:47.321550 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8876636, "process_in_blocks": "1312", "process_kernel_time": 0.432159, "process_mem_max_rss": "134020", "process_out_blocks": "0", "process_user_time": 2.917075}
[0m17:00:47.323296 [debug] [MainThread]: Command `dbt test` succeeded at 17:00:47.323125 after 1.89 seconds
[0m17:00:47.325304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc8395e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcc90b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcc869b50>]}
[0m17:00:47.327430 [debug] [MainThread]: Flushing usage events
[0m17:00:48.887034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:07.339914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee953cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee953cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee9536bd0>]}


============================== 17:05:07.348169 | 5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6 ==============================
[0m17:05:07.348169 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:05:07.350237 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'log_path': '/opt/airflow/dbt_crypto/logs', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m17:05:07.633109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee9596350>]}
[0m17:05:07.696504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eebf2e590>]}
[0m17:05:07.699710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:05:07.764983 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:05:08.058301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:08.059916 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:05:08.061488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:08.140131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee8374c50>]}
[0m17:05:08.292881 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m17:05:08.303045 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m17:05:08.393950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee9594d10>]}
[0m17:05:08.397296 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 462 macros
[0m17:05:08.405906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee83754d0>]}
[0m17:05:08.415089 [info ] [MainThread]: 
[0m17:05:08.417319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:05:08.419718 [info ] [MainThread]: 
[0m17:05:08.422079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:08.432246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m17:05:08.591803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m17:05:08.599123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_analytics'
[0m17:05:08.841854 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m17:05:08.843135 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m17:05:08.844337 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics"
[0m17:05:08.846420 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:05:08.849548 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:05:08.852643 [debug] [ThreadPool]: On list_crypto_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:05:08.855401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:08.858173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:08.860882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:08.880364 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.022 seconds
[0m17:05:08.882641 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.022 seconds
[0m17:05:08.883776 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.028 seconds
[0m17:05:08.888957 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m17:05:08.892985 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m17:05:08.897463 [debug] [ThreadPool]: On list_crypto_analytics: Close
[0m17:05:08.906812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_silver)
[0m17:05:08.908770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_gold)
[0m17:05:08.910949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_analytics, now list_crypto_analytics_public_bronze)
[0m17:05:08.929330 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m17:05:08.933698 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m17:05:08.939963 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m17:05:08.942891 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: BEGIN
[0m17:05:08.945123 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: BEGIN
[0m17:05:08.947259 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: BEGIN
[0m17:05:08.950438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:08.952849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:08.955190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:08.966375 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m17:05:08.968506 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m17:05:08.969494 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_silver"
[0m17:05:08.970907 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m17:05:08.972681 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_gold"
[0m17:05:08.974655 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_silver"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m17:05:08.978789 [debug] [ThreadPool]: Using postgres connection "list_crypto_analytics_public_bronze"
[0m17:05:08.981018 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_gold"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m17:05:08.985385 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "list_crypto_analytics_public_bronze"} */
select
      'crypto_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'crypto_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m17:05:08.994100 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m17:05:08.994990 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:05:08.998434 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: ROLLBACK
[0m17:05:08.999169 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m17:05:09.002334 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: ROLLBACK
[0m17:05:09.004719 [debug] [ThreadPool]: On list_crypto_analytics_public_silver: Close
[0m17:05:09.007763 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: ROLLBACK
[0m17:05:09.010373 [debug] [ThreadPool]: On list_crypto_analytics_public_gold: Close
[0m17:05:09.013700 [debug] [ThreadPool]: On list_crypto_analytics_public_bronze: Close
[0m17:05:09.023420 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:09.025450 [debug] [MainThread]: On master: BEGIN
[0m17:05:09.027682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:09.035239 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:05:09.036978 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:09.039278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:09.049711 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m17:05:09.053248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eea10f850>]}
[0m17:05:09.055493 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:09.057890 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:09.060682 [debug] [MainThread]: On master: BEGIN
[0m17:05:09.063379 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:05:09.066542 [debug] [MainThread]: On master: COMMIT
[0m17:05:09.069179 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:09.071637 [debug] [MainThread]: On master: COMMIT
[0m17:05:09.074400 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:05:09.077325 [debug] [MainThread]: On master: Close
[0m17:05:09.092137 [debug] [Thread-1 (]: Began running node model.dbt_crypto.bronze_historical_klines
[0m17:05:09.092997 [debug] [Thread-2 (]: Began running node model.dbt_crypto.bronze_realtime_klines
[0m17:05:09.095580 [info ] [Thread-1 (]: 1 of 4 START sql view model public_bronze.bronze_historical_klines ............. [RUN]
[0m17:05:09.098280 [info ] [Thread-2 (]: 2 of 4 START sql view model public_bronze.bronze_realtime_klines ............... [RUN]
[0m17:05:09.100616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_bronze, now model.dbt_crypto.bronze_historical_klines)
[0m17:05:09.103317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_analytics_public_gold, now model.dbt_crypto.bronze_realtime_klines)
[0m17:05:09.105512 [debug] [Thread-1 (]: Began compiling node model.dbt_crypto.bronze_historical_klines
[0m17:05:09.107426 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.bronze_realtime_klines
[0m17:05:09.123410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.131765 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.157399 [debug] [Thread-1 (]: Began executing node model.dbt_crypto.bronze_historical_klines
[0m17:05:09.166784 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.bronze_realtime_klines
[0m17:05:09.258383 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.259350 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.270555 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.272921 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: BEGIN
[0m17:05:09.273902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.275737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:05:09.278338 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: BEGIN
[0m17:05:09.282569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:09.293627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:05:09.294505 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m17:05:09.296474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.299369 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.302008 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        open_time AS minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        close_time,
        quote_volume,
        taker_buy_base_volume,
        taker_buy_quote_volume,
        ingested_at,
        'REST_BATCH' AS source_type
    FROM "crypto_analytics"."public"."raw_klines"
)

SELECT * FROM raw
  );
[0m17:05:09.304717 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */

  create view "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id,
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        vwap,
        updated_at AS ingested_at,
        'WS_STREAM' AS source_type
    FROM "crypto_analytics"."public"."fact_realtime_trades_1m"
)

SELECT * FROM raw
  );
[0m17:05:09.315072 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:05:09.322693 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:05:09.325860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.331001 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.332922 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines" rename to "bronze_historical_klines__dbt_backup"
[0m17:05:09.335173 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines" rename to "bronze_realtime_klines__dbt_backup"
[0m17:05:09.338568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:09.340065 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:09.344524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.349925 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.352174 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_tmp" rename to "bronze_historical_klines"
[0m17:05:09.354390 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
alter table "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_tmp" rename to "bronze_realtime_klines"
[0m17:05:09.358178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:05:09.359928 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:09.392686 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m17:05:09.394760 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m17:05:09.396595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.398680 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.401406 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: COMMIT
[0m17:05:09.403321 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: COMMIT
[0m17:05:09.407342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:09.415596 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m17:05:09.422320 [debug] [Thread-1 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup"
[0m17:05:09.427342 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup"
[0m17:05:09.437852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_crypto.bronze_historical_klines"
[0m17:05:09.440674 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.bronze_realtime_klines"
[0m17:05:09.443115 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_historical_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_historical_klines__dbt_backup" cascade
[0m17:05:09.445287 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.bronze_realtime_klines"} */
drop view if exists "crypto_analytics"."public_bronze"."bronze_realtime_klines__dbt_backup" cascade
[0m17:05:09.458659 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m17:05:09.459839 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m17:05:09.464985 [debug] [Thread-2 (]: On model.dbt_crypto.bronze_realtime_klines: Close
[0m17:05:09.469102 [debug] [Thread-1 (]: On model.dbt_crypto.bronze_historical_klines: Close
[0m17:05:09.476658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee957cc10>]}
[0m17:05:09.477806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5758fd0>]}
[0m17:05:09.480056 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public_bronze.bronze_realtime_klines .......... [[32mCREATE VIEW[0m in 0.37s]
[0m17:05:09.482782 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_bronze.bronze_historical_klines ........ [[32mCREATE VIEW[0m in 0.38s]
[0m17:05:09.485637 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.bronze_realtime_klines
[0m17:05:09.488088 [debug] [Thread-1 (]: Finished running node model.dbt_crypto.bronze_historical_klines
[0m17:05:09.492940 [debug] [Thread-4 (]: Began running node model.dbt_crypto.silver_klines_1m
[0m17:05:09.495259 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public_silver.silver_klines_1m .............. [RUN]
[0m17:05:09.498727 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_crypto.silver_klines_1m'
[0m17:05:09.501184 [debug] [Thread-4 (]: Began compiling node model.dbt_crypto.silver_klines_1m
[0m17:05:09.521892 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.539950 [debug] [Thread-4 (]: Began executing node model.dbt_crypto.silver_klines_1m
[0m17:05:09.596403 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.599057 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

    
  
    

  create temporary table "silver_klines_1m__dbt_tmp170509578550"
  
  
    as
  
  (
    

WITH historical AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_historical_klines"
),

realtime AS (
    SELECT 
        symbol,
        minute_ts,
        open,
        high,
        low,
        close,
        volume,
        trade_count,
        source_type,
        ingested_at
    FROM "crypto_analytics"."public_bronze"."bronze_realtime_klines"
),

-- Combine historical and real-time streams
combined AS (
    SELECT * FROM historical
    UNION ALL
    SELECT * FROM realtime
),

-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)
deduped AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (
            PARTITION BY symbol, minute_ts 
            ORDER BY 
                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,
                ingested_at DESC
        ) as rn
    FROM combined
)

SELECT 
    symbol,
    minute_ts,
    open,
    high,
    low,
    close,
    volume,
    trade_count,
    source_type,
    ingested_at,
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM deduped
WHERE rn = 1


    -- In incremental runs, only process data where the window is recent.
    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.
    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM "crypto_analytics"."public_silver"."silver_klines_1m")

  );
  
  
[0m17:05:09.601094 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:05:09.620038 [debug] [Thread-4 (]: SQL status: SELECT 378 in 0.019 seconds
[0m17:05:09.638630 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.641622 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: BEGIN
[0m17:05:09.644610 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m17:05:09.647016 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.649597 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m__dbt_tmp170509578550'
        
      order by ordinal_position

  
[0m17:05:09.667311 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.015 seconds
[0m17:05:09.677675 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.680481 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m17:05:09.687977 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m17:05:09.710402 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.713094 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "crypto_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'silver_klines_1m'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m17:05:09.720415 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m17:05:09.759242 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.779046 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.781372 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.silver_klines_1m"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "crypto_analytics"."public_silver"."silver_klines_1m" as DBT_INTERNAL_DEST
        using "silver_klines_1m__dbt_tmp170509578550" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.symbol = DBT_INTERNAL_DEST.symbol
                ) and (
                    DBT_INTERNAL_SOURCE.minute_ts = DBT_INTERNAL_DEST.minute_ts
                )

    
    when matched then update set
        "symbol" = DBT_INTERNAL_SOURCE."symbol","minute_ts" = DBT_INTERNAL_SOURCE."minute_ts","open" = DBT_INTERNAL_SOURCE."open","high" = DBT_INTERNAL_SOURCE."high","low" = DBT_INTERNAL_SOURCE."low","close" = DBT_INTERNAL_SOURCE."close","volume" = DBT_INTERNAL_SOURCE."volume","trade_count" = DBT_INTERNAL_SOURCE."trade_count","source_type" = DBT_INTERNAL_SOURCE."source_type","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","dbt_updated_at" = DBT_INTERNAL_SOURCE."dbt_updated_at"
    

    when not matched then insert
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")
    values
        ("symbol", "minute_ts", "open", "high", "low", "close", "volume", "trade_count", "source_type", "ingested_at", "dbt_updated_at")


  
[0m17:05:09.790143 [debug] [Thread-4 (]: SQL status: MERGE 378 in 0.006 seconds
[0m17:05:09.793993 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m17:05:09.796443 [debug] [Thread-4 (]: Using postgres connection "model.dbt_crypto.silver_klines_1m"
[0m17:05:09.798837 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: COMMIT
[0m17:05:09.803032 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:09.805704 [debug] [Thread-4 (]: On model.dbt_crypto.silver_klines_1m: Close
[0m17:05:09.807695 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee46ae8d0>]}
[0m17:05:09.810060 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public_silver.silver_klines_1m ......... [[32mMERGE 378[0m in 0.31s]
[0m17:05:09.813151 [debug] [Thread-4 (]: Finished running node model.dbt_crypto.silver_klines_1m
[0m17:05:09.815984 [debug] [Thread-2 (]: Began running node model.dbt_crypto.gold_klines_5m
[0m17:05:09.818632 [info ] [Thread-2 (]: 4 of 4 START sql table model public_gold.gold_klines_5m ........................ [RUN]
[0m17:05:09.820804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_crypto.bronze_realtime_klines, now model.dbt_crypto.gold_klines_5m)
[0m17:05:09.822830 [debug] [Thread-2 (]: Began compiling node model.dbt_crypto.gold_klines_5m
[0m17:05:09.829797 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.850543 [debug] [Thread-2 (]: Began executing node model.dbt_crypto.gold_klines_5m
[0m17:05:09.871683 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.888594 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.890798 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: BEGIN
[0m17:05:09.892824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:05:09.902159 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:05:09.904544 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.906377 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */

  
    

  create  table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp"
  
  
    as
  
  (
    

WITH silver_1m AS (
    SELECT * FROM "crypto_analytics"."public_silver"."silver_klines_1m"
),

-- Generate 5-minute tumbling windows
time_buckets AS (
    SELECT
        symbol,
        date_trunc('hour', minute_ts) + 
        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,
        minute_ts,
        open, high, low, close, volume, trade_count
    FROM silver_1m
),

aggregated AS (
    SELECT
        symbol,
        bucket_5m,
        MIN(minute_ts) as first_minute,
        MAX(minute_ts) as last_minute,
        MAX(high) as high,
        MIN(low) as low,
        SUM(volume) as volume,
        SUM(trade_count) as trade_count
    FROM time_buckets
    GROUP BY symbol, bucket_5m
),

-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute
final_calc AS (
    SELECT 
        a.symbol,
        a.bucket_5m,
        o.open AS open,
        a.high,
        a.low,
        c.close AS close,
        a.volume,
        a.trade_count
    FROM aggregated a
    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts
    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts
)

SELECT * FROM final_calc
ORDER BY bucket_5m DESC, symbol
  );
  
[0m17:05:09.922592 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.014 seconds
[0m17:05:09.933164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.935251 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m" rename to "gold_klines_5m__dbt_backup"
[0m17:05:09.938631 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:09.945344 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.947931 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
alter table "crypto_analytics"."public_gold"."gold_klines_5m__dbt_tmp" rename to "gold_klines_5m"
[0m17:05:09.950804 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:09.954445 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m17:05:09.956200 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.958141 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: COMMIT
[0m17:05:09.961724 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:09.966577 [debug] [Thread-2 (]: Applying DROP to: "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup"
[0m17:05:09.972345 [debug] [Thread-2 (]: Using postgres connection "model.dbt_crypto.gold_klines_5m"
[0m17:05:09.974543 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_crypto", "target_name": "dev", "node_id": "model.dbt_crypto.gold_klines_5m"} */
drop table if exists "crypto_analytics"."public_gold"."gold_klines_5m__dbt_backup" cascade
[0m17:05:09.981091 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:05:09.984361 [debug] [Thread-2 (]: On model.dbt_crypto.gold_klines_5m: Close
[0m17:05:09.986896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee46cf8d0>]}
[0m17:05:09.989416 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public_gold.gold_klines_5m ................... [[32mSELECT 87[0m in 0.17s]
[0m17:05:09.992529 [debug] [Thread-2 (]: Finished running node model.dbt_crypto.gold_klines_5m
[0m17:05:09.997682 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:09.999983 [debug] [MainThread]: On master: BEGIN
[0m17:05:10.002141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:10.010039 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:05:10.011941 [debug] [MainThread]: On master: COMMIT
[0m17:05:10.014266 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:10.015821 [debug] [MainThread]: On master: COMMIT
[0m17:05:10.018079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:05:10.020470 [debug] [MainThread]: On master: Close
[0m17:05:10.022961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:10.024985 [debug] [MainThread]: Connection 'list_crypto_analytics_public_silver' was properly closed.
[0m17:05:10.027545 [debug] [MainThread]: Connection 'model.dbt_crypto.bronze_historical_klines' was properly closed.
[0m17:05:10.030158 [debug] [MainThread]: Connection 'model.dbt_crypto.gold_klines_5m' was properly closed.
[0m17:05:10.032216 [debug] [MainThread]: Connection 'model.dbt_crypto.silver_klines_1m' was properly closed.
[0m17:05:10.035354 [info ] [MainThread]: 
[0m17:05:10.038212 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m17:05:10.042235 [debug] [MainThread]: Command end result
[0m17:05:10.104813 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_crypto/target/manifest.json
[0m17:05:10.116387 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_crypto/target/semantic_manifest.json
[0m17:05:10.132522 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_crypto/target/run_results.json
[0m17:05:10.134169 [info ] [MainThread]: 
[0m17:05:10.136489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:10.138461 [info ] [MainThread]: 
[0m17:05:10.140469 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:05:10.144158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.890713, "process_in_blocks": "248", "process_kernel_time": 1.125062, "process_mem_max_rss": "135028", "process_out_blocks": "0", "process_user_time": 4.118348}
[0m17:05:10.146723 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:10.146487 after 2.89 seconds
[0m17:05:10.148931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eedc204d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eea16d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eedc0f310>]}
[0m17:05:10.151065 [debug] [MainThread]: Flushing usage events
