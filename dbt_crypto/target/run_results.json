{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.6", "generated_at": "2026-02-28T17:05:10.041234Z", "invocation_id": "5fe0815b-0fff-4e94-a79b-1cd2b10bcdf6", "invocation_started_at": "2026-02-28T17:05:07.327914Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T17:05:09.125328Z", "completed_at": "2026-02-28T17:05:09.166457Z"}, {"name": "execute", "started_at": "2026-02-28T17:05:09.184917Z", "completed_at": "2026-02-28T17:05:09.464692Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3689002990722656, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_crypto.bronze_realtime_klines", "compiled": true, "compiled_code": "\n\nWITH raw AS (\n    SELECT\n        id,\n        symbol,\n        minute_ts,\n        open,\n        high,\n        low,\n        close,\n        volume,\n        trade_count,\n        vwap,\n        updated_at AS ingested_at,\n        'WS_STREAM' AS source_type\n    FROM \"crypto_analytics\".\"public\".\"fact_realtime_trades_1m\"\n)\n\nSELECT * FROM raw", "relation_name": "\"crypto_analytics\".\"public_bronze\".\"bronze_realtime_klines\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T17:05:09.109642Z", "completed_at": "2026-02-28T17:05:09.156903Z"}, {"name": "execute", "started_at": "2026-02-28T17:05:09.159588Z", "completed_at": "2026-02-28T17:05:09.468908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.37575650215148926, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_crypto.bronze_historical_klines", "compiled": true, "compiled_code": "\n\nWITH raw AS (\n    SELECT\n        id,\n        symbol,\n        open_time AS minute_ts,\n        open,\n        high,\n        low,\n        close,\n        volume,\n        trade_count,\n        close_time,\n        quote_volume,\n        taker_buy_base_volume,\n        taker_buy_quote_volume,\n        ingested_at,\n        'REST_BATCH' AS source_type\n    FROM \"crypto_analytics\".\"public\".\"raw_klines\"\n)\n\nSELECT * FROM raw", "relation_name": "\"crypto_analytics\".\"public_bronze\".\"bronze_historical_klines\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T17:05:09.503252Z", "completed_at": "2026-02-28T17:05:09.539425Z"}, {"name": "execute", "started_at": "2026-02-28T17:05:09.542064Z", "completed_at": "2026-02-28T17:05:09.805559Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3093864917755127, "adapter_response": {"_message": "MERGE 378", "code": "MERGE", "rows_affected": 378}, "message": "MERGE 378", "failures": null, "unique_id": "model.dbt_crypto.silver_klines_1m", "compiled": true, "compiled_code": "\n\nWITH historical AS (\n    SELECT \n        symbol,\n        minute_ts,\n        open,\n        high,\n        low,\n        close,\n        volume,\n        trade_count,\n        source_type,\n        ingested_at\n    FROM \"crypto_analytics\".\"public_bronze\".\"bronze_historical_klines\"\n),\n\nrealtime AS (\n    SELECT \n        symbol,\n        minute_ts,\n        open,\n        high,\n        low,\n        close,\n        volume,\n        trade_count,\n        source_type,\n        ingested_at\n    FROM \"crypto_analytics\".\"public_bronze\".\"bronze_realtime_klines\"\n),\n\n-- Combine historical and real-time streams\ncombined AS (\n    SELECT * FROM historical\n    UNION ALL\n    SELECT * FROM realtime\n),\n\n-- Deduplicate overlapping minutes (preferring real-time data which has VWAP and is frequently updated, or just taking the latest ingestion)\ndeduped AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY symbol, minute_ts \n            ORDER BY \n                CASE WHEN source_type = 'WS_STREAM' THEN 1 ELSE 2 END,\n                ingested_at DESC\n        ) as rn\n    FROM combined\n)\n\nSELECT \n    symbol,\n    minute_ts,\n    open,\n    high,\n    low,\n    close,\n    volume,\n    trade_count,\n    source_type,\n    ingested_at,\n    CURRENT_TIMESTAMP AS dbt_updated_at\nFROM deduped\nWHERE rn = 1\n\n\n    -- In incremental runs, only process data where the window is recent.\n    -- We look back 2 hours to ensure late-arriving WS data or recent REST updates are caught.\n    AND minute_ts >= (SELECT MAX(minute_ts) - INTERVAL '2 hours' FROM \"crypto_analytics\".\"public_silver\".\"silver_klines_1m\")\n", "relation_name": "\"crypto_analytics\".\"public_silver\".\"silver_klines_1m\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T17:05:09.825171Z", "completed_at": "2026-02-28T17:05:09.850087Z"}, {"name": "execute", "started_at": "2026-02-28T17:05:09.852940Z", "completed_at": "2026-02-28T17:05:09.984211Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.166015625, "adapter_response": {"_message": "SELECT 87", "code": "SELECT", "rows_affected": 87}, "message": "SELECT 87", "failures": null, "unique_id": "model.dbt_crypto.gold_klines_5m", "compiled": true, "compiled_code": "\n\nWITH silver_1m AS (\n    SELECT * FROM \"crypto_analytics\".\"public_silver\".\"silver_klines_1m\"\n),\n\n-- Generate 5-minute tumbling windows\ntime_buckets AS (\n    SELECT\n        symbol,\n        date_trunc('hour', minute_ts) + \n        INTERVAL '5 min' * FLOOR(extract('minute' from minute_ts) / 5) AS bucket_5m,\n        minute_ts,\n        open, high, low, close, volume, trade_count\n    FROM silver_1m\n),\n\naggregated AS (\n    SELECT\n        symbol,\n        bucket_5m,\n        MIN(minute_ts) as first_minute,\n        MAX(minute_ts) as last_minute,\n        MAX(high) as high,\n        MIN(low) as low,\n        SUM(volume) as volume,\n        SUM(trade_count) as trade_count\n    FROM time_buckets\n    GROUP BY symbol, bucket_5m\n),\n\n-- To get correct Open and Close, we join back to get the rows corresponding to first/last minute\nfinal_calc AS (\n    SELECT \n        a.symbol,\n        a.bucket_5m,\n        o.open AS open,\n        a.high,\n        a.low,\n        c.close AS close,\n        a.volume,\n        a.trade_count\n    FROM aggregated a\n    JOIN time_buckets o ON a.symbol = o.symbol AND a.first_minute = o.minute_ts\n    JOIN time_buckets c ON a.symbol = c.symbol AND a.last_minute = c.minute_ts\n)\n\nSELECT * FROM final_calc\nORDER BY bucket_5m DESC, symbol", "relation_name": "\"crypto_analytics\".\"public_gold\".\"gold_klines_5m\"", "batch_results": null}], "elapsed_time": 1.6132698059082031, "args": {"log_file_max_bytes": 10485760, "empty": false, "printer_width": 80, "write_json": true, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "exclude": [], "log_path": "/opt/airflow/dbt_crypto/logs", "state_modified_compare_vars": false, "log_format": "default", "profiles_dir": ".", "require_unique_project_resource_names": false, "use_fast_test_edges": false, "which": "run", "validate_macro_args": false, "source_freshness_run_project_hooks": true, "require_resource_names_without_spaces": true, "populate_cache": true, "invocation_command": "dbt run --profiles-dir .", "log_format_file": "debug", "partial_parse": true, "print": true, "indirect_selection": "eager", "require_nested_cumulative_type_params": false, "defer": false, "vars": {}, "show_resource_report": false, "require_batched_execution_for_custom_microbatch_strategy": false, "show_all_deprecations": false, "log_level_file": "debug", "use_colors_file": true, "log_level": "info", "quiet": false, "cache_selected_only": false, "upload_to_artifacts_ingest_api": false, "favor_state": false, "require_all_warnings_handled_by_warn_error": false, "require_generic_test_arguments_property": true, "partial_parse_file_diff": true, "strict_mode": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_ref_searches_node_package_before_root": false, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "select": [], "static_parser": true, "project_dir": "/opt/airflow/dbt_crypto", "macro_debugging": false}}